"use strict";(()=>{var td=Object.create;var Is=Object.defineProperty,rd=Object.defineProperties,nd=Object.getOwnPropertyDescriptor,ad=Object.getOwnPropertyDescriptors,sd=Object.getOwnPropertyNames,xo=Object.getOwnPropertySymbols,id=Object.getPrototypeOf,qo=Object.prototype.hasOwnProperty,od=Object.prototype.propertyIsEnumerable;var ks=(t,e,r)=>e in t?Is(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ce=(t,e)=>{for(var r in e||(e={}))qo.call(e,r)&&ks(t,r,e[r]);if(xo)for(var r of xo(e))od.call(e,r)&&ks(t,r,e[r]);return t},nt=(t,e)=>rd(t,ad(e));var mn=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var j=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var ld=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of sd(e))!qo.call(t,a)&&a!==r&&Is(t,a,{get:()=>e[a],enumerable:!(n=nd(e,a))||n.enumerable});return t};var jo=(t,e,r)=>(r=t!=null?td(id(t)):{},ld(e||!t||!t.__esModule?Is(r,"default",{value:t,enumerable:!0}):r,t));var P=(t,e,r)=>(ks(t,typeof e!="symbol"?e+"":e,r),r);var Bo=j((Vo,Rs)=>{(function(t){if(typeof Vo=="object"&&typeof Rs<"u")Rs.exports=t();else if(typeof define=="function"&&define.amd)define([],t);else{var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e=this,e.localforage=t()}})(function(){var t,e,r;return function n(a,s,i){function c(p,E){if(!s[p]){if(!a[p]){var _=typeof mn=="function"&&mn;if(!E&&_)return _(p,!0);if(f)return f(p,!0);var $=new Error("Cannot find module '"+p+"'");throw $.code="MODULE_NOT_FOUND",$}var C=s[p]={exports:{}};a[p][0].call(C.exports,function(M){var R=a[p][1][M];return c(R||M)},C,C.exports,n,a,s,i)}return s[p].exports}for(var f=typeof mn=="function"&&mn,y=0;y<i.length;y++)c(i[y]);return c}({1:[function(n,a,s){(function(i){"use strict";var c=i.MutationObserver||i.WebKitMutationObserver,f;if(c){var y=0,p=new c(M),E=i.document.createTextNode("");p.observe(E,{characterData:!0}),f=function(){E.data=y=++y%2}}else if(!i.setImmediate&&typeof i.MessageChannel<"u"){var _=new i.MessageChannel;_.port1.onmessage=M,f=function(){_.port2.postMessage(0)}}else"document"in i&&"onreadystatechange"in i.document.createElement("script")?f=function(){var N=i.document.createElement("script");N.onreadystatechange=function(){M(),N.onreadystatechange=null,N.parentNode.removeChild(N),N=null},i.document.documentElement.appendChild(N)}:f=function(){setTimeout(M,0)};var $,C=[];function M(){$=!0;for(var N,U,H=C.length;H;){for(U=C,C=[],N=-1;++N<H;)U[N]();H=C.length}$=!1}a.exports=R;function R(N){C.push(N)===1&&!$&&f()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,a,s){"use strict";var i=n(1);function c(){}var f={},y=["REJECTED"],p=["FULFILLED"],E=["PENDING"];a.exports=_;function _(L){if(typeof L!="function")throw new TypeError("resolver must be a function");this.state=E,this.queue=[],this.outcome=void 0,L!==c&&R(this,L)}_.prototype.catch=function(L){return this.then(null,L)},_.prototype.then=function(L,J){if(typeof L!="function"&&this.state===p||typeof J!="function"&&this.state===y)return this;var z=new this.constructor(c);if(this.state!==E){var te=this.state===p?L:J;C(z,te,this.outcome)}else this.queue.push(new $(z,L,J));return z};function $(L,J,z){this.promise=L,typeof J=="function"&&(this.onFulfilled=J,this.callFulfilled=this.otherCallFulfilled),typeof z=="function"&&(this.onRejected=z,this.callRejected=this.otherCallRejected)}$.prototype.callFulfilled=function(L){f.resolve(this.promise,L)},$.prototype.otherCallFulfilled=function(L){C(this.promise,this.onFulfilled,L)},$.prototype.callRejected=function(L){f.reject(this.promise,L)},$.prototype.otherCallRejected=function(L){C(this.promise,this.onRejected,L)};function C(L,J,z){i(function(){var te;try{te=J(z)}catch(ae){return f.reject(L,ae)}te===L?f.reject(L,new TypeError("Cannot resolve promise with itself")):f.resolve(L,te)})}f.resolve=function(L,J){var z=N(M,J);if(z.status==="error")return f.reject(L,z.value);var te=z.value;if(te)R(L,te);else{L.state=p,L.outcome=J;for(var ae=-1,ke=L.queue.length;++ae<ke;)L.queue[ae].callFulfilled(J)}return L},f.reject=function(L,J){L.state=y,L.outcome=J;for(var z=-1,te=L.queue.length;++z<te;)L.queue[z].callRejected(J);return L};function M(L){var J=L&&L.then;if(L&&(typeof L=="object"||typeof L=="function")&&typeof J=="function")return function(){J.apply(L,arguments)}}function R(L,J){var z=!1;function te(Ae){z||(z=!0,f.reject(L,Ae))}function ae(Ae){z||(z=!0,f.resolve(L,Ae))}function ke(){J(ae,te)}var we=N(ke);we.status==="error"&&te(we.value)}function N(L,J){var z={};try{z.value=L(J),z.status="success"}catch(te){z.status="error",z.value=te}return z}_.resolve=U;function U(L){return L instanceof this?L:f.resolve(new this(c),L)}_.reject=H;function H(L){var J=new this(c);return f.reject(J,L)}_.all=oe;function oe(L){var J=this;if(Object.prototype.toString.call(L)!=="[object Array]")return this.reject(new TypeError("must be an array"));var z=L.length,te=!1;if(!z)return this.resolve([]);for(var ae=new Array(z),ke=0,we=-1,Ae=new this(c);++we<z;)Ze(L[we],we);return Ae;function Ze(Xt,Pr){J.resolve(Xt).then(tn,function(Bt){te||(te=!0,f.reject(Ae,Bt))});function tn(Bt){ae[Pr]=Bt,++ke===z&&!te&&(te=!0,f.resolve(Ae,ae))}}}_.race=B;function B(L){var J=this;if(Object.prototype.toString.call(L)!=="[object Array]")return this.reject(new TypeError("must be an array"));var z=L.length,te=!1;if(!z)return this.resolve([]);for(var ae=-1,ke=new this(c);++ae<z;)we(L[ae]);return ke;function we(Ae){J.resolve(Ae).then(function(Ze){te||(te=!0,f.resolve(ke,Ze))},function(Ze){te||(te=!0,f.reject(ke,Ze))})}}},{1:1}],3:[function(n,a,s){(function(i){"use strict";typeof i.Promise!="function"&&(i.Promise=n(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,a,s){"use strict";var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o};function c(o,d){if(!(o instanceof d))throw new TypeError("Cannot call a class as a function")}function f(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch(o){return}}var y=f();function p(){try{if(!y||!y.open)return!1;var o=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),d=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!o||d)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch(l){return!1}}function E(o,d){o=o||[],d=d||{};try{return new Blob(o,d)}catch(v){if(v.name!=="TypeError")throw v;for(var l=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,g=new l,b=0;b<o.length;b+=1)g.append(o[b]);return g.getBlob(d.type)}}typeof Promise>"u"&&n(3);var _=Promise;function $(o,d){d&&o.then(function(l){d(null,l)},function(l){d(l)})}function C(o,d,l){typeof d=="function"&&o.then(d),typeof l=="function"&&o.catch(l)}function M(o){return typeof o!="string"&&(console.warn(o+" used as a key, but it is not a string."),o=String(o)),o}function R(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var N="local-forage-detect-blob-support",U=void 0,H={},oe=Object.prototype.toString,B="readonly",L="readwrite";function J(o){for(var d=o.length,l=new ArrayBuffer(d),g=new Uint8Array(l),b=0;b<d;b++)g[b]=o.charCodeAt(b);return l}function z(o){return new _(function(d){var l=o.transaction(N,L),g=E([""]);l.objectStore(N).put(g,"key"),l.onabort=function(b){b.preventDefault(),b.stopPropagation(),d(!1)},l.oncomplete=function(){var b=navigator.userAgent.match(/Chrome\/(\d+)/),v=navigator.userAgent.match(/Edge\//);d(v||!b||parseInt(b[1],10)>=43)}}).catch(function(){return!1})}function te(o){return typeof U=="boolean"?_.resolve(U):z(o).then(function(d){return U=d,U})}function ae(o){var d=H[o.name],l={};l.promise=new _(function(g,b){l.resolve=g,l.reject=b}),d.deferredOperations.push(l),d.dbReady?d.dbReady=d.dbReady.then(function(){return l.promise}):d.dbReady=l.promise}function ke(o){var d=H[o.name],l=d.deferredOperations.pop();if(l)return l.resolve(),l.promise}function we(o,d){var l=H[o.name],g=l.deferredOperations.pop();if(g)return g.reject(d),g.promise}function Ae(o,d){return new _(function(l,g){if(H[o.name]=H[o.name]||ea(),o.db)if(d)ae(o),o.db.close();else return l(o.db);var b=[o.name];d&&b.push(o.version);var v=y.open.apply(y,b);d&&(v.onupgradeneeded=function(T){var k=v.result;try{k.createObjectStore(o.storeName),T.oldVersion<=1&&k.createObjectStore(N)}catch(I){if(I.name==="ConstraintError")console.warn('The database "'+o.name+'" has been upgraded from version '+T.oldVersion+" to version "+T.newVersion+', but the storage "'+o.storeName+'" already exists.');else throw I}}),v.onerror=function(T){T.preventDefault(),g(v.error)},v.onsuccess=function(){var T=v.result;T.onversionchange=function(k){k.target.close()},l(T),ke(o)}})}function Ze(o){return Ae(o,!1)}function Xt(o){return Ae(o,!0)}function Pr(o,d){if(!o.db)return!0;var l=!o.db.objectStoreNames.contains(o.storeName),g=o.version<o.db.version,b=o.version>o.db.version;if(g&&(o.version!==d&&console.warn('The database "'+o.name+`" can't be downgraded from version `+o.db.version+" to version "+o.version+"."),o.version=o.db.version),b||l){if(l){var v=o.db.version+1;v>o.version&&(o.version=v)}return!0}return!1}function tn(o){return new _(function(d,l){var g=new FileReader;g.onerror=l,g.onloadend=function(b){var v=btoa(b.target.result||"");d({__local_forage_encoded_blob:!0,data:v,type:o.type})},g.readAsBinaryString(o)})}function Bt(o){var d=J(atob(o.data));return E([d],{type:o.type})}function rn(o){return o&&o.__local_forage_encoded_blob}function Xn(o){var d=this,l=d._initReady().then(function(){var g=H[d._dbInfo.name];if(g&&g.dbReady)return g.dbReady});return C(l,o,o),l}function Zn(o){ae(o);for(var d=H[o.name],l=d.forages,g=0;g<l.length;g++){var b=l[g];b._dbInfo.db&&(b._dbInfo.db.close(),b._dbInfo.db=null)}return o.db=null,Ze(o).then(function(v){return o.db=v,Pr(o)?Xt(o):v}).then(function(v){o.db=d.db=v;for(var T=0;T<l.length;T++)l[T]._dbInfo.db=v}).catch(function(v){throw we(o,v),v})}function _t(o,d,l,g){g===void 0&&(g=1);try{var b=o.db.transaction(o.storeName,d);l(null,b)}catch(v){if(g>0&&(!o.db||v.name==="InvalidStateError"||v.name==="NotFoundError"))return _.resolve().then(function(){if(!o.db||v.name==="NotFoundError"&&!o.db.objectStoreNames.contains(o.storeName)&&o.version<=o.db.version)return o.db&&(o.version=o.db.version+1),Xt(o)}).then(function(){return Zn(o).then(function(){_t(o,d,l,g-1)})}).catch(l);l(v)}}function ea(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Zt(o){var d=this,l={db:null};if(o)for(var g in o)l[g]=o[g];var b=H[l.name];b||(b=ea(),H[l.name]=b),b.forages.push(d),d._initReady||(d._initReady=d.ready,d.ready=Xn);var v=[];function T(){return _.resolve()}for(var k=0;k<b.forages.length;k++){var I=b.forages[k];I!==d&&v.push(I._initReady().catch(T))}var D=b.forages.slice(0);return _.all(v).then(function(){return l.db=b.db,Ze(l)}).then(function(A){return l.db=A,Pr(l,d._defaultConfig.version)?Xt(l):A}).then(function(A){l.db=b.db=A,d._dbInfo=l;for(var F=0;F<D.length;F++){var Y=D[F];Y!==d&&(Y._dbInfo.db=l.db,Y._dbInfo.version=l.version)}})}function et(o,d){var l=this;o=M(o);var g=new _(function(b,v){l.ready().then(function(){_t(l._dbInfo,B,function(T,k){if(T)return v(T);try{var I=k.objectStore(l._dbInfo.storeName),D=I.get(o);D.onsuccess=function(){var A=D.result;A===void 0&&(A=null),rn(A)&&(A=Bt(A)),b(A)},D.onerror=function(){v(D.error)}}catch(A){v(A)}})}).catch(v)});return $(g,d),g}function ct(o,d){var l=this,g=new _(function(b,v){l.ready().then(function(){_t(l._dbInfo,B,function(T,k){if(T)return v(T);try{var I=k.objectStore(l._dbInfo.storeName),D=I.openCursor(),A=1;D.onsuccess=function(){var F=D.result;if(F){var Y=F.value;rn(Y)&&(Y=Bt(Y));var le=o(Y,F.key,A++);le!==void 0?b(le):F.continue()}else b()},D.onerror=function(){v(D.error)}}catch(F){v(F)}})}).catch(v)});return $(g,d),g}function er(o,d,l){var g=this;o=M(o);var b=new _(function(v,T){var k;g.ready().then(function(){return k=g._dbInfo,oe.call(d)==="[object Blob]"?te(k.db).then(function(I){return I?d:tn(d)}):d}).then(function(I){_t(g._dbInfo,L,function(D,A){if(D)return T(D);try{var F=A.objectStore(g._dbInfo.storeName);I===null&&(I=void 0);var Y=F.put(I,o);A.oncomplete=function(){I===void 0&&(I=null),v(I)},A.onabort=A.onerror=function(){var le=Y.error?Y.error:Y.transaction.error;T(le)}}catch(le){T(le)}})}).catch(T)});return $(b,l),b}function nn(o,d){var l=this;o=M(o);var g=new _(function(b,v){l.ready().then(function(){_t(l._dbInfo,L,function(T,k){if(T)return v(T);try{var I=k.objectStore(l._dbInfo.storeName),D=I.delete(o);k.oncomplete=function(){b()},k.onerror=function(){v(D.error)},k.onabort=function(){var A=D.error?D.error:D.transaction.error;v(A)}}catch(A){v(A)}})}).catch(v)});return $(g,d),g}function an(o){var d=this,l=new _(function(g,b){d.ready().then(function(){_t(d._dbInfo,L,function(v,T){if(v)return b(v);try{var k=T.objectStore(d._dbInfo.storeName),I=k.clear();T.oncomplete=function(){g()},T.onabort=T.onerror=function(){var D=I.error?I.error:I.transaction.error;b(D)}}catch(D){b(D)}})}).catch(b)});return $(l,o),l}function sn(o){var d=this,l=new _(function(g,b){d.ready().then(function(){_t(d._dbInfo,B,function(v,T){if(v)return b(v);try{var k=T.objectStore(d._dbInfo.storeName),I=k.count();I.onsuccess=function(){g(I.result)},I.onerror=function(){b(I.error)}}catch(D){b(D)}})}).catch(b)});return $(l,o),l}function ta(o,d){var l=this,g=new _(function(b,v){if(o<0){b(null);return}l.ready().then(function(){_t(l._dbInfo,B,function(T,k){if(T)return v(T);try{var I=k.objectStore(l._dbInfo.storeName),D=!1,A=I.openKeyCursor();A.onsuccess=function(){var F=A.result;if(!F){b(null);return}o===0||D?b(F.key):(D=!0,F.advance(o))},A.onerror=function(){v(A.error)}}catch(F){v(F)}})}).catch(v)});return $(g,d),g}function bs(o){var d=this,l=new _(function(g,b){d.ready().then(function(){_t(d._dbInfo,B,function(v,T){if(v)return b(v);try{var k=T.objectStore(d._dbInfo.storeName),I=k.openKeyCursor(),D=[];I.onsuccess=function(){var A=I.result;if(!A){g(D);return}D.push(A.key),A.continue()},I.onerror=function(){b(I.error)}}catch(A){b(A)}})}).catch(b)});return $(l,o),l}function _s(o,d){d=R.apply(this,arguments);var l=this.config();o=typeof o!="function"&&o||{},o.name||(o.name=o.name||l.name,o.storeName=o.storeName||l.storeName);var g=this,b;if(!o.name)b=_.reject("Invalid arguments");else{var v=o.name===l.name&&g._dbInfo.db,T=v?_.resolve(g._dbInfo.db):Ze(o).then(function(k){var I=H[o.name],D=I.forages;I.db=k;for(var A=0;A<D.length;A++)D[A]._dbInfo.db=k;return k});o.storeName?b=T.then(function(k){if(!!k.objectStoreNames.contains(o.storeName)){var I=k.version+1;ae(o);var D=H[o.name],A=D.forages;k.close();for(var F=0;F<A.length;F++){var Y=A[F];Y._dbInfo.db=null,Y._dbInfo.version=I}var le=new _(function(me,ve){var ge=y.open(o.name,I);ge.onerror=function(Ve){var Nt=ge.result;Nt.close(),ve(Ve)},ge.onupgradeneeded=function(){var Ve=ge.result;Ve.deleteObjectStore(o.storeName)},ge.onsuccess=function(){var Ve=ge.result;Ve.close(),me(Ve)}});return le.then(function(me){D.db=me;for(var ve=0;ve<A.length;ve++){var ge=A[ve];ge._dbInfo.db=me,ke(ge._dbInfo)}}).catch(function(me){throw(we(o,me)||_.resolve()).catch(function(){}),me})}}):b=T.then(function(k){ae(o);var I=H[o.name],D=I.forages;k.close();for(var A=0;A<D.length;A++){var F=D[A];F._dbInfo.db=null}var Y=new _(function(le,me){var ve=y.deleteDatabase(o.name);ve.onerror=function(){var ge=ve.result;ge&&ge.close(),me(ve.error)},ve.onblocked=function(){console.warn('dropInstance blocked for database "'+o.name+'" until all open connections are closed')},ve.onsuccess=function(){var ge=ve.result;ge&&ge.close(),le(ge)}});return Y.then(function(le){I.db=le;for(var me=0;me<D.length;me++){var ve=D[me];ke(ve._dbInfo)}}).catch(function(le){throw(we(o,le)||_.resolve()).catch(function(){}),le})})}return $(b,d),b}var Et={_driver:"asyncStorage",_initStorage:Zt,_support:p(),iterate:ct,getItem:et,setItem:er,removeItem:nn,clear:an,length:sn,key:ta,keys:bs,dropInstance:_s};function Es(){return typeof openDatabase=="function"}var $t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ra="~~local_forage_type~",on=/^~~local_forage_type~([^~]+)~/,kr="__lfsc__:",Dt=kr.length,tt="arbf",Ir="blob",na="si08",aa="ui08",sa="uic8",ia="si16",ut="si32",tr="ur16",ln="ui32",cn="fl32",rr="fl64",un=Dt+tt.length,oa=Object.prototype.toString;function la(o){var d=o.length*.75,l=o.length,g,b=0,v,T,k,I;o[o.length-1]==="="&&(d--,o[o.length-2]==="="&&d--);var D=new ArrayBuffer(d),A=new Uint8Array(D);for(g=0;g<l;g+=4)v=$t.indexOf(o[g]),T=$t.indexOf(o[g+1]),k=$t.indexOf(o[g+2]),I=$t.indexOf(o[g+3]),A[b++]=v<<2|T>>4,A[b++]=(T&15)<<4|k>>2,A[b++]=(k&3)<<6|I&63;return D}function Dr(o){var d=new Uint8Array(o),l="",g;for(g=0;g<d.length;g+=3)l+=$t[d[g]>>2],l+=$t[(d[g]&3)<<4|d[g+1]>>4],l+=$t[(d[g+1]&15)<<2|d[g+2]>>6],l+=$t[d[g+2]&63];return d.length%3===2?l=l.substring(0,l.length-1)+"=":d.length%3===1&&(l=l.substring(0,l.length-2)+"=="),l}function dt(o,d){var l="";if(o&&(l=oa.call(o)),o&&(l==="[object ArrayBuffer]"||o.buffer&&oa.call(o.buffer)==="[object ArrayBuffer]")){var g,b=kr;o instanceof ArrayBuffer?(g=o,b+=tt):(g=o.buffer,l==="[object Int8Array]"?b+=na:l==="[object Uint8Array]"?b+=aa:l==="[object Uint8ClampedArray]"?b+=sa:l==="[object Int16Array]"?b+=ia:l==="[object Uint16Array]"?b+=tr:l==="[object Int32Array]"?b+=ut:l==="[object Uint32Array]"?b+=ln:l==="[object Float32Array]"?b+=cn:l==="[object Float64Array]"?b+=rr:d(new Error("Failed to get type for BinaryArray"))),d(b+Dr(g))}else if(l==="[object Blob]"){var v=new FileReader;v.onload=function(){var T=ra+o.type+"~"+Dr(this.result);d(kr+Ir+T)},v.readAsArrayBuffer(o)}else try{d(JSON.stringify(o))}catch(T){console.error("Couldn't convert value into a JSON string: ",o),d(null,T)}}function $s(o){if(o.substring(0,Dt)!==kr)return JSON.parse(o);var d=o.substring(un),l=o.substring(Dt,un),g;if(l===Ir&&on.test(d)){var b=d.match(on);g=b[1],d=d.substring(b[0].length)}var v=la(d);switch(l){case tt:return v;case Ir:return E([v],{type:g});case na:return new Int8Array(v);case aa:return new Uint8Array(v);case sa:return new Uint8ClampedArray(v);case ia:return new Int16Array(v);case tr:return new Uint16Array(v);case ut:return new Int32Array(v);case ln:return new Uint32Array(v);case cn:return new Float32Array(v);case rr:return new Float64Array(v);default:throw new Error("Unkown type: "+l)}}var dn={serialize:dt,deserialize:$s,stringToBuffer:la,bufferToString:Dr};function ca(o,d,l,g){o.executeSql("CREATE TABLE IF NOT EXISTS "+d.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],l,g)}function Ss(o){var d=this,l={db:null};if(o)for(var g in o)l[g]=typeof o[g]!="string"?o[g].toString():o[g];var b=new _(function(v,T){try{l.db=openDatabase(l.name,String(l.version),l.description,l.size)}catch(k){return T(k)}l.db.transaction(function(k){ca(k,l,function(){d._dbInfo=l,v()},function(I,D){T(D)})},T)});return l.serializer=dn,b}function Rt(o,d,l,g,b,v){o.executeSql(l,g,b,function(T,k){k.code===k.SYNTAX_ERR?T.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[d.storeName],function(I,D){D.rows.length?v(I,k):ca(I,d,function(){I.executeSql(l,g,b,v)},v)},v):v(T,k)},v)}function ws(o,d){var l=this;o=M(o);var g=new _(function(b,v){l.ready().then(function(){var T=l._dbInfo;T.db.transaction(function(k){Rt(k,T,"SELECT * FROM "+T.storeName+" WHERE key = ? LIMIT 1",[o],function(I,D){var A=D.rows.length?D.rows.item(0).value:null;A&&(A=T.serializer.deserialize(A)),b(A)},function(I,D){v(D)})})}).catch(v)});return $(g,d),g}function nr(o,d){var l=this,g=new _(function(b,v){l.ready().then(function(){var T=l._dbInfo;T.db.transaction(function(k){Rt(k,T,"SELECT * FROM "+T.storeName,[],function(I,D){for(var A=D.rows,F=A.length,Y=0;Y<F;Y++){var le=A.item(Y),me=le.value;if(me&&(me=T.serializer.deserialize(me)),me=o(me,le.key,Y+1),me!==void 0){b(me);return}}b()},function(I,D){v(D)})})}).catch(v)});return $(g,d),g}function ua(o,d,l,g){var b=this;o=M(o);var v=new _(function(T,k){b.ready().then(function(){d===void 0&&(d=null);var I=d,D=b._dbInfo;D.serializer.serialize(d,function(A,F){F?k(F):D.db.transaction(function(Y){Rt(Y,D,"INSERT OR REPLACE INTO "+D.storeName+" (key, value) VALUES (?, ?)",[o,A],function(){T(I)},function(le,me){k(me)})},function(Y){if(Y.code===Y.QUOTA_ERR){if(g>0){T(ua.apply(b,[o,I,l,g-1]));return}k(Y)}})})}).catch(k)});return $(v,l),v}function da(o,d,l){return ua.apply(this,[o,d,l,1])}function Cs(o,d){var l=this;o=M(o);var g=new _(function(b,v){l.ready().then(function(){var T=l._dbInfo;T.db.transaction(function(k){Rt(k,T,"DELETE FROM "+T.storeName+" WHERE key = ?",[o],function(){b()},function(I,D){v(D)})})}).catch(v)});return $(g,d),g}function fn(o){var d=this,l=new _(function(g,b){d.ready().then(function(){var v=d._dbInfo;v.db.transaction(function(T){Rt(T,v,"DELETE FROM "+v.storeName,[],function(){g()},function(k,I){b(I)})})}).catch(b)});return $(l,o),l}function fa(o){var d=this,l=new _(function(g,b){d.ready().then(function(){var v=d._dbInfo;v.db.transaction(function(T){Rt(T,v,"SELECT COUNT(key) as c FROM "+v.storeName,[],function(k,I){var D=I.rows.item(0).c;g(D)},function(k,I){b(I)})})}).catch(b)});return $(l,o),l}function Ms(o,d){var l=this,g=new _(function(b,v){l.ready().then(function(){var T=l._dbInfo;T.db.transaction(function(k){Rt(k,T,"SELECT key FROM "+T.storeName+" WHERE id = ? LIMIT 1",[o+1],function(I,D){var A=D.rows.length?D.rows.item(0).key:null;b(A)},function(I,D){v(D)})})}).catch(v)});return $(g,d),g}function ma(o){var d=this,l=new _(function(g,b){d.ready().then(function(){var v=d._dbInfo;v.db.transaction(function(T){Rt(T,v,"SELECT key FROM "+v.storeName,[],function(k,I){for(var D=[],A=0;A<I.rows.length;A++)D.push(I.rows.item(A).key);g(D)},function(k,I){b(I)})})}).catch(b)});return $(l,o),l}function Ts(o){return new _(function(d,l){o.transaction(function(g){g.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(b,v){for(var T=[],k=0;k<v.rows.length;k++)T.push(v.rows.item(k).name);d({db:o,storeNames:T})},function(b,v){l(v)})},function(g){l(g)})})}function pa(o,d){d=R.apply(this,arguments);var l=this.config();o=typeof o!="function"&&o||{},o.name||(o.name=o.name||l.name,o.storeName=o.storeName||l.storeName);var g=this,b;return o.name?b=new _(function(v){var T;o.name===l.name?T=g._dbInfo.db:T=openDatabase(o.name,"","",0),o.storeName?v({db:T,storeNames:[o.storeName]}):v(Ts(T))}).then(function(v){return new _(function(T,k){v.db.transaction(function(I){function D(le){return new _(function(me,ve){I.executeSql("DROP TABLE IF EXISTS "+le,[],function(){me()},function(ge,Ve){ve(Ve)})})}for(var A=[],F=0,Y=v.storeNames.length;F<Y;F++)A.push(D(v.storeNames[F]));_.all(A).then(function(){T()}).catch(function(le){k(le)})},function(I){k(I)})})}):b=_.reject("Invalid arguments"),$(b,d),b}var m={_driver:"webSQLStorage",_initStorage:Ss,_support:Es(),iterate:nr,getItem:ws,setItem:da,removeItem:Cs,clear:fn,length:fa,key:Ms,keys:ma,dropInstance:pa};function u(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch(o){return!1}}function h(o,d){var l=o.name+"/";return o.storeName!==d.storeName&&(l+=o.storeName+"/"),l}function S(){var o="_localforage_support_test";try{return localStorage.setItem(o,!0),localStorage.removeItem(o),!1}catch(d){return!0}}function w(){return!S()||localStorage.length>0}function x(o){var d=this,l={};if(o)for(var g in o)l[g]=o[g];return l.keyPrefix=h(o,d._defaultConfig),w()?(d._dbInfo=l,l.serializer=dn,_.resolve()):_.reject()}function K(o){var d=this,l=d.ready().then(function(){for(var g=d._dbInfo.keyPrefix,b=localStorage.length-1;b>=0;b--){var v=localStorage.key(b);v.indexOf(g)===0&&localStorage.removeItem(v)}});return $(l,o),l}function re(o,d){var l=this;o=M(o);var g=l.ready().then(function(){var b=l._dbInfo,v=localStorage.getItem(b.keyPrefix+o);return v&&(v=b.serializer.deserialize(v)),v});return $(g,d),g}function fe(o,d){var l=this,g=l.ready().then(function(){for(var b=l._dbInfo,v=b.keyPrefix,T=v.length,k=localStorage.length,I=1,D=0;D<k;D++){var A=localStorage.key(D);if(A.indexOf(v)===0){var F=localStorage.getItem(A);if(F&&(F=b.serializer.deserialize(F)),F=o(F,A.substring(T),I++),F!==void 0)return F}}});return $(g,d),g}function Me(o,d){var l=this,g=l.ready().then(function(){var b=l._dbInfo,v;try{v=localStorage.key(o)}catch(T){v=null}return v&&(v=v.substring(b.keyPrefix.length)),v});return $(g,d),g}function ee(o){var d=this,l=d.ready().then(function(){for(var g=d._dbInfo,b=localStorage.length,v=[],T=0;T<b;T++){var k=localStorage.key(T);k.indexOf(g.keyPrefix)===0&&v.push(k.substring(g.keyPrefix.length))}return v});return $(l,o),l}function Ee(o){var d=this,l=d.keys().then(function(g){return g.length});return $(l,o),l}function Te(o,d){var l=this;o=M(o);var g=l.ready().then(function(){var b=l._dbInfo;localStorage.removeItem(b.keyPrefix+o)});return $(g,d),g}function _e(o,d,l){var g=this;o=M(o);var b=g.ready().then(function(){d===void 0&&(d=null);var v=d;return new _(function(T,k){var I=g._dbInfo;I.serializer.serialize(d,function(D,A){if(A)k(A);else try{localStorage.setItem(I.keyPrefix+o,D),T(v)}catch(F){(F.name==="QuotaExceededError"||F.name==="NS_ERROR_DOM_QUOTA_REACHED")&&k(F),k(F)}})})});return $(b,l),b}function se(o,d){if(d=R.apply(this,arguments),o=typeof o!="function"&&o||{},!o.name){var l=this.config();o.name=o.name||l.name,o.storeName=o.storeName||l.storeName}var g=this,b;return o.name?b=new _(function(v){o.storeName?v(h(o,g._defaultConfig)):v(o.name+"/")}).then(function(v){for(var T=localStorage.length-1;T>=0;T--){var k=localStorage.key(T);k.indexOf(v)===0&&localStorage.removeItem(k)}}):b=_.reject("Invalid arguments"),$(b,d),b}var $e={_driver:"localStorageWrapper",_initStorage:x,_support:u(),iterate:fe,getItem:re,setItem:_e,removeItem:Te,clear:K,length:Ee,key:Me,keys:ee,dropInstance:se},pe=function(d,l){return d===l||typeof d=="number"&&typeof l=="number"&&isNaN(d)&&isNaN(l)},Ut=function(d,l){for(var g=d.length,b=0;b<g;){if(pe(d[b],l))return!0;b++}return!1},He=Array.isArray||function(o){return Object.prototype.toString.call(o)==="[object Array]"},Ne={},he={},De={INDEXEDDB:Et,WEBSQL:m,LOCALSTORAGE:$e},rt=[De.INDEXEDDB._driver,De.WEBSQL._driver,De.LOCALSTORAGE._driver],ze=["dropInstance"],St=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ze),wt={description:"",driver:rt.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function pr(o,d){o[d]=function(){var l=arguments;return o.ready().then(function(){return o[d].apply(o,l)})}}function ar(){for(var o=1;o<arguments.length;o++){var d=arguments[o];if(d)for(var l in d)d.hasOwnProperty(l)&&(He(d[l])?arguments[0][l]=d[l].slice():arguments[0][l]=d[l])}return arguments[0]}var Rr=function(){function o(d){c(this,o);for(var l in De)if(De.hasOwnProperty(l)){var g=De[l],b=g._driver;this[l]=b,Ne[b]||this.defineDriver(g)}this._defaultConfig=ar({},wt),this._config=ar({},this._defaultConfig,d),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return o.prototype.config=function(l){if((typeof l>"u"?"undefined":i(l))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var g in l){if(g==="storeName"&&(l[g]=l[g].replace(/\W/g,"_")),g==="version"&&typeof l[g]!="number")return new Error("Database version must be a number.");this._config[g]=l[g]}return"driver"in l&&l.driver?this.setDriver(this._config.driver):!0}else return typeof l=="string"?this._config[l]:this._config},o.prototype.defineDriver=function(l,g,b){var v=new _(function(T,k){try{var I=l._driver,D=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!l._driver){k(D);return}for(var A=St.concat("_initStorage"),F=0,Y=A.length;F<Y;F++){var le=A[F],me=!Ut(ze,le);if((me||l[le])&&typeof l[le]!="function"){k(D);return}}var ve=function(){for(var Nt=function(ha){return function(){var Ps=new Error("Method "+ha+" is not implemented by the current driver"),va=_.reject(Ps);return $(va,arguments[arguments.length-1]),va}},At=0,Oo=ze.length;At<Oo;At++){var Lt=ze[At];l[Lt]||(l[Lt]=Nt(Lt))}};ve();var ge=function(Nt){Ne[I]&&console.info("Redefining LocalForage driver: "+I),Ne[I]=l,he[I]=Nt,T()};"_support"in l?l._support&&typeof l._support=="function"?l._support().then(ge,k):ge(!!l._support):ge(!0)}catch(Ve){k(Ve)}});return C(v,g,b),v},o.prototype.driver=function(){return this._driver||null},o.prototype.getDriver=function(l,g,b){var v=Ne[l]?_.resolve(Ne[l]):_.reject(new Error("Driver not found."));return C(v,g,b),v},o.prototype.getSerializer=function(l){var g=_.resolve(dn);return C(g,l),g},o.prototype.ready=function(l){var g=this,b=g._driverSet.then(function(){return g._ready===null&&(g._ready=g._initDriver()),g._ready});return C(b,l,l),b},o.prototype.setDriver=function(l,g,b){var v=this;He(l)||(l=[l]);var T=this._getSupportedDrivers(l);function k(){v._config.driver=v.driver()}function I(F){return v._extend(F),k(),v._ready=v._initStorage(v._config),v._ready}function D(F){return function(){var Y=0;function le(){for(;Y<F.length;){var me=F[Y];return Y++,v._dbInfo=null,v._ready=null,v.getDriver(me).then(I).catch(le)}k();var ve=new Error("No available storage method found.");return v._driverSet=_.reject(ve),v._driverSet}return le()}}var A=this._driverSet!==null?this._driverSet.catch(function(){return _.resolve()}):_.resolve();return this._driverSet=A.then(function(){var F=T[0];return v._dbInfo=null,v._ready=null,v.getDriver(F).then(function(Y){v._driver=Y._driver,k(),v._wrapLibraryMethodsWithReady(),v._initDriver=D(T)})}).catch(function(){k();var F=new Error("No available storage method found.");return v._driverSet=_.reject(F),v._driverSet}),C(this._driverSet,g,b),this._driverSet},o.prototype.supports=function(l){return!!he[l]},o.prototype._extend=function(l){ar(this,l)},o.prototype._getSupportedDrivers=function(l){for(var g=[],b=0,v=l.length;b<v;b++){var T=l[b];this.supports(T)&&g.push(T)}return g},o.prototype._wrapLibraryMethodsWithReady=function(){for(var l=0,g=St.length;l<g;l++)pr(this,St[l])},o.prototype.createInstance=function(l){return new o(l)},o}(),sr=new Rr;a.exports=sr},{3:3}]},{},[4])(4)})});var Mn=j(ue=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.regexpCode=ue.getEsmExportName=ue.getProperty=ue.safeStringify=ue.stringify=ue.strConcat=ue.addCodeArg=ue.str=ue._=ue.nil=ue._Code=ue.Name=ue.IDENTIFIER=ue._CodeOrName=void 0;var wn=class{};ue._CodeOrName=wn;ue.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var br=class extends wn{constructor(e){if(super(),!ue.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};ue.Name=br;var vt=class extends wn{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,n)=>(n instanceof br&&(r[n.str]=(r[n.str]||0)+1),r),{})}};ue._Code=vt;ue.nil=new vt("");function Il(t,...e){let r=[t[0]],n=0;for(;n<e.length;)ni(r,e[n]),r.push(t[++n]);return new vt(r)}ue._=Il;var ri=new vt("+");function Dl(t,...e){let r=[Cn(t[0])],n=0;for(;n<e.length;)r.push(ri),ni(r,e[n]),r.push(ri,Cn(t[++n]));return zd(r),new vt(r)}ue.str=Dl;function ni(t,e){e instanceof vt?t.push(...e._items):e instanceof br?t.push(e):t.push(Yd(e))}ue.addCodeArg=ni;function zd(t){let e=1;for(;e<t.length-1;){if(t[e]===ri){let r=Kd(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function Kd(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof br||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof br))return`"${t}${e.slice(1)}`}function Wd(t,e){return e.emptyStr()?t:t.emptyStr()?e:Dl`${t}${e}`}ue.strConcat=Wd;function Yd(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:Cn(Array.isArray(t)?t.join(","):t)}function Jd(t){return new vt(Cn(t))}ue.stringify=Jd;function Cn(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}ue.safeStringify=Cn;function Qd(t){return typeof t=="string"&&ue.IDENTIFIER.test(t)?new vt(`.${t}`):Il`[${t}]`}ue.getProperty=Qd;function Xd(t){if(typeof t=="string"&&ue.IDENTIFIER.test(t))return new vt(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}ue.getEsmExportName=Xd;function Zd(t){return new vt(t.toString())}ue.regexpCode=Zd});var oi=j(Je=>{"use strict";Object.defineProperty(Je,"__esModule",{value:!0});Je.ValueScope=Je.ValueScopeName=Je.Scope=Je.varKinds=Je.UsedValueState=void 0;var it=Mn(),ai=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},si;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(si=Je.UsedValueState||(Je.UsedValueState={}));Je.varKinds={const:new it.Name("const"),let:new it.Name("let"),var:new it.Name("var")};var ja=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof it.Name?e:this.name(e)}name(e){return new it.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,n;if(((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0?void 0:n.has(e))||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};Je.Scope=ja;var Fa=class extends it.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=(0,it._)`.${new it.Name(r)}[${n}]`}};Je.ValueScopeName=Fa;var ef=(0,it._)`\n`,ii=class extends ja{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts=nt(ce({},e),{_n:e.lines?ef:it.nil})}get(){return this._scope}name(e){return new Fa(e,this._newName(e))}value(e,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let a=this.toName(e),{prefix:s}=a,i=(n=r.key)!==null&&n!==void 0?n:r.ref,c=this._values[s];if(c){let p=c.get(i);if(p)return p}else c=this._values[s]=new Map;c.set(i,a);let f=this._scope[s]||(this._scope[s]=[]),y=f.length;return f[y]=r.ref,a.setValue(r,{property:s,itemIndex:y}),a}getValue(e,r){let n=this._values[e];if(!!n)return n.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,it._)`${e}${n.scopePath}`})}scopeCode(e=this._values,r,n){return this._reduceValues(e,a=>{if(a.value===void 0)throw new Error(`CodeGen: name "${a}" has no value`);return a.value.code},r,n)}_reduceValues(e,r,n={},a){let s=it.nil;for(let i in e){let c=e[i];if(!c)continue;let f=n[i]=n[i]||new Map;c.forEach(y=>{if(f.has(y))return;f.set(y,si.Started);let p=r(y);if(p){let E=this.opts.es5?Je.varKinds.var:Je.varKinds.const;s=(0,it._)`${s}${E} ${y} = ${p};${this.opts._n}`}else if(p=a==null?void 0:a(y))s=(0,it._)`${s}${p}${this.opts._n}`;else throw new ai(y);f.set(y,si.Completed)})}return s}};Je.ValueScope=ii});var Z=j(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.or=Q.and=Q.not=Q.CodeGen=Q.operators=Q.varKinds=Q.ValueScopeName=Q.ValueScope=Q.Scope=Q.Name=Q.regexpCode=Q.stringify=Q.getProperty=Q.nil=Q.strConcat=Q.str=Q._=void 0;var ne=Mn(),Mt=oi(),or=Mn();Object.defineProperty(Q,"_",{enumerable:!0,get:function(){return or._}});Object.defineProperty(Q,"str",{enumerable:!0,get:function(){return or.str}});Object.defineProperty(Q,"strConcat",{enumerable:!0,get:function(){return or.strConcat}});Object.defineProperty(Q,"nil",{enumerable:!0,get:function(){return or.nil}});Object.defineProperty(Q,"getProperty",{enumerable:!0,get:function(){return or.getProperty}});Object.defineProperty(Q,"stringify",{enumerable:!0,get:function(){return or.stringify}});Object.defineProperty(Q,"regexpCode",{enumerable:!0,get:function(){return or.regexpCode}});Object.defineProperty(Q,"Name",{enumerable:!0,get:function(){return or.Name}});var Ua=oi();Object.defineProperty(Q,"Scope",{enumerable:!0,get:function(){return Ua.Scope}});Object.defineProperty(Q,"ValueScope",{enumerable:!0,get:function(){return Ua.ValueScope}});Object.defineProperty(Q,"ValueScopeName",{enumerable:!0,get:function(){return Ua.ValueScopeName}});Object.defineProperty(Q,"varKinds",{enumerable:!0,get:function(){return Ua.varKinds}});Q.operators={GT:new ne._Code(">"),GTE:new ne._Code(">="),LT:new ne._Code("<"),LTE:new ne._Code("<="),EQ:new ne._Code("==="),NEQ:new ne._Code("!=="),NOT:new ne._Code("!"),OR:new ne._Code("||"),AND:new ne._Code("&&"),ADD:new ne._Code("+")};var Wt=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},li=class extends Wt{constructor(e,r,n){super(),this.varKind=e,this.name=r,this.rhs=n}render({es5:e,_n:r}){let n=e?Mt.varKinds.var:this.varKind,a=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${a};`+r}optimizeNames(e,r){if(!!e[this.name.str])return this.rhs&&(this.rhs=Br(this.rhs,e,r)),this}get names(){return this.rhs instanceof ne._CodeOrName?this.rhs.names:{}}},Ha=class extends Wt{constructor(e,r,n){super(),this.lhs=e,this.rhs=r,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof ne.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=Br(this.rhs,e,r),this}get names(){let e=this.lhs instanceof ne.Name?{}:ce({},this.lhs.names);return Ba(e,this.rhs)}},ci=class extends Ha{constructor(e,r,n,a){super(e,n,a),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},ui=class extends Wt{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},di=class extends Wt{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},fi=class extends Wt{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},mi=class extends Wt{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=Br(this.code,e,r),this}get names(){return this.code instanceof ne._CodeOrName?this.code.names:{}}},Tn=class extends Wt{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,n)=>r+n.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let n=e[r].optimizeNodes();Array.isArray(n)?e.splice(r,1,...n):n?e[r]=n:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:n}=this,a=n.length;for(;a--;){let s=n[a];s.optimizeNames(e,r)||(tf(e,s.names),n.splice(a,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>Er(e,r.names),{})}},Yt=class extends Tn{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},pi=class extends Tn{},Vr=class extends Yt{};Vr.kind="else";var Tt=class extends Yt{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new Vr(n):n}if(r)return e===!1?r instanceof Tt?r:r.nodes:this.nodes.length?this:new Tt(Rl(e),r instanceof Tt?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=Br(this.condition,e,r),this}get names(){let e=super.names;return Ba(e,this.condition),this.else&&Er(e,this.else.names),e}};Tt.kind="if";var _r=class extends Yt{};_r.kind="for";var hi=class extends _r{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(!!super.optimizeNames(e,r))return this.iteration=Br(this.iteration,e,r),this}get names(){return Er(super.names,this.iteration.names)}},vi=class extends _r{constructor(e,r,n,a){super(),this.varKind=e,this.name=r,this.from=n,this.to=a}render(e){let r=e.es5?Mt.varKinds.var:this.varKind,{name:n,from:a,to:s}=this;return`for(${r} ${n}=${a}; ${n}<${s}; ${n}++)`+super.render(e)}get names(){let e=Ba(super.names,this.from);return Ba(e,this.to)}},Va=class extends _r{constructor(e,r,n,a){super(),this.loop=e,this.varKind=r,this.name=n,this.iterable=a}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(!!super.optimizeNames(e,r))return this.iterable=Br(this.iterable,e,r),this}get names(){return Er(super.names,this.iterable.names)}},Pn=class extends Yt{constructor(e,r,n){super(),this.name=e,this.args=r,this.async=n}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};Pn.kind="func";var kn=class extends Tn{render(e){return"return "+super.render(e)}};kn.kind="return";var gi=class extends Yt{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var n,a;return super.optimizeNames(e,r),(n=this.catch)===null||n===void 0||n.optimizeNames(e,r),(a=this.finally)===null||a===void 0||a.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&Er(e,this.catch.names),this.finally&&Er(e,this.finally.names),e}},In=class extends Yt{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};In.kind="catch";var Dn=class extends Yt{render(e){return"finally"+super.render(e)}};Dn.kind="finally";var yi=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts=nt(ce({},r),{_n:r.lines?`
`:""}),this._extScope=e,this._scope=new Mt.Scope({parent:e}),this._nodes=[new pi]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let n=this._extScope.value(e,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,n,a){let s=this._scope.toName(r);return n!==void 0&&a&&(this._constants[s.str]=n),this._leafNode(new li(e,s,n)),s}const(e,r,n){return this._def(Mt.varKinds.const,e,r,n)}let(e,r,n){return this._def(Mt.varKinds.let,e,r,n)}var(e,r,n){return this._def(Mt.varKinds.var,e,r,n)}assign(e,r,n){return this._leafNode(new Ha(e,r,n))}add(e,r){return this._leafNode(new ci(e,Q.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==ne.nil&&this._leafNode(new mi(e)),this}object(...e){let r=["{"];for(let[n,a]of e)r.length>1&&r.push(","),r.push(n),(n!==a||this.opts.es5)&&(r.push(":"),(0,ne.addCodeArg)(r,a));return r.push("}"),new ne._Code(r)}if(e,r,n){if(this._blockNode(new Tt(e)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new Tt(e))}else(){return this._elseNode(new Vr)}endIf(){return this._endBlockNode(Tt,Vr)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new hi(e),r)}forRange(e,r,n,a,s=this.opts.es5?Mt.varKinds.var:Mt.varKinds.let){let i=this._scope.toName(e);return this._for(new vi(s,i,r,n),()=>a(i))}forOf(e,r,n,a=Mt.varKinds.const){let s=this._scope.toName(e);if(this.opts.es5){let i=r instanceof ne.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,ne._)`${i}.length`,c=>{this.var(s,(0,ne._)`${i}[${c}]`),n(s)})}return this._for(new Va("of",a,s,r),()=>n(s))}forIn(e,r,n,a=this.opts.es5?Mt.varKinds.var:Mt.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,ne._)`Object.keys(${r})`,n);let s=this._scope.toName(e);return this._for(new Va("in",a,s,r),()=>n(s))}endFor(){return this._endBlockNode(_r)}label(e){return this._leafNode(new ui(e))}break(e){return this._leafNode(new di(e))}return(e){let r=new kn;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(kn)}try(e,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let a=new gi;if(this._blockNode(a),this.code(e),r){let s=this.name("e");this._currNode=a.catch=new In(s),r(s)}return n&&(this._currNode=a.finally=new Dn,this.code(n)),this._endBlockNode(In,Dn)}throw(e){return this._leafNode(new fi(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=ne.nil,n,a){return this._blockNode(new Pn(e,r,n)),a&&this.code(a).endFunc(),this}endFunc(){return this._endBlockNode(Pn)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let n=this._currNode;if(n instanceof e||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof Tt))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};Q.CodeGen=yi;function Er(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function Ba(t,e){return e instanceof ne._CodeOrName?Er(t,e.names):t}function Br(t,e,r){if(t instanceof ne.Name)return n(t);if(!a(t))return t;return new ne._Code(t._items.reduce((s,i)=>(i instanceof ne.Name&&(i=n(i)),i instanceof ne._Code?s.push(...i._items):s.push(i),s),[]));function n(s){let i=r[s.str];return i===void 0||e[s.str]!==1?s:(delete e[s.str],i)}function a(s){return s instanceof ne._Code&&s._items.some(i=>i instanceof ne.Name&&e[i.str]===1&&r[i.str]!==void 0)}}function tf(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function Rl(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,ne._)`!${bi(t)}`}Q.not=Rl;var rf=Nl(Q.operators.AND);function nf(...t){return t.reduce(rf)}Q.and=nf;var af=Nl(Q.operators.OR);function sf(...t){return t.reduce(af)}Q.or=sf;function Nl(t){return(e,r)=>e===ne.nil?r:r===ne.nil?e:(0,ne._)`${bi(e)} ${t} ${bi(r)}`}function bi(t){return t instanceof ne.Name?t:(0,ne._)`(${t})`}});var de=j(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.checkStrictMode=X.getErrorPath=X.Type=X.useFunc=X.setEvaluated=X.evaluatedPropsToName=X.mergeEvaluated=X.eachItem=X.unescapeJsonPointer=X.escapeJsonPointer=X.escapeFragment=X.unescapeFragment=X.schemaRefOrVal=X.schemaHasRulesButRef=X.schemaHasRules=X.checkUnknownRules=X.alwaysValidSchema=X.toHash=void 0;var be=Z(),of=Mn();function lf(t){let e={};for(let r of t)e[r]=!0;return e}X.toHash=lf;function cf(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(Ol(t,e),!xl(e,t.self.RULES.all))}X.alwaysValidSchema=cf;function Ol(t,e=t.schema){let{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;let a=n.RULES.keywords;for(let s in e)a[s]||Hl(t,`unknown keyword: "${s}"`)}X.checkUnknownRules=Ol;function xl(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}X.schemaHasRules=xl;function uf(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}X.schemaHasRulesButRef=uf;function df({topSchemaRef:t,schemaPath:e},r,n,a){if(!a){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,be._)`${r}`}return(0,be._)`${t}${e}${(0,be.getProperty)(n)}`}X.schemaRefOrVal=df;function ff(t){return ql(decodeURIComponent(t))}X.unescapeFragment=ff;function mf(t){return encodeURIComponent(_i(t))}X.escapeFragment=mf;function _i(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}X.escapeJsonPointer=_i;function ql(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}X.unescapeJsonPointer=ql;function pf(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}X.eachItem=pf;function Al({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(a,s,i,c)=>{let f=i===void 0?s:i instanceof be.Name?(s instanceof be.Name?t(a,s,i):e(a,s,i),i):s instanceof be.Name?(e(a,i,s),s):r(s,i);return c===be.Name&&!(f instanceof be.Name)?n(a,f):f}}X.mergeEvaluated={props:Al({mergeNames:(t,e,r)=>t.if((0,be._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,be._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,be._)`${r} || {}`).code((0,be._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,be._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,be._)`${r} || {}`),Ei(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:ce(ce({},t),e),resultToName:jl}),items:Al({mergeNames:(t,e,r)=>t.if((0,be._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,be._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,be._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,be._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function jl(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,be._)`{}`);return e!==void 0&&Ei(t,r,e),r}X.evaluatedPropsToName=jl;function Ei(t,e,r){Object.keys(r).forEach(n=>t.assign((0,be._)`${e}${(0,be.getProperty)(n)}`,!0))}X.setEvaluated=Ei;var Ll={};function hf(t,e){return t.scopeValue("func",{ref:e,code:Ll[e.code]||(Ll[e.code]=new of._Code(e.code))})}X.useFunc=hf;var Fl;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(Fl=X.Type||(X.Type={}));function vf(t,e,r){if(t instanceof be.Name){let n=e===Fl.Num;return r?n?(0,be._)`"[" + ${t} + "]"`:(0,be._)`"['" + ${t} + "']"`:n?(0,be._)`"/" + ${t}`:(0,be._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,be.getProperty)(t).toString():"/"+_i(t)}X.getErrorPath=vf;function Hl(t,e,r=t.opts.strictSchema){if(!!r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}X.checkStrictMode=Hl});var Jt=j($i=>{"use strict";Object.defineProperty($i,"__esModule",{value:!0});var Ue=Z(),gf={data:new Ue.Name("data"),valCxt:new Ue.Name("valCxt"),instancePath:new Ue.Name("instancePath"),parentData:new Ue.Name("parentData"),parentDataProperty:new Ue.Name("parentDataProperty"),rootData:new Ue.Name("rootData"),dynamicAnchors:new Ue.Name("dynamicAnchors"),vErrors:new Ue.Name("vErrors"),errors:new Ue.Name("errors"),this:new Ue.Name("this"),self:new Ue.Name("self"),scope:new Ue.Name("scope"),json:new Ue.Name("json"),jsonPos:new Ue.Name("jsonPos"),jsonLen:new Ue.Name("jsonLen"),jsonPart:new Ue.Name("jsonPart")};$i.default=gf});var Rn=j(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.extendErrors=Ge.resetErrorsCount=Ge.reportExtraError=Ge.reportError=Ge.keyword$DataError=Ge.keywordError=void 0;var ie=Z(),Ga=de(),Qe=Jt();Ge.keywordError={message:({keyword:t})=>(0,ie.str)`must pass "${t}" keyword validation`};Ge.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,ie.str)`"${t}" keyword must be ${e} ($data)`:(0,ie.str)`"${t}" keyword is invalid ($data)`};function yf(t,e=Ge.keywordError,r,n){let{it:a}=t,{gen:s,compositeRule:i,allErrors:c}=a,f=Ul(t,e,r);(n!=null?n:i||c)?Vl(s,f):Bl(a,(0,ie._)`[${f}]`)}Ge.reportError=yf;function bf(t,e=Ge.keywordError,r){let{it:n}=t,{gen:a,compositeRule:s,allErrors:i}=n,c=Ul(t,e,r);Vl(a,c),s||i||Bl(n,Qe.default.vErrors)}Ge.reportExtraError=bf;function _f(t,e){t.assign(Qe.default.errors,e),t.if((0,ie._)`${Qe.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,ie._)`${Qe.default.vErrors}.length`,e),()=>t.assign(Qe.default.vErrors,null)))}Ge.resetErrorsCount=_f;function Ef({gen:t,keyword:e,schemaValue:r,data:n,errsCount:a,it:s}){if(a===void 0)throw new Error("ajv implementation error");let i=t.name("err");t.forRange("i",a,Qe.default.errors,c=>{t.const(i,(0,ie._)`${Qe.default.vErrors}[${c}]`),t.if((0,ie._)`${i}.instancePath === undefined`,()=>t.assign((0,ie._)`${i}.instancePath`,(0,ie.strConcat)(Qe.default.instancePath,s.errorPath))),t.assign((0,ie._)`${i}.schemaPath`,(0,ie.str)`${s.errSchemaPath}/${e}`),s.opts.verbose&&(t.assign((0,ie._)`${i}.schema`,r),t.assign((0,ie._)`${i}.data`,n))})}Ge.extendErrors=Ef;function Vl(t,e){let r=t.const("err",e);t.if((0,ie._)`${Qe.default.vErrors} === null`,()=>t.assign(Qe.default.vErrors,(0,ie._)`[${r}]`),(0,ie._)`${Qe.default.vErrors}.push(${r})`),t.code((0,ie._)`${Qe.default.errors}++`)}function Bl(t,e){let{gen:r,validateName:n,schemaEnv:a}=t;a.$async?r.throw((0,ie._)`new ${t.ValidationError}(${e})`):(r.assign((0,ie._)`${n}.errors`,e),r.return(!1))}var $r={keyword:new ie.Name("keyword"),schemaPath:new ie.Name("schemaPath"),params:new ie.Name("params"),propertyName:new ie.Name("propertyName"),message:new ie.Name("message"),schema:new ie.Name("schema"),parentSchema:new ie.Name("parentSchema")};function Ul(t,e,r){let{createErrors:n}=t.it;return n===!1?(0,ie._)`{}`:$f(t,e,r)}function $f(t,e,r={}){let{gen:n,it:a}=t,s=[Sf(a,r),wf(t,r)];return Cf(t,e,s),n.object(...s)}function Sf({errorPath:t},{instancePath:e}){let r=e?(0,ie.str)`${t}${(0,Ga.getErrorPath)(e,Ga.Type.Str)}`:t;return[Qe.default.instancePath,(0,ie.strConcat)(Qe.default.instancePath,r)]}function wf({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:n}){let a=n?e:(0,ie.str)`${e}/${t}`;return r&&(a=(0,ie.str)`${a}${(0,Ga.getErrorPath)(r,Ga.Type.Str)}`),[$r.schemaPath,a]}function Cf(t,{params:e,message:r},n){let{keyword:a,data:s,schemaValue:i,it:c}=t,{opts:f,propertyName:y,topSchemaRef:p,schemaPath:E}=c;n.push([$r.keyword,a],[$r.params,typeof e=="function"?e(t):e||(0,ie._)`{}`]),f.messages&&n.push([$r.message,typeof r=="function"?r(t):r]),f.verbose&&n.push([$r.schema,i],[$r.parentSchema,(0,ie._)`${p}${E}`],[Qe.default.data,s]),y&&n.push([$r.propertyName,y])}});var zl=j(Ur=>{"use strict";Object.defineProperty(Ur,"__esModule",{value:!0});Ur.boolOrEmptySchema=Ur.topBoolOrEmptySchema=void 0;var Mf=Rn(),Tf=Z(),Pf=Jt(),kf={message:"boolean schema is false"};function If(t){let{gen:e,schema:r,validateName:n}=t;r===!1?Gl(t,!1):typeof r=="object"&&r.$async===!0?e.return(Pf.default.data):(e.assign((0,Tf._)`${n}.errors`,null),e.return(!0))}Ur.topBoolOrEmptySchema=If;function Df(t,e){let{gen:r,schema:n}=t;n===!1?(r.var(e,!1),Gl(t)):r.var(e,!0)}Ur.boolOrEmptySchema=Df;function Gl(t,e){let{gen:r,data:n}=t,a={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,Mf.reportError)(a,kf,void 0,e)}});var Si=j(Gr=>{"use strict";Object.defineProperty(Gr,"__esModule",{value:!0});Gr.getRules=Gr.isJSONType=void 0;var Rf=["string","number","integer","boolean","null","object","array"],Nf=new Set(Rf);function Af(t){return typeof t=="string"&&Nf.has(t)}Gr.isJSONType=Af;function Lf(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:nt(ce({},t),{integer:!0,boolean:!0,null:!0}),rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}Gr.getRules=Lf});var wi=j(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.shouldUseRule=lr.shouldUseGroup=lr.schemaHasRulesForType=void 0;function Of({schema:t,self:e},r){let n=e.RULES.types[r];return n&&n!==!0&&Kl(t,n)}lr.schemaHasRulesForType=Of;function Kl(t,e){return e.rules.some(r=>Wl(t,r))}lr.shouldUseGroup=Kl;function Wl(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}lr.shouldUseRule=Wl});var An=j(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0});qe.reportTypeError=qe.checkDataTypes=qe.checkDataType=qe.coerceAndCheckDataType=qe.getJSONTypes=qe.getSchemaTypes=qe.DataType=void 0;var xf=Si(),qf=wi(),jf=Rn(),W=Z(),Yl=de(),Nn;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(Nn=qe.DataType||(qe.DataType={}));function Ff(t){let e=Jl(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}qe.getSchemaTypes=Ff;function Jl(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(xf.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}qe.getJSONTypes=Jl;function Hf(t,e){let{gen:r,data:n,opts:a}=t,s=Vf(e,a.coerceTypes),i=e.length>0&&!(s.length===0&&e.length===1&&(0,qf.schemaHasRulesForType)(t,e[0]));if(i){let c=Mi(e,n,a.strictNumbers,Nn.Wrong);r.if(c,()=>{s.length?Bf(t,e,s):Ti(t)})}return i}qe.coerceAndCheckDataType=Hf;var Ql=new Set(["string","number","integer","boolean","null"]);function Vf(t,e){return e?t.filter(r=>Ql.has(r)||e==="array"&&r==="array"):[]}function Bf(t,e,r){let{gen:n,data:a,opts:s}=t,i=n.let("dataType",(0,W._)`typeof ${a}`),c=n.let("coerced",(0,W._)`undefined`);s.coerceTypes==="array"&&n.if((0,W._)`${i} == 'object' && Array.isArray(${a}) && ${a}.length == 1`,()=>n.assign(a,(0,W._)`${a}[0]`).assign(i,(0,W._)`typeof ${a}`).if(Mi(e,a,s.strictNumbers),()=>n.assign(c,a))),n.if((0,W._)`${c} !== undefined`);for(let y of r)(Ql.has(y)||y==="array"&&s.coerceTypes==="array")&&f(y);n.else(),Ti(t),n.endIf(),n.if((0,W._)`${c} !== undefined`,()=>{n.assign(a,c),Uf(t,c)});function f(y){switch(y){case"string":n.elseIf((0,W._)`${i} == "number" || ${i} == "boolean"`).assign(c,(0,W._)`"" + ${a}`).elseIf((0,W._)`${a} === null`).assign(c,(0,W._)`""`);return;case"number":n.elseIf((0,W._)`${i} == "boolean" || ${a} === null
              || (${i} == "string" && ${a} && ${a} == +${a})`).assign(c,(0,W._)`+${a}`);return;case"integer":n.elseIf((0,W._)`${i} === "boolean" || ${a} === null
              || (${i} === "string" && ${a} && ${a} == +${a} && !(${a} % 1))`).assign(c,(0,W._)`+${a}`);return;case"boolean":n.elseIf((0,W._)`${a} === "false" || ${a} === 0 || ${a} === null`).assign(c,!1).elseIf((0,W._)`${a} === "true" || ${a} === 1`).assign(c,!0);return;case"null":n.elseIf((0,W._)`${a} === "" || ${a} === 0 || ${a} === false`),n.assign(c,null);return;case"array":n.elseIf((0,W._)`${i} === "string" || ${i} === "number"
              || ${i} === "boolean" || ${a} === null`).assign(c,(0,W._)`[${a}]`)}}}function Uf({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,W._)`${e} !== undefined`,()=>t.assign((0,W._)`${e}[${r}]`,n))}function Ci(t,e,r,n=Nn.Correct){let a=n===Nn.Correct?W.operators.EQ:W.operators.NEQ,s;switch(t){case"null":return(0,W._)`${e} ${a} null`;case"array":s=(0,W._)`Array.isArray(${e})`;break;case"object":s=(0,W._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":s=i((0,W._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":s=i();break;default:return(0,W._)`typeof ${e} ${a} ${t}`}return n===Nn.Correct?s:(0,W.not)(s);function i(c=W.nil){return(0,W.and)((0,W._)`typeof ${e} == "number"`,c,r?(0,W._)`isFinite(${e})`:W.nil)}}qe.checkDataType=Ci;function Mi(t,e,r,n){if(t.length===1)return Ci(t[0],e,r,n);let a,s=(0,Yl.toHash)(t);if(s.array&&s.object){let i=(0,W._)`typeof ${e} != "object"`;a=s.null?i:(0,W._)`!${e} || ${i}`,delete s.null,delete s.array,delete s.object}else a=W.nil;s.number&&delete s.integer;for(let i in s)a=(0,W.and)(a,Ci(i,e,r,n));return a}qe.checkDataTypes=Mi;var Gf={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,W._)`{type: ${t}}`:(0,W._)`{type: ${e}}`};function Ti(t){let e=zf(t);(0,jf.reportError)(e,Gf)}qe.reportTypeError=Ti;function zf(t){let{gen:e,data:r,schema:n}=t,a=(0,Yl.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:a,schemaValue:a,parentSchema:n,params:{},it:t}}});var Zl=j(za=>{"use strict";Object.defineProperty(za,"__esModule",{value:!0});za.assignDefaults=void 0;var zr=Z(),Kf=de();function Wf(t,e){let{properties:r,items:n}=t.schema;if(e==="object"&&r)for(let a in r)Xl(t,a,r[a].default);else e==="array"&&Array.isArray(n)&&n.forEach((a,s)=>Xl(t,s,a.default))}za.assignDefaults=Wf;function Xl(t,e,r){let{gen:n,compositeRule:a,data:s,opts:i}=t;if(r===void 0)return;let c=(0,zr._)`${s}${(0,zr.getProperty)(e)}`;if(a){(0,Kf.checkStrictMode)(t,`default is ignored for: ${c}`);return}let f=(0,zr._)`${c} === undefined`;i.useDefaults==="empty"&&(f=(0,zr._)`${f} || ${c} === null || ${c} === ""`),n.if(f,(0,zr._)`${c} = ${(0,zr.stringify)(r)}`)}});var gt=j(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.validateUnion=ye.validateArray=ye.usePattern=ye.callValidateCode=ye.schemaProperties=ye.allSchemaProperties=ye.noPropertyInData=ye.propertyInData=ye.isOwnProperty=ye.hasPropFunc=ye.reportMissingProp=ye.checkMissingProp=ye.checkReportMissingProp=void 0;var Se=Z(),Pi=de(),cr=Jt(),Yf=de();function Jf(t,e){let{gen:r,data:n,it:a}=t;r.if(Ii(r,n,e,a.opts.ownProperties),()=>{t.setParams({missingProperty:(0,Se._)`${e}`},!0),t.error()})}ye.checkReportMissingProp=Jf;function Qf({gen:t,data:e,it:{opts:r}},n,a){return(0,Se.or)(...n.map(s=>(0,Se.and)(Ii(t,e,s,r.ownProperties),(0,Se._)`${a} = ${s}`)))}ye.checkMissingProp=Qf;function Xf(t,e){t.setParams({missingProperty:e},!0),t.error()}ye.reportMissingProp=Xf;function ec(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,Se._)`Object.prototype.hasOwnProperty`})}ye.hasPropFunc=ec;function ki(t,e,r){return(0,Se._)`${ec(t)}.call(${e}, ${r})`}ye.isOwnProperty=ki;function Zf(t,e,r,n){let a=(0,Se._)`${e}${(0,Se.getProperty)(r)} !== undefined`;return n?(0,Se._)`${a} && ${ki(t,e,r)}`:a}ye.propertyInData=Zf;function Ii(t,e,r,n){let a=(0,Se._)`${e}${(0,Se.getProperty)(r)} === undefined`;return n?(0,Se.or)(a,(0,Se.not)(ki(t,e,r))):a}ye.noPropertyInData=Ii;function tc(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}ye.allSchemaProperties=tc;function em(t,e){return tc(e).filter(r=>!(0,Pi.alwaysValidSchema)(t,e[r]))}ye.schemaProperties=em;function tm({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:a,errorPath:s},it:i},c,f,y){let p=y?(0,Se._)`${t}, ${e}, ${n}${a}`:e,E=[[cr.default.instancePath,(0,Se.strConcat)(cr.default.instancePath,s)],[cr.default.parentData,i.parentData],[cr.default.parentDataProperty,i.parentDataProperty],[cr.default.rootData,cr.default.rootData]];i.opts.dynamicRef&&E.push([cr.default.dynamicAnchors,cr.default.dynamicAnchors]);let _=(0,Se._)`${p}, ${r.object(...E)}`;return f!==Se.nil?(0,Se._)`${c}.call(${f}, ${_})`:(0,Se._)`${c}(${_})`}ye.callValidateCode=tm;var rm=(0,Se._)`new RegExp`;function nm({gen:t,it:{opts:e}},r){let n=e.unicodeRegExp?"u":"",{regExp:a}=e.code,s=a(r,n);return t.scopeValue("pattern",{key:s.toString(),ref:s,code:(0,Se._)`${a.code==="new RegExp"?rm:(0,Yf.useFunc)(t,a)}(${r}, ${n})`})}ye.usePattern=nm;function am(t){let{gen:e,data:r,keyword:n,it:a}=t,s=e.name("valid");if(a.allErrors){let c=e.let("valid",!0);return i(()=>e.assign(c,!1)),c}return e.var(s,!0),i(()=>e.break()),s;function i(c){let f=e.const("len",(0,Se._)`${r}.length`);e.forRange("i",0,f,y=>{t.subschema({keyword:n,dataProp:y,dataPropType:Pi.Type.Num},s),e.if((0,Se.not)(s),c)})}}ye.validateArray=am;function sm(t){let{gen:e,schema:r,keyword:n,it:a}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(f=>(0,Pi.alwaysValidSchema)(a,f))&&!a.opts.unevaluated)return;let i=e.let("valid",!1),c=e.name("_valid");e.block(()=>r.forEach((f,y)=>{let p=t.subschema({keyword:n,schemaProp:y,compositeRule:!0},c);e.assign(i,(0,Se._)`${i} || ${c}`),t.mergeValidEvaluated(p,c)||e.if((0,Se.not)(i))})),t.result(i,()=>t.reset(),()=>t.error(!0))}ye.validateUnion=sm});var ac=j(Ft=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.validateKeywordUsage=Ft.validSchemaType=Ft.funcKeywordCode=Ft.macroKeywordCode=void 0;var Xe=Z(),Sr=Jt(),im=gt(),om=Rn();function lm(t,e){let{gen:r,keyword:n,schema:a,parentSchema:s,it:i}=t,c=e.macro.call(i.self,a,s,i),f=nc(r,n,c);i.opts.validateSchema!==!1&&i.self.validateSchema(c,!0);let y=r.name("valid");t.subschema({schema:c,schemaPath:Xe.nil,errSchemaPath:`${i.errSchemaPath}/${n}`,topSchemaRef:f,compositeRule:!0},y),t.pass(y,()=>t.error(!0))}Ft.macroKeywordCode=lm;function cm(t,e){var r;let{gen:n,keyword:a,schema:s,parentSchema:i,$data:c,it:f}=t;dm(f,e);let y=!c&&e.compile?e.compile.call(f.self,s,i,f):e.validate,p=nc(n,a,y),E=n.let("valid");t.block$data(E,_),t.ok((r=e.valid)!==null&&r!==void 0?r:E);function _(){if(e.errors===!1)M(),e.modifying&&rc(t),R(()=>t.error());else{let N=e.async?$():C();e.modifying&&rc(t),R(()=>um(t,N))}}function $(){let N=n.let("ruleErrs",null);return n.try(()=>M((0,Xe._)`await `),U=>n.assign(E,!1).if((0,Xe._)`${U} instanceof ${f.ValidationError}`,()=>n.assign(N,(0,Xe._)`${U}.errors`),()=>n.throw(U))),N}function C(){let N=(0,Xe._)`${p}.errors`;return n.assign(N,null),M(Xe.nil),N}function M(N=e.async?(0,Xe._)`await `:Xe.nil){let U=f.opts.passContext?Sr.default.this:Sr.default.self,H=!("compile"in e&&!c||e.schema===!1);n.assign(E,(0,Xe._)`${N}${(0,im.callValidateCode)(t,p,U,H)}`,e.modifying)}function R(N){var U;n.if((0,Xe.not)((U=e.valid)!==null&&U!==void 0?U:E),N)}}Ft.funcKeywordCode=cm;function rc(t){let{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,Xe._)`${n.parentData}[${n.parentDataProperty}]`))}function um(t,e){let{gen:r}=t;r.if((0,Xe._)`Array.isArray(${e})`,()=>{r.assign(Sr.default.vErrors,(0,Xe._)`${Sr.default.vErrors} === null ? ${e} : ${Sr.default.vErrors}.concat(${e})`).assign(Sr.default.errors,(0,Xe._)`${Sr.default.vErrors}.length`),(0,om.extendErrors)(t)},()=>t.error())}function dm({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function nc(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,Xe.stringify)(r)})}function fm(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}Ft.validSchemaType=fm;function mm({schema:t,opts:e,self:r,errSchemaPath:n},a,s){if(Array.isArray(a.keyword)?!a.keyword.includes(s):a.keyword!==s)throw new Error("ajv implementation error");let i=a.dependencies;if(i!=null&&i.some(c=>!Object.prototype.hasOwnProperty.call(t,c)))throw new Error(`parent schema must have dependencies of ${s}: ${i.join(",")}`);if(a.validateSchema&&!a.validateSchema(t[s])){let f=`keyword "${s}" value is invalid at path "${n}": `+r.errorsText(a.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(f);else throw new Error(f)}}Ft.validateKeywordUsage=mm});var ic=j(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});ur.extendSubschemaMode=ur.extendSubschemaData=ur.getSubschema=void 0;var Ht=Z(),sc=de();function pm(t,{keyword:e,schemaProp:r,schema:n,schemaPath:a,errSchemaPath:s,topSchemaRef:i}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let c=t.schema[e];return r===void 0?{schema:c,schemaPath:(0,Ht._)`${t.schemaPath}${(0,Ht.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:c[r],schemaPath:(0,Ht._)`${t.schemaPath}${(0,Ht.getProperty)(e)}${(0,Ht.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,sc.escapeFragment)(r)}`}}if(n!==void 0){if(a===void 0||s===void 0||i===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:a,topSchemaRef:i,errSchemaPath:s}}throw new Error('either "keyword" or "schema" must be passed')}ur.getSubschema=pm;function hm(t,e,{dataProp:r,dataPropType:n,data:a,dataTypes:s,propertyName:i}){if(a!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:c}=e;if(r!==void 0){let{errorPath:y,dataPathArr:p,opts:E}=e,_=c.let("data",(0,Ht._)`${e.data}${(0,Ht.getProperty)(r)}`,!0);f(_),t.errorPath=(0,Ht.str)`${y}${(0,sc.getErrorPath)(r,n,E.jsPropertySyntax)}`,t.parentDataProperty=(0,Ht._)`${r}`,t.dataPathArr=[...p,t.parentDataProperty]}if(a!==void 0){let y=a instanceof Ht.Name?a:c.let("data",a,!0);f(y),i!==void 0&&(t.propertyName=i)}s&&(t.dataTypes=s);function f(y){t.data=y,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,y]}}ur.extendSubschemaData=hm;function vm(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:a,allErrors:s}){n!==void 0&&(t.compositeRule=n),a!==void 0&&(t.createErrors=a),s!==void 0&&(t.allErrors=s),t.jtdDiscriminator=e,t.jtdMetadata=r}ur.extendSubschemaMode=vm});var Di=j((kb,oc)=>{"use strict";oc.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,a,s;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(a=n;a--!==0;)if(!t(e[a],r[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(r).length)return!1;for(a=n;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,s[a]))return!1;for(a=n;a--!==0;){var i=s[a];if(!t(e[i],r[i]))return!1}return!0}return e!==e&&r!==r}});var cc=j((Ib,lc)=>{"use strict";var dr=lc.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},a=r.post||function(){};Ka(e,n,a,t,"",t)};dr.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};dr.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};dr.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};dr.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Ka(t,e,r,n,a,s,i,c,f,y){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,a,s,i,c,f,y);for(var p in n){var E=n[p];if(Array.isArray(E)){if(p in dr.arrayKeywords)for(var _=0;_<E.length;_++)Ka(t,e,r,E[_],a+"/"+p+"/"+_,s,a,p,n,_)}else if(p in dr.propsKeywords){if(E&&typeof E=="object")for(var $ in E)Ka(t,e,r,E[$],a+"/"+p+"/"+gm($),s,a,p,n,$)}else(p in dr.keywords||t.allKeys&&!(p in dr.skipKeywords))&&Ka(t,e,r,E,a+"/"+p,s,a,p,n)}r(n,a,s,i,c,f,y)}}function gm(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var Ln=j(ot=>{"use strict";Object.defineProperty(ot,"__esModule",{value:!0});ot.getSchemaRefs=ot.resolveUrl=ot.normalizeId=ot._getFullPath=ot.getFullPath=ot.inlineRef=void 0;var ym=de(),bm=Di(),_m=cc(),Em=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function $m(t,e=!0){return typeof t=="boolean"?!0:e===!0?!Ri(t):e?uc(t)<=e:!1}ot.inlineRef=$m;var Sm=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Ri(t){for(let e in t){if(Sm.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(Ri)||typeof r=="object"&&Ri(r))return!0}return!1}function uc(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!Em.has(r)&&(typeof t[r]=="object"&&(0,ym.eachItem)(t[r],n=>e+=uc(n)),e===1/0))return 1/0}return e}function dc(t,e="",r){r!==!1&&(e=Kr(e));let n=t.parse(e);return fc(t,n)}ot.getFullPath=dc;function fc(t,e){return t.serialize(e).split("#")[0]+"#"}ot._getFullPath=fc;var wm=/#\/?$/;function Kr(t){return t?t.replace(wm,""):""}ot.normalizeId=Kr;function Cm(t,e,r){return r=Kr(r),t.resolve(e,r)}ot.resolveUrl=Cm;var Mm=/^[a-z_][-a-z0-9._]*$/i;function Tm(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,a=Kr(t[r]||e),s={"":a},i=dc(n,a,!1),c={},f=new Set;return _m(t,{allKeys:!0},(E,_,$,C)=>{if(C===void 0)return;let M=i+_,R=s[C];typeof E[r]=="string"&&(R=N.call(this,E[r])),U.call(this,E.$anchor),U.call(this,E.$dynamicAnchor),s[_]=R;function N(H){let oe=this.opts.uriResolver.resolve;if(H=Kr(R?oe(R,H):H),f.has(H))throw p(H);f.add(H);let B=this.refs[H];return typeof B=="string"&&(B=this.refs[B]),typeof B=="object"?y(E,B.schema,H):H!==Kr(M)&&(H[0]==="#"?(y(E,c[H],H),c[H]=E):this.refs[H]=M),H}function U(H){if(typeof H=="string"){if(!Mm.test(H))throw new Error(`invalid anchor "${H}"`);N.call(this,`#${H}`)}}}),c;function y(E,_,$){if(_!==void 0&&!bm(E,_))throw p($)}function p(E){return new Error(`reference "${E}" resolves to more than one schema`)}}ot.getSchemaRefs=Tm});var qn=j(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});fr.getData=fr.KeywordCxt=fr.validateFunctionCode=void 0;var yc=zl(),mc=An(),Ai=wi(),Wa=An(),Pm=Zl(),xn=ac(),Ni=ic(),V=Z(),G=Jt(),km=Ln(),Qt=de(),On=Rn();function Im(t){if(Ec(t)&&($c(t),_c(t))){Nm(t);return}bc(t,()=>(0,yc.topBoolOrEmptySchema)(t))}fr.validateFunctionCode=Im;function bc({gen:t,validateName:e,schema:r,schemaEnv:n,opts:a},s){a.code.es5?t.func(e,(0,V._)`${G.default.data}, ${G.default.valCxt}`,n.$async,()=>{t.code((0,V._)`"use strict"; ${pc(r,a)}`),Rm(t,a),t.code(s)}):t.func(e,(0,V._)`${G.default.data}, ${Dm(a)}`,n.$async,()=>t.code(pc(r,a)).code(s))}function Dm(t){return(0,V._)`{${G.default.instancePath}="", ${G.default.parentData}, ${G.default.parentDataProperty}, ${G.default.rootData}=${G.default.data}${t.dynamicRef?(0,V._)`, ${G.default.dynamicAnchors}={}`:V.nil}}={}`}function Rm(t,e){t.if(G.default.valCxt,()=>{t.var(G.default.instancePath,(0,V._)`${G.default.valCxt}.${G.default.instancePath}`),t.var(G.default.parentData,(0,V._)`${G.default.valCxt}.${G.default.parentData}`),t.var(G.default.parentDataProperty,(0,V._)`${G.default.valCxt}.${G.default.parentDataProperty}`),t.var(G.default.rootData,(0,V._)`${G.default.valCxt}.${G.default.rootData}`),e.dynamicRef&&t.var(G.default.dynamicAnchors,(0,V._)`${G.default.valCxt}.${G.default.dynamicAnchors}`)},()=>{t.var(G.default.instancePath,(0,V._)`""`),t.var(G.default.parentData,(0,V._)`undefined`),t.var(G.default.parentDataProperty,(0,V._)`undefined`),t.var(G.default.rootData,G.default.data),e.dynamicRef&&t.var(G.default.dynamicAnchors,(0,V._)`{}`)})}function Nm(t){let{schema:e,opts:r,gen:n}=t;bc(t,()=>{r.$comment&&e.$comment&&wc(t),qm(t),n.let(G.default.vErrors,null),n.let(G.default.errors,0),r.unevaluated&&Am(t),Sc(t),Hm(t)})}function Am(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,V._)`${r}.evaluated`),e.if((0,V._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,V._)`${t.evaluated}.props`,(0,V._)`undefined`)),e.if((0,V._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,V._)`${t.evaluated}.items`,(0,V._)`undefined`))}function pc(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,V._)`/*# sourceURL=${r} */`:V.nil}function Lm(t,e){if(Ec(t)&&($c(t),_c(t))){Om(t,e);return}(0,yc.boolOrEmptySchema)(t,e)}function _c({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function Ec(t){return typeof t.schema!="boolean"}function Om(t,e){let{schema:r,gen:n,opts:a}=t;a.$comment&&r.$comment&&wc(t),jm(t),Fm(t);let s=n.const("_errs",G.default.errors);Sc(t,s),n.var(e,(0,V._)`${s} === ${G.default.errors}`)}function $c(t){(0,Qt.checkUnknownRules)(t),xm(t)}function Sc(t,e){if(t.opts.jtd)return hc(t,[],!1,e);let r=(0,mc.getSchemaTypes)(t.schema),n=(0,mc.coerceAndCheckDataType)(t,r);hc(t,r,!n,e)}function xm(t){let{schema:e,errSchemaPath:r,opts:n,self:a}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,Qt.schemaHasRulesButRef)(e,a.RULES)&&a.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function qm(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,Qt.checkStrictMode)(t,"default is ignored in the schema root")}function jm(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,km.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function Fm(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function wc({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:a}){let s=r.$comment;if(a.$comment===!0)t.code((0,V._)`${G.default.self}.logger.log(${s})`);else if(typeof a.$comment=="function"){let i=(0,V.str)`${n}/$comment`,c=t.scopeValue("root",{ref:e.root});t.code((0,V._)`${G.default.self}.opts.$comment(${s}, ${i}, ${c}.schema)`)}}function Hm(t){let{gen:e,schemaEnv:r,validateName:n,ValidationError:a,opts:s}=t;r.$async?e.if((0,V._)`${G.default.errors} === 0`,()=>e.return(G.default.data),()=>e.throw((0,V._)`new ${a}(${G.default.vErrors})`)):(e.assign((0,V._)`${n}.errors`,G.default.vErrors),s.unevaluated&&Vm(t),e.return((0,V._)`${G.default.errors} === 0`))}function Vm({gen:t,evaluated:e,props:r,items:n}){r instanceof V.Name&&t.assign((0,V._)`${e}.props`,r),n instanceof V.Name&&t.assign((0,V._)`${e}.items`,n)}function hc(t,e,r,n){let{gen:a,schema:s,data:i,allErrors:c,opts:f,self:y}=t,{RULES:p}=y;if(s.$ref&&(f.ignoreKeywordsWithRef||!(0,Qt.schemaHasRulesButRef)(s,p))){a.block(()=>Cc(t,"$ref",p.all.$ref.definition));return}f.jtd||Bm(t,e),a.block(()=>{for(let _ of p.rules)E(_);E(p.post)});function E(_){!(0,Ai.shouldUseGroup)(s,_)||(_.type?(a.if((0,Wa.checkDataType)(_.type,i,f.strictNumbers)),vc(t,_),e.length===1&&e[0]===_.type&&r&&(a.else(),(0,Wa.reportTypeError)(t)),a.endIf()):vc(t,_),c||a.if((0,V._)`${G.default.errors} === ${n||0}`))}}function vc(t,e){let{gen:r,schema:n,opts:{useDefaults:a}}=t;a&&(0,Pm.assignDefaults)(t,e.type),r.block(()=>{for(let s of e.rules)(0,Ai.shouldUseRule)(n,s)&&Cc(t,s.keyword,s.definition,e.type)})}function Bm(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(Um(t,e),t.opts.allowUnionTypes||Gm(t,e),zm(t,t.dataTypes))}function Um(t,e){if(!!e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{gc(t.dataTypes,r)||Li(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),t.dataTypes=t.dataTypes.filter(r=>gc(e,r))}}function Gm(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&Li(t,"use allowUnionTypes to allow union type keyword")}function zm(t,e){let r=t.self.RULES.all;for(let n in r){let a=r[n];if(typeof a=="object"&&(0,Ai.shouldUseRule)(t.schema,a)){let{type:s}=a.definition;s.length&&!s.some(i=>Km(e,i))&&Li(t,`missing type "${s.join(",")}" for keyword "${n}"`)}}}function Km(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function gc(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function Li(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,Qt.checkStrictMode)(t,e,t.opts.strictTypes)}var Ya=class{constructor(e,r,n){if((0,xn.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,Qt.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",Mc(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,xn.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",G.default.errors))}result(e,r,n){this.failResult((0,V.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,V.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,V._)`${r} !== undefined && (${(0,V.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?On.reportExtraError:On.reportError)(this,this.def.error,r)}$dataError(){(0,On.reportError)(this,this.def.$dataError||On.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,On.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=V.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=V.nil,r=V.nil){if(!this.$data)return;let{gen:n,schemaCode:a,schemaType:s,def:i}=this;n.if((0,V.or)((0,V._)`${a} === undefined`,r)),e!==V.nil&&n.assign(e,!0),(s.length||i.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==V.nil&&n.assign(e,!1)),n.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:n,def:a,it:s}=this;return(0,V.or)(i(),c());function i(){if(n.length){if(!(r instanceof V.Name))throw new Error("ajv implementation error");let f=Array.isArray(n)?n:[n];return(0,V._)`${(0,Wa.checkDataTypes)(f,r,s.opts.strictNumbers,Wa.DataType.Wrong)}`}return V.nil}function c(){if(a.validateSchema){let f=e.scopeValue("validate$data",{ref:a.validateSchema});return(0,V._)`!${f}(${r})`}return V.nil}}subschema(e,r){let n=(0,Ni.getSubschema)(this.it,e);(0,Ni.extendSubschemaData)(n,this.it,e),(0,Ni.extendSubschemaMode)(n,e);let a=nt(ce(ce({},this.it),n),{items:void 0,props:void 0});return Lm(a,r),a}mergeEvaluated(e,r){let{it:n,gen:a}=this;!n.opts.unevaluated||(n.props!==!0&&e.props!==void 0&&(n.props=Qt.mergeEvaluated.props(a,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=Qt.mergeEvaluated.items(a,e.items,n.items,r)))}mergeValidEvaluated(e,r){let{it:n,gen:a}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return a.if(r,()=>this.mergeEvaluated(e,V.Name)),!0}};fr.KeywordCxt=Ya;function Cc(t,e,r,n){let a=new Ya(t,r,e);"code"in r?r.code(a,n):a.$data&&r.validate?(0,xn.funcKeywordCode)(a,r):"macro"in r?(0,xn.macroKeywordCode)(a,r):(r.compile||r.validate)&&(0,xn.funcKeywordCode)(a,r)}var Wm=/^\/(?:[^~]|~0|~1)*$/,Ym=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Mc(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let a,s;if(t==="")return G.default.rootData;if(t[0]==="/"){if(!Wm.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);a=t,s=G.default.rootData}else{let y=Ym.exec(t);if(!y)throw new Error(`Invalid JSON-pointer: ${t}`);let p=+y[1];if(a=y[2],a==="#"){if(p>=e)throw new Error(f("property/index",p));return n[e-p]}if(p>e)throw new Error(f("data",p));if(s=r[e-p],!a)return s}let i=s,c=a.split("/");for(let y of c)y&&(s=(0,V._)`${s}${(0,V.getProperty)((0,Qt.unescapeJsonPointer)(y))}`,i=(0,V._)`${i} && ${s}`);return i;function f(y,p){return`Cannot access ${y} ${p} levels up, current level is ${e}`}}fr.getData=Mc});var Ja=j(xi=>{"use strict";Object.defineProperty(xi,"__esModule",{value:!0});var Oi=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};xi.default=Oi});var Qa=j(Fi=>{"use strict";Object.defineProperty(Fi,"__esModule",{value:!0});var qi=Ln(),ji=class extends Error{constructor(e,r,n,a){super(a||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,qi.resolveUrl)(e,r,n),this.missingSchema=(0,qi.normalizeId)((0,qi.getFullPath)(e,this.missingRef))}};Fi.default=ji});var Za=j(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.resolveSchema=yt.getCompilingSchema=yt.resolveRef=yt.compileSchema=yt.SchemaEnv=void 0;var Pt=Z(),Jm=Ja(),wr=Jt(),kt=Ln(),Tc=de(),Qm=qn(),Wr=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,kt.normalizeId)(n==null?void 0:n[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n==null?void 0:n.$async,this.refs={}}};yt.SchemaEnv=Wr;function Vi(t){let e=Pc.call(this,t);if(e)return e;let r=(0,kt.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:a}=this.opts.code,{ownProperties:s}=this.opts,i=new Pt.CodeGen(this.scope,{es5:n,lines:a,ownProperties:s}),c;t.$async&&(c=i.scopeValue("Error",{ref:Jm.default,code:(0,Pt._)`require("ajv/dist/runtime/validation_error").default`}));let f=i.scopeName("validate");t.validateName=f;let y={gen:i,allErrors:this.opts.allErrors,data:wr.default.data,parentData:wr.default.parentData,parentDataProperty:wr.default.parentDataProperty,dataNames:[wr.default.data],dataPathArr:[Pt.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,Pt.stringify)(t.schema)}:{ref:t.schema}),validateName:f,ValidationError:c,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:Pt.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,Pt._)`""`,opts:this.opts,self:this},p;try{this._compilations.add(t),(0,Qm.validateFunctionCode)(y),i.optimize(this.opts.code.optimize);let E=i.toString();p=`${i.scopeRefs(wr.default.scope)}return ${E}`,this.opts.code.process&&(p=this.opts.code.process(p,t));let $=new Function(`${wr.default.self}`,`${wr.default.scope}`,p)(this,this.scope.get());if(this.scope.value(f,{ref:$}),$.errors=null,$.schema=t.schema,$.schemaEnv=t,t.$async&&($.$async=!0),this.opts.code.source===!0&&($.source={validateName:f,validateCode:E,scopeValues:i._values}),this.opts.unevaluated){let{props:C,items:M}=y;$.evaluated={props:C instanceof Pt.Name?void 0:C,items:M instanceof Pt.Name?void 0:M,dynamicProps:C instanceof Pt.Name,dynamicItems:M instanceof Pt.Name},$.source&&($.source.evaluated=(0,Pt.stringify)($.evaluated))}return t.validate=$,t}catch(E){throw delete t.validate,delete t.validateName,p&&this.logger.error("Error compiling schema, function code:",p),E}finally{this._compilations.delete(t)}}yt.compileSchema=Vi;function Xm(t,e,r){var n;r=(0,kt.resolveUrl)(this.opts.uriResolver,e,r);let a=t.refs[r];if(a)return a;let s=tp.call(this,t,r);if(s===void 0){let i=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:c}=this.opts;i&&(s=new Wr({schema:i,schemaId:c,root:t,baseId:e}))}if(s!==void 0)return t.refs[r]=Zm.call(this,s)}yt.resolveRef=Xm;function Zm(t){return(0,kt.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:Vi.call(this,t)}function Pc(t){for(let e of this._compilations)if(ep(e,t))return e}yt.getCompilingSchema=Pc;function ep(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function tp(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||Xa.call(this,t,e)}function Xa(t,e){let r=this.opts.uriResolver.parse(e),n=(0,kt._getFullPath)(this.opts.uriResolver,r),a=(0,kt.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===a)return Hi.call(this,r,t);let s=(0,kt.normalizeId)(n),i=this.refs[s]||this.schemas[s];if(typeof i=="string"){let c=Xa.call(this,t,i);return typeof(c==null?void 0:c.schema)!="object"?void 0:Hi.call(this,r,c)}if(typeof(i==null?void 0:i.schema)=="object"){if(i.validate||Vi.call(this,i),s===(0,kt.normalizeId)(e)){let{schema:c}=i,{schemaId:f}=this.opts,y=c[f];return y&&(a=(0,kt.resolveUrl)(this.opts.uriResolver,a,y)),new Wr({schema:c,schemaId:f,root:t,baseId:a})}return Hi.call(this,r,i)}}yt.resolveSchema=Xa;var rp=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Hi(t,{baseId:e,schema:r,root:n}){var a;if(((a=t.fragment)===null||a===void 0?void 0:a[0])!=="/")return;for(let c of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let f=r[(0,Tc.unescapeFragment)(c)];if(f===void 0)return;r=f;let y=typeof r=="object"&&r[this.opts.schemaId];!rp.has(c)&&y&&(e=(0,kt.resolveUrl)(this.opts.uriResolver,e,y))}let s;if(typeof r!="boolean"&&r.$ref&&!(0,Tc.schemaHasRulesButRef)(r,this.RULES)){let c=(0,kt.resolveUrl)(this.opts.uriResolver,e,r.$ref);s=Xa.call(this,n,c)}let{schemaId:i}=this.opts;if(s=s||new Wr({schema:r,schemaId:i,root:n,baseId:e}),s.schema!==s.root.schema)return s}});var kc=j((xb,np)=>{np.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var Dc=j((es,Ic)=>{(function(t,e){typeof es=="object"&&typeof Ic<"u"?e(es):typeof define=="function"&&define.amd?define(["exports"],e):e(t.URI=t.URI||{})})(es,function(t){"use strict";function e(){for(var m=arguments.length,u=Array(m),h=0;h<m;h++)u[h]=arguments[h];if(u.length>1){u[0]=u[0].slice(0,-1);for(var S=u.length-1,w=1;w<S;++w)u[w]=u[w].slice(1,-1);return u[S]=u[S].slice(1),u.join("")}else return u[0]}function r(m){return"(?:"+m+")"}function n(m){return m===void 0?"undefined":m===null?"null":Object.prototype.toString.call(m).split(" ").pop().split("]").shift().toLowerCase()}function a(m){return m.toUpperCase()}function s(m){return m!=null?m instanceof Array?m:typeof m.length!="number"||m.split||m.setInterval||m.call?[m]:Array.prototype.slice.call(m):[]}function i(m,u){var h=m;if(u)for(var S in u)h[S]=u[S];return h}function c(m){var u="[A-Za-z]",h="[\\x0D]",S="[0-9]",w="[\\x22]",x=e(S,"[A-Fa-f]"),K="[\\x0A]",re="[\\x20]",fe=r(r("%[EFef]"+x+"%"+x+x+"%"+x+x)+"|"+r("%[89A-Fa-f]"+x+"%"+x+x)+"|"+r("%"+x+x)),Me="[\\:\\/\\?\\#\\[\\]\\@]",ee="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",Ee=e(Me,ee),Te=m?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",_e=m?"[\\uE000-\\uF8FF]":"[]",se=e(u,S,"[\\-\\.\\_\\~]",Te),$e=r(u+e(u,S,"[\\+\\-\\.]")+"*"),pe=r(r(fe+"|"+e(se,ee,"[\\:]"))+"*"),Ut=r(r("25[0-5]")+"|"+r("2[0-4]"+S)+"|"+r("1"+S+S)+"|"+r("[1-9]"+S)+"|"+S),He=r(r("25[0-5]")+"|"+r("2[0-4]"+S)+"|"+r("1"+S+S)+"|"+r("0?[1-9]"+S)+"|0?0?"+S),Ne=r(He+"\\."+He+"\\."+He+"\\."+He),he=r(x+"{1,4}"),De=r(r(he+"\\:"+he)+"|"+Ne),rt=r(r(he+"\\:")+"{6}"+De),ze=r("\\:\\:"+r(he+"\\:")+"{5}"+De),St=r(r(he)+"?\\:\\:"+r(he+"\\:")+"{4}"+De),wt=r(r(r(he+"\\:")+"{0,1}"+he)+"?\\:\\:"+r(he+"\\:")+"{3}"+De),pr=r(r(r(he+"\\:")+"{0,2}"+he)+"?\\:\\:"+r(he+"\\:")+"{2}"+De),ar=r(r(r(he+"\\:")+"{0,3}"+he)+"?\\:\\:"+he+"\\:"+De),Rr=r(r(r(he+"\\:")+"{0,4}"+he)+"?\\:\\:"+De),sr=r(r(r(he+"\\:")+"{0,5}"+he)+"?\\:\\:"+he),o=r(r(r(he+"\\:")+"{0,6}"+he)+"?\\:\\:"),d=r([rt,ze,St,wt,pr,ar,Rr,sr,o].join("|")),l=r(r(se+"|"+fe)+"+"),g=r(d+"\\%25"+l),b=r(d+r("\\%25|\\%(?!"+x+"{2})")+l),v=r("[vV]"+x+"+\\."+e(se,ee,"[\\:]")+"+"),T=r("\\["+r(b+"|"+d+"|"+v)+"\\]"),k=r(r(fe+"|"+e(se,ee))+"*"),I=r(T+"|"+Ne+"(?!"+k+")|"+k),D=r(S+"*"),A=r(r(pe+"@")+"?"+I+r("\\:"+D)+"?"),F=r(fe+"|"+e(se,ee,"[\\:\\@]")),Y=r(F+"*"),le=r(F+"+"),me=r(r(fe+"|"+e(se,ee,"[\\@]"))+"+"),ve=r(r("\\/"+Y)+"*"),ge=r("\\/"+r(le+ve)+"?"),Ve=r(me+ve),Nt=r(le+ve),At="(?!"+F+")",Oo=r(ve+"|"+ge+"|"+Ve+"|"+Nt+"|"+At),Lt=r(r(F+"|"+e("[\\/\\?]",_e))+"*"),Nr=r(r(F+"|[\\/\\?]")+"*"),ha=r(r("\\/\\/"+A+ve)+"|"+ge+"|"+Nt+"|"+At),Ps=r($e+"\\:"+ha+r("\\?"+Lt)+"?"+r("\\#"+Nr)+"?"),va=r(r("\\/\\/"+A+ve)+"|"+ge+"|"+Ve+"|"+At),ed=r(va+r("\\?"+Lt)+"?"+r("\\#"+Nr)+"?"),Jv=r(Ps+"|"+ed),Qv=r($e+"\\:"+ha+r("\\?"+Lt)+"?"),Xv="^("+$e+")\\:"+r(r("\\/\\/("+r("("+pe+")@")+"?("+I+")"+r("\\:("+D+")")+"?)")+"?("+ve+"|"+ge+"|"+Nt+"|"+At+")")+r("\\?("+Lt+")")+"?"+r("\\#("+Nr+")")+"?$",Zv="^(){0}"+r(r("\\/\\/("+r("("+pe+")@")+"?("+I+")"+r("\\:("+D+")")+"?)")+"?("+ve+"|"+ge+"|"+Ve+"|"+At+")")+r("\\?("+Lt+")")+"?"+r("\\#("+Nr+")")+"?$",eg="^("+$e+")\\:"+r(r("\\/\\/("+r("("+pe+")@")+"?("+I+")"+r("\\:("+D+")")+"?)")+"?("+ve+"|"+ge+"|"+Nt+"|"+At+")")+r("\\?("+Lt+")")+"?$",tg="^"+r("\\#("+Nr+")")+"?$",rg="^"+r("("+pe+")@")+"?("+I+")"+r("\\:("+D+")")+"?$";return{NOT_SCHEME:new RegExp(e("[^]",u,S,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(e("[^\\%\\:]",se,ee),"g"),NOT_HOST:new RegExp(e("[^\\%\\[\\]\\:]",se,ee),"g"),NOT_PATH:new RegExp(e("[^\\%\\/\\:\\@]",se,ee),"g"),NOT_PATH_NOSCHEME:new RegExp(e("[^\\%\\/\\@]",se,ee),"g"),NOT_QUERY:new RegExp(e("[^\\%]",se,ee,"[\\:\\@\\/\\?]",_e),"g"),NOT_FRAGMENT:new RegExp(e("[^\\%]",se,ee,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(e("[^]",se,ee),"g"),UNRESERVED:new RegExp(se,"g"),OTHER_CHARS:new RegExp(e("[^\\%]",se,Ee),"g"),PCT_ENCODED:new RegExp(fe,"g"),IPV4ADDRESS:new RegExp("^("+Ne+")$"),IPV6ADDRESS:new RegExp("^\\[?("+d+")"+r(r("\\%25|\\%(?!"+x+"{2})")+"("+l+")")+"?\\]?$")}}var f=c(!1),y=c(!0),p=function(){function m(u,h){var S=[],w=!0,x=!1,K=void 0;try{for(var re=u[Symbol.iterator](),fe;!(w=(fe=re.next()).done)&&(S.push(fe.value),!(h&&S.length===h));w=!0);}catch(Me){x=!0,K=Me}finally{try{!w&&re.return&&re.return()}finally{if(x)throw K}}return S}return function(u,h){if(Array.isArray(u))return u;if(Symbol.iterator in Object(u))return m(u,h);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),E=function(m){if(Array.isArray(m)){for(var u=0,h=Array(m.length);u<m.length;u++)h[u]=m[u];return h}else return Array.from(m)},_=2147483647,$=36,C=1,M=26,R=38,N=700,U=72,H=128,oe="-",B=/^xn--/,L=/[^\0-\x7E]/,J=/[\x2E\u3002\uFF0E\uFF61]/g,z={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},te=$-C,ae=Math.floor,ke=String.fromCharCode;function we(m){throw new RangeError(z[m])}function Ae(m,u){for(var h=[],S=m.length;S--;)h[S]=u(m[S]);return h}function Ze(m,u){var h=m.split("@"),S="";h.length>1&&(S=h[0]+"@",m=h[1]),m=m.replace(J,".");var w=m.split("."),x=Ae(w,u).join(".");return S+x}function Xt(m){for(var u=[],h=0,S=m.length;h<S;){var w=m.charCodeAt(h++);if(w>=55296&&w<=56319&&h<S){var x=m.charCodeAt(h++);(x&64512)==56320?u.push(((w&1023)<<10)+(x&1023)+65536):(u.push(w),h--)}else u.push(w)}return u}var Pr=function(u){return String.fromCodePoint.apply(String,E(u))},tn=function(u){return u-48<10?u-22:u-65<26?u-65:u-97<26?u-97:$},Bt=function(u,h){return u+22+75*(u<26)-((h!=0)<<5)},rn=function(u,h,S){var w=0;for(u=S?ae(u/N):u>>1,u+=ae(u/h);u>te*M>>1;w+=$)u=ae(u/te);return ae(w+(te+1)*u/(u+R))},Xn=function(u){var h=[],S=u.length,w=0,x=H,K=U,re=u.lastIndexOf(oe);re<0&&(re=0);for(var fe=0;fe<re;++fe)u.charCodeAt(fe)>=128&&we("not-basic"),h.push(u.charCodeAt(fe));for(var Me=re>0?re+1:0;Me<S;){for(var ee=w,Ee=1,Te=$;;Te+=$){Me>=S&&we("invalid-input");var _e=tn(u.charCodeAt(Me++));(_e>=$||_e>ae((_-w)/Ee))&&we("overflow"),w+=_e*Ee;var se=Te<=K?C:Te>=K+M?M:Te-K;if(_e<se)break;var $e=$-se;Ee>ae(_/$e)&&we("overflow"),Ee*=$e}var pe=h.length+1;K=rn(w-ee,pe,ee==0),ae(w/pe)>_-x&&we("overflow"),x+=ae(w/pe),w%=pe,h.splice(w++,0,x)}return String.fromCodePoint.apply(String,h)},Zn=function(u){var h=[];u=Xt(u);var S=u.length,w=H,x=0,K=U,re=!0,fe=!1,Me=void 0;try{for(var ee=u[Symbol.iterator](),Ee;!(re=(Ee=ee.next()).done);re=!0){var Te=Ee.value;Te<128&&h.push(ke(Te))}}catch(b){fe=!0,Me=b}finally{try{!re&&ee.return&&ee.return()}finally{if(fe)throw Me}}var _e=h.length,se=_e;for(_e&&h.push(oe);se<S;){var $e=_,pe=!0,Ut=!1,He=void 0;try{for(var Ne=u[Symbol.iterator](),he;!(pe=(he=Ne.next()).done);pe=!0){var De=he.value;De>=w&&De<$e&&($e=De)}}catch(b){Ut=!0,He=b}finally{try{!pe&&Ne.return&&Ne.return()}finally{if(Ut)throw He}}var rt=se+1;$e-w>ae((_-x)/rt)&&we("overflow"),x+=($e-w)*rt,w=$e;var ze=!0,St=!1,wt=void 0;try{for(var pr=u[Symbol.iterator](),ar;!(ze=(ar=pr.next()).done);ze=!0){var Rr=ar.value;if(Rr<w&&++x>_&&we("overflow"),Rr==w){for(var sr=x,o=$;;o+=$){var d=o<=K?C:o>=K+M?M:o-K;if(sr<d)break;var l=sr-d,g=$-d;h.push(ke(Bt(d+l%g,0))),sr=ae(l/g)}h.push(ke(Bt(sr,0))),K=rn(x,rt,se==_e),x=0,++se}}}catch(b){St=!0,wt=b}finally{try{!ze&&pr.return&&pr.return()}finally{if(St)throw wt}}++x,++w}return h.join("")},_t=function(u){return Ze(u,function(h){return B.test(h)?Xn(h.slice(4).toLowerCase()):h})},ea=function(u){return Ze(u,function(h){return L.test(h)?"xn--"+Zn(h):h})},Zt={version:"2.1.0",ucs2:{decode:Xt,encode:Pr},decode:Xn,encode:Zn,toASCII:ea,toUnicode:_t},et={};function ct(m){var u=m.charCodeAt(0),h=void 0;return u<16?h="%0"+u.toString(16).toUpperCase():u<128?h="%"+u.toString(16).toUpperCase():u<2048?h="%"+(u>>6|192).toString(16).toUpperCase()+"%"+(u&63|128).toString(16).toUpperCase():h="%"+(u>>12|224).toString(16).toUpperCase()+"%"+(u>>6&63|128).toString(16).toUpperCase()+"%"+(u&63|128).toString(16).toUpperCase(),h}function er(m){for(var u="",h=0,S=m.length;h<S;){var w=parseInt(m.substr(h+1,2),16);if(w<128)u+=String.fromCharCode(w),h+=3;else if(w>=194&&w<224){if(S-h>=6){var x=parseInt(m.substr(h+4,2),16);u+=String.fromCharCode((w&31)<<6|x&63)}else u+=m.substr(h,6);h+=6}else if(w>=224){if(S-h>=9){var K=parseInt(m.substr(h+4,2),16),re=parseInt(m.substr(h+7,2),16);u+=String.fromCharCode((w&15)<<12|(K&63)<<6|re&63)}else u+=m.substr(h,9);h+=9}else u+=m.substr(h,3),h+=3}return u}function nn(m,u){function h(S){var w=er(S);return w.match(u.UNRESERVED)?w:S}return m.scheme&&(m.scheme=String(m.scheme).replace(u.PCT_ENCODED,h).toLowerCase().replace(u.NOT_SCHEME,"")),m.userinfo!==void 0&&(m.userinfo=String(m.userinfo).replace(u.PCT_ENCODED,h).replace(u.NOT_USERINFO,ct).replace(u.PCT_ENCODED,a)),m.host!==void 0&&(m.host=String(m.host).replace(u.PCT_ENCODED,h).toLowerCase().replace(u.NOT_HOST,ct).replace(u.PCT_ENCODED,a)),m.path!==void 0&&(m.path=String(m.path).replace(u.PCT_ENCODED,h).replace(m.scheme?u.NOT_PATH:u.NOT_PATH_NOSCHEME,ct).replace(u.PCT_ENCODED,a)),m.query!==void 0&&(m.query=String(m.query).replace(u.PCT_ENCODED,h).replace(u.NOT_QUERY,ct).replace(u.PCT_ENCODED,a)),m.fragment!==void 0&&(m.fragment=String(m.fragment).replace(u.PCT_ENCODED,h).replace(u.NOT_FRAGMENT,ct).replace(u.PCT_ENCODED,a)),m}function an(m){return m.replace(/^0*(.*)/,"$1")||"0"}function sn(m,u){var h=m.match(u.IPV4ADDRESS)||[],S=p(h,2),w=S[1];return w?w.split(".").map(an).join("."):m}function ta(m,u){var h=m.match(u.IPV6ADDRESS)||[],S=p(h,3),w=S[1],x=S[2];if(w){for(var K=w.toLowerCase().split("::").reverse(),re=p(K,2),fe=re[0],Me=re[1],ee=Me?Me.split(":").map(an):[],Ee=fe.split(":").map(an),Te=u.IPV4ADDRESS.test(Ee[Ee.length-1]),_e=Te?7:8,se=Ee.length-_e,$e=Array(_e),pe=0;pe<_e;++pe)$e[pe]=ee[pe]||Ee[se+pe]||"";Te&&($e[_e-1]=sn($e[_e-1],u));var Ut=$e.reduce(function(rt,ze,St){if(!ze||ze==="0"){var wt=rt[rt.length-1];wt&&wt.index+wt.length===St?wt.length++:rt.push({index:St,length:1})}return rt},[]),He=Ut.sort(function(rt,ze){return ze.length-rt.length})[0],Ne=void 0;if(He&&He.length>1){var he=$e.slice(0,He.index),De=$e.slice(He.index+He.length);Ne=he.join(":")+"::"+De.join(":")}else Ne=$e.join(":");return x&&(Ne+="%"+x),Ne}else return m}var bs=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,_s="".match(/(){0}/)[1]===void 0;function Et(m){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h={},S=u.iri!==!1?y:f;u.reference==="suffix"&&(m=(u.scheme?u.scheme+":":"")+"//"+m);var w=m.match(bs);if(w){_s?(h.scheme=w[1],h.userinfo=w[3],h.host=w[4],h.port=parseInt(w[5],10),h.path=w[6]||"",h.query=w[7],h.fragment=w[8],isNaN(h.port)&&(h.port=w[5])):(h.scheme=w[1]||void 0,h.userinfo=m.indexOf("@")!==-1?w[3]:void 0,h.host=m.indexOf("//")!==-1?w[4]:void 0,h.port=parseInt(w[5],10),h.path=w[6]||"",h.query=m.indexOf("?")!==-1?w[7]:void 0,h.fragment=m.indexOf("#")!==-1?w[8]:void 0,isNaN(h.port)&&(h.port=m.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?w[4]:void 0)),h.host&&(h.host=ta(sn(h.host,S),S)),h.scheme===void 0&&h.userinfo===void 0&&h.host===void 0&&h.port===void 0&&!h.path&&h.query===void 0?h.reference="same-document":h.scheme===void 0?h.reference="relative":h.fragment===void 0?h.reference="absolute":h.reference="uri",u.reference&&u.reference!=="suffix"&&u.reference!==h.reference&&(h.error=h.error||"URI is not a "+u.reference+" reference.");var x=et[(u.scheme||h.scheme||"").toLowerCase()];if(!u.unicodeSupport&&(!x||!x.unicodeSupport)){if(h.host&&(u.domainHost||x&&x.domainHost))try{h.host=Zt.toASCII(h.host.replace(S.PCT_ENCODED,er).toLowerCase())}catch(K){h.error=h.error||"Host's domain name can not be converted to ASCII via punycode: "+K}nn(h,f)}else nn(h,S);x&&x.parse&&x.parse(h,u)}else h.error=h.error||"URI can not be parsed.";return h}function Es(m,u){var h=u.iri!==!1?y:f,S=[];return m.userinfo!==void 0&&(S.push(m.userinfo),S.push("@")),m.host!==void 0&&S.push(ta(sn(String(m.host),h),h).replace(h.IPV6ADDRESS,function(w,x,K){return"["+x+(K?"%25"+K:"")+"]"})),(typeof m.port=="number"||typeof m.port=="string")&&(S.push(":"),S.push(String(m.port))),S.length?S.join(""):void 0}var $t=/^\.\.?\//,ra=/^\/\.(\/|$)/,on=/^\/\.\.(\/|$)/,kr=/^\/?(?:.|\n)*?(?=\/|$)/;function Dt(m){for(var u=[];m.length;)if(m.match($t))m=m.replace($t,"");else if(m.match(ra))m=m.replace(ra,"/");else if(m.match(on))m=m.replace(on,"/"),u.pop();else if(m==="."||m==="..")m="";else{var h=m.match(kr);if(h){var S=h[0];m=m.slice(S.length),u.push(S)}else throw new Error("Unexpected dot segment condition")}return u.join("")}function tt(m){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=u.iri?y:f,S=[],w=et[(u.scheme||m.scheme||"").toLowerCase()];if(w&&w.serialize&&w.serialize(m,u),m.host&&!h.IPV6ADDRESS.test(m.host)){if(u.domainHost||w&&w.domainHost)try{m.host=u.iri?Zt.toUnicode(m.host):Zt.toASCII(m.host.replace(h.PCT_ENCODED,er).toLowerCase())}catch(re){m.error=m.error||"Host's domain name can not be converted to "+(u.iri?"Unicode":"ASCII")+" via punycode: "+re}}nn(m,h),u.reference!=="suffix"&&m.scheme&&(S.push(m.scheme),S.push(":"));var x=Es(m,u);if(x!==void 0&&(u.reference!=="suffix"&&S.push("//"),S.push(x),m.path&&m.path.charAt(0)!=="/"&&S.push("/")),m.path!==void 0){var K=m.path;!u.absolutePath&&(!w||!w.absolutePath)&&(K=Dt(K)),x===void 0&&(K=K.replace(/^\/\//,"/%2F")),S.push(K)}return m.query!==void 0&&(S.push("?"),S.push(m.query)),m.fragment!==void 0&&(S.push("#"),S.push(m.fragment)),S.join("")}function Ir(m,u){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},S=arguments[3],w={};return S||(m=Et(tt(m,h),h),u=Et(tt(u,h),h)),h=h||{},!h.tolerant&&u.scheme?(w.scheme=u.scheme,w.userinfo=u.userinfo,w.host=u.host,w.port=u.port,w.path=Dt(u.path||""),w.query=u.query):(u.userinfo!==void 0||u.host!==void 0||u.port!==void 0?(w.userinfo=u.userinfo,w.host=u.host,w.port=u.port,w.path=Dt(u.path||""),w.query=u.query):(u.path?(u.path.charAt(0)==="/"?w.path=Dt(u.path):((m.userinfo!==void 0||m.host!==void 0||m.port!==void 0)&&!m.path?w.path="/"+u.path:m.path?w.path=m.path.slice(0,m.path.lastIndexOf("/")+1)+u.path:w.path=u.path,w.path=Dt(w.path)),w.query=u.query):(w.path=m.path,u.query!==void 0?w.query=u.query:w.query=m.query),w.userinfo=m.userinfo,w.host=m.host,w.port=m.port),w.scheme=m.scheme),w.fragment=u.fragment,w}function na(m,u,h){var S=i({scheme:"null"},h);return tt(Ir(Et(m,S),Et(u,S),S,!0),S)}function aa(m,u){return typeof m=="string"?m=tt(Et(m,u),u):n(m)==="object"&&(m=Et(tt(m,u),u)),m}function sa(m,u,h){return typeof m=="string"?m=tt(Et(m,h),h):n(m)==="object"&&(m=tt(m,h)),typeof u=="string"?u=tt(Et(u,h),h):n(u)==="object"&&(u=tt(u,h)),m===u}function ia(m,u){return m&&m.toString().replace(!u||!u.iri?f.ESCAPE:y.ESCAPE,ct)}function ut(m,u){return m&&m.toString().replace(!u||!u.iri?f.PCT_ENCODED:y.PCT_ENCODED,er)}var tr={scheme:"http",domainHost:!0,parse:function(u,h){return u.host||(u.error=u.error||"HTTP URIs must have a host."),u},serialize:function(u,h){var S=String(u.scheme).toLowerCase()==="https";return(u.port===(S?443:80)||u.port==="")&&(u.port=void 0),u.path||(u.path="/"),u}},ln={scheme:"https",domainHost:tr.domainHost,parse:tr.parse,serialize:tr.serialize};function cn(m){return typeof m.secure=="boolean"?m.secure:String(m.scheme).toLowerCase()==="wss"}var rr={scheme:"ws",domainHost:!0,parse:function(u,h){var S=u;return S.secure=cn(S),S.resourceName=(S.path||"/")+(S.query?"?"+S.query:""),S.path=void 0,S.query=void 0,S},serialize:function(u,h){if((u.port===(cn(u)?443:80)||u.port==="")&&(u.port=void 0),typeof u.secure=="boolean"&&(u.scheme=u.secure?"wss":"ws",u.secure=void 0),u.resourceName){var S=u.resourceName.split("?"),w=p(S,2),x=w[0],K=w[1];u.path=x&&x!=="/"?x:void 0,u.query=K,u.resourceName=void 0}return u.fragment=void 0,u}},un={scheme:"wss",domainHost:rr.domainHost,parse:rr.parse,serialize:rr.serialize},oa={},la=!0,Dr="[A-Za-z0-9\\-\\.\\_\\~"+(la?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",dt="[0-9A-Fa-f]",$s=r(r("%[EFef]"+dt+"%"+dt+dt+"%"+dt+dt)+"|"+r("%[89A-Fa-f]"+dt+"%"+dt+dt)+"|"+r("%"+dt+dt)),dn="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",ca="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Ss=e(ca,'[\\"\\\\]'),Rt="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",ws=new RegExp(Dr,"g"),nr=new RegExp($s,"g"),ua=new RegExp(e("[^]",dn,"[\\.]",'[\\"]',Ss),"g"),da=new RegExp(e("[^]",Dr,Rt),"g"),Cs=da;function fn(m){var u=er(m);return u.match(ws)?u:m}var fa={scheme:"mailto",parse:function(u,h){var S=u,w=S.to=S.path?S.path.split(","):[];if(S.path=void 0,S.query){for(var x=!1,K={},re=S.query.split("&"),fe=0,Me=re.length;fe<Me;++fe){var ee=re[fe].split("=");switch(ee[0]){case"to":for(var Ee=ee[1].split(","),Te=0,_e=Ee.length;Te<_e;++Te)w.push(Ee[Te]);break;case"subject":S.subject=ut(ee[1],h);break;case"body":S.body=ut(ee[1],h);break;default:x=!0,K[ut(ee[0],h)]=ut(ee[1],h);break}}x&&(S.headers=K)}S.query=void 0;for(var se=0,$e=w.length;se<$e;++se){var pe=w[se].split("@");if(pe[0]=ut(pe[0]),h.unicodeSupport)pe[1]=ut(pe[1],h).toLowerCase();else try{pe[1]=Zt.toASCII(ut(pe[1],h).toLowerCase())}catch(Ut){S.error=S.error||"Email address's domain name can not be converted to ASCII via punycode: "+Ut}w[se]=pe.join("@")}return S},serialize:function(u,h){var S=u,w=s(u.to);if(w){for(var x=0,K=w.length;x<K;++x){var re=String(w[x]),fe=re.lastIndexOf("@"),Me=re.slice(0,fe).replace(nr,fn).replace(nr,a).replace(ua,ct),ee=re.slice(fe+1);try{ee=h.iri?Zt.toUnicode(ee):Zt.toASCII(ut(ee,h).toLowerCase())}catch(se){S.error=S.error||"Email address's domain name can not be converted to "+(h.iri?"Unicode":"ASCII")+" via punycode: "+se}w[x]=Me+"@"+ee}S.path=w.join(",")}var Ee=u.headers=u.headers||{};u.subject&&(Ee.subject=u.subject),u.body&&(Ee.body=u.body);var Te=[];for(var _e in Ee)Ee[_e]!==oa[_e]&&Te.push(_e.replace(nr,fn).replace(nr,a).replace(da,ct)+"="+Ee[_e].replace(nr,fn).replace(nr,a).replace(Cs,ct));return Te.length&&(S.query=Te.join("&")),S}},Ms=/^([^\:]+)\:(.*)/,ma={scheme:"urn",parse:function(u,h){var S=u.path&&u.path.match(Ms),w=u;if(S){var x=h.scheme||w.scheme||"urn",K=S[1].toLowerCase(),re=S[2],fe=x+":"+(h.nid||K),Me=et[fe];w.nid=K,w.nss=re,w.path=void 0,Me&&(w=Me.parse(w,h))}else w.error=w.error||"URN can not be parsed.";return w},serialize:function(u,h){var S=h.scheme||u.scheme||"urn",w=u.nid,x=S+":"+(h.nid||w),K=et[x];K&&(u=K.serialize(u,h));var re=u,fe=u.nss;return re.path=(w||h.nid)+":"+fe,re}},Ts=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,pa={scheme:"urn:uuid",parse:function(u,h){var S=u;return S.uuid=S.nss,S.nss=void 0,!h.tolerant&&(!S.uuid||!S.uuid.match(Ts))&&(S.error=S.error||"UUID is not valid."),S},serialize:function(u,h){var S=u;return S.nss=(u.uuid||"").toLowerCase(),S}};et[tr.scheme]=tr,et[ln.scheme]=ln,et[rr.scheme]=rr,et[un.scheme]=un,et[fa.scheme]=fa,et[ma.scheme]=ma,et[pa.scheme]=pa,t.SCHEMES=et,t.pctEncChar=ct,t.pctDecChars=er,t.parse=Et,t.removeDotSegments=Dt,t.serialize=tt,t.resolveComponents=Ir,t.resolve=na,t.normalize=aa,t.equal=sa,t.escapeComponent=ia,t.unescapeComponent=ut,Object.defineProperty(t,"__esModule",{value:!0})})});var Nc=j(Bi=>{"use strict";Object.defineProperty(Bi,"__esModule",{value:!0});var Rc=Dc();Rc.code='require("ajv/dist/runtime/uri").default';Bi.default=Rc});var Hc=j(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.CodeGen=je.Name=je.nil=je.stringify=je.str=je._=je.KeywordCxt=void 0;var ap=qn();Object.defineProperty(je,"KeywordCxt",{enumerable:!0,get:function(){return ap.KeywordCxt}});var Yr=Z();Object.defineProperty(je,"_",{enumerable:!0,get:function(){return Yr._}});Object.defineProperty(je,"str",{enumerable:!0,get:function(){return Yr.str}});Object.defineProperty(je,"stringify",{enumerable:!0,get:function(){return Yr.stringify}});Object.defineProperty(je,"nil",{enumerable:!0,get:function(){return Yr.nil}});Object.defineProperty(je,"Name",{enumerable:!0,get:function(){return Yr.Name}});Object.defineProperty(je,"CodeGen",{enumerable:!0,get:function(){return Yr.CodeGen}});var sp=Ja(),qc=Qa(),ip=Si(),jn=Za(),op=Z(),Fn=Ln(),ts=An(),Gi=de(),Ac=kc(),lp=Nc(),jc=(t,e)=>new RegExp(t,e);jc.code="new RegExp";var cp=["removeAdditional","useDefaults","coerceTypes"],up=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),dp={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},fp={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},Lc=200;function mp(t){var e,r,n,a,s,i,c,f,y,p,E,_,$,C,M,R,N,U,H,oe,B,L,J,z,te;let ae=t.strict,ke=(e=t.code)===null||e===void 0?void 0:e.optimize,we=ke===!0||ke===void 0?1:ke||0,Ae=(n=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:jc,Ze=(a=t.uriResolver)!==null&&a!==void 0?a:lp.default;return{strictSchema:(i=(s=t.strictSchema)!==null&&s!==void 0?s:ae)!==null&&i!==void 0?i:!0,strictNumbers:(f=(c=t.strictNumbers)!==null&&c!==void 0?c:ae)!==null&&f!==void 0?f:!0,strictTypes:(p=(y=t.strictTypes)!==null&&y!==void 0?y:ae)!==null&&p!==void 0?p:"log",strictTuples:(_=(E=t.strictTuples)!==null&&E!==void 0?E:ae)!==null&&_!==void 0?_:"log",strictRequired:(C=($=t.strictRequired)!==null&&$!==void 0?$:ae)!==null&&C!==void 0?C:!1,code:t.code?nt(ce({},t.code),{optimize:we,regExp:Ae}):{optimize:we,regExp:Ae},loopRequired:(M=t.loopRequired)!==null&&M!==void 0?M:Lc,loopEnum:(R=t.loopEnum)!==null&&R!==void 0?R:Lc,meta:(N=t.meta)!==null&&N!==void 0?N:!0,messages:(U=t.messages)!==null&&U!==void 0?U:!0,inlineRefs:(H=t.inlineRefs)!==null&&H!==void 0?H:!0,schemaId:(oe=t.schemaId)!==null&&oe!==void 0?oe:"$id",addUsedSchema:(B=t.addUsedSchema)!==null&&B!==void 0?B:!0,validateSchema:(L=t.validateSchema)!==null&&L!==void 0?L:!0,validateFormats:(J=t.validateFormats)!==null&&J!==void 0?J:!0,unicodeRegExp:(z=t.unicodeRegExp)!==null&&z!==void 0?z:!0,int32range:(te=t.int32range)!==null&&te!==void 0?te:!0,uriResolver:Ze}}var Hn=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts=ce(ce({},e),mp(e));let{es5:r,lines:n}=this.opts.code;this.scope=new op.ValueScope({scope:{},prefixes:up,es5:r,lines:n}),this.logger=bp(e.logger);let a=e.validateFormats;e.validateFormats=!1,this.RULES=(0,ip.getRules)(),Oc.call(this,dp,e,"NOT SUPPORTED"),Oc.call(this,fp,e,"DEPRECATED","warn"),this._metaOpts=gp.call(this),e.formats&&hp.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&vp.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),pp.call(this),e.validateFormats=a}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:n}=this.opts,a=Ac;n==="id"&&(a=ce({},Ac),a.id=a.$id,delete a.$id),r&&e&&this.addMetaSchema(a,a[n],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let n;if(typeof e=="string"){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);let a=n(r);return"$async"in n||(this.errors=n.errors),a}compile(e,r){let n=this._addSchema(e,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return a.call(this,e,r);async function a(p,E){await s.call(this,p.$schema);let _=this._addSchema(p,E);return _.validate||i.call(this,_)}async function s(p){p&&!this.getSchema(p)&&await a.call(this,{$ref:p},!0)}async function i(p){try{return this._compileSchemaEnv(p)}catch(E){if(!(E instanceof qc.default))throw E;return c.call(this,E),await f.call(this,E.missingSchema),i.call(this,p)}}function c({missingSchema:p,missingRef:E}){if(this.refs[p])throw new Error(`AnySchema ${p} is loaded but ${E} cannot be resolved`)}async function f(p){let E=await y.call(this,p);this.refs[p]||await s.call(this,E.$schema),this.refs[p]||this.addSchema(E,p,r)}async function y(p){let E=this._loading[p];if(E)return E;try{return await(this._loading[p]=n(p))}finally{delete this._loading[p]}}}addSchema(e,r,n,a=this.opts.validateSchema){if(Array.isArray(e)){for(let i of e)this.addSchema(i,void 0,n,a);return this}let s;if(typeof e=="object"){let{schemaId:i}=this.opts;if(s=e[i],s!==void 0&&typeof s!="string")throw new Error(`schema ${i} must be string`)}return r=(0,Fn.normalizeId)(r||s),this._checkUnique(r),this.schemas[r]=this._addSchema(e,n,r,a,!0),this}addMetaSchema(e,r,n=this.opts.validateSchema){return this.addSchema(e,r,!0,n),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let n;if(n=e.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let a=this.validate(n,e);if(!a&&r){let s="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(s);else throw new Error(s)}return a}getSchema(e){let r;for(;typeof(r=xc.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:n}=this.opts,a=new jn.SchemaEnv({schema:{},schemaId:n});if(r=jn.resolveSchema.call(this,a,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=xc.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let n=e[this.opts.schemaId];return n&&(n=(0,Fn.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let n;if(typeof e=="string")n=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof e=="object"&&r===void 0){if(r=e,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(Ep.call(this,n,r),!r)return(0,Gi.eachItem)(n,s=>Ui.call(this,s)),this;Sp.call(this,r);let a=nt(ce({},r),{type:(0,ts.getJSONTypes)(r.type),schemaType:(0,ts.getJSONTypes)(r.schemaType)});return(0,Gi.eachItem)(n,a.type.length===0?s=>Ui.call(this,s,a):s=>a.type.forEach(i=>Ui.call(this,s,a,i))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let n of r.rules){let a=n.rules.findIndex(s=>s.keyword===e);a>=0&&n.rules.splice(a,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!e||e.length===0?"No errors":e.map(a=>`${n}${a.instancePath} ${a.message}`).reduce((a,s)=>a+r+s)}$dataMetaSchema(e,r){let n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let a of r){let s=a.split("/").slice(1),i=e;for(let c of s)i=i[c];for(let c in n){let f=n[c];if(typeof f!="object")continue;let{$data:y}=f.definition,p=i[c];y&&p&&(i[c]=Fc(p))}}return e}_removeAllSchemas(e,r){for(let n in e){let a=e[n];(!r||r.test(n))&&(typeof a=="string"?delete e[n]:a&&!a.meta&&(this._cache.delete(a.schema),delete e[n]))}}_addSchema(e,r,n,a=this.opts.validateSchema,s=this.opts.addUsedSchema){let i,{schemaId:c}=this.opts;if(typeof e=="object")i=e[c];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let f=this._cache.get(e);if(f!==void 0)return f;n=(0,Fn.normalizeId)(i||n);let y=Fn.getSchemaRefs.call(this,e,n);return f=new jn.SchemaEnv({schema:e,schemaId:c,meta:r,baseId:n,localRefs:y}),this._cache.set(f.schema,f),s&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=f),a&&this.validateSchema(e,!0),f}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):jn.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{jn.compileSchema.call(this,e)}finally{this.opts=r}}};je.default=Hn;Hn.ValidationError=sp.default;Hn.MissingRefError=qc.default;function Oc(t,e,r,n="error"){for(let a in t){let s=a;s in e&&this.logger[n](`${r}: option ${a}. ${t[s]}`)}}function xc(t){return t=(0,Fn.normalizeId)(t),this.schemas[t]||this.refs[t]}function pp(){let t=this.opts.schemas;if(!!t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function hp(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function vp(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function gp(){let t=ce({},this.opts);for(let e of cp)delete t[e];return t}var yp={log(){},warn(){},error(){}};function bp(t){if(t===!1)return yp;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var _p=/^[a-z_$][a-z0-9_$:-]*$/i;function Ep(t,e){let{RULES:r}=this;if((0,Gi.eachItem)(t,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!_p.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function Ui(t,e,r){var n;let a=e==null?void 0:e.post;if(r&&a)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:s}=this,i=a?s.post:s.rules.find(({type:f})=>f===r);if(i||(i={type:r,rules:[]},s.rules.push(i)),s.keywords[t]=!0,!e)return;let c={keyword:t,definition:nt(ce({},e),{type:(0,ts.getJSONTypes)(e.type),schemaType:(0,ts.getJSONTypes)(e.schemaType)})};e.before?$p.call(this,i,c,e.before):i.rules.push(c),s.all[t]=c,(n=e.implements)===null||n===void 0||n.forEach(f=>this.addKeyword(f))}function $p(t,e,r){let n=t.rules.findIndex(a=>a.keyword===r);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function Sp(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=Fc(e)),t.validateSchema=this.compile(e,!0))}var wp={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Fc(t){return{anyOf:[t,wp]}}});var Vc=j(zi=>{"use strict";Object.defineProperty(zi,"__esModule",{value:!0});var Cp={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};zi.default=Cp});var zc=j(Cr=>{"use strict";Object.defineProperty(Cr,"__esModule",{value:!0});Cr.callRef=Cr.getValidate=void 0;var Mp=Qa(),Bc=gt(),lt=Z(),Jr=Jt(),Uc=Za(),rs=de(),Tp={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:n}=t,{baseId:a,schemaEnv:s,validateName:i,opts:c,self:f}=n,{root:y}=s;if((r==="#"||r==="#/")&&a===y.baseId)return E();let p=Uc.resolveRef.call(f,y,a,r);if(p===void 0)throw new Mp.default(n.opts.uriResolver,a,r);if(p instanceof Uc.SchemaEnv)return _(p);return $(p);function E(){if(s===y)return ns(t,i,s,s.$async);let C=e.scopeValue("root",{ref:y});return ns(t,(0,lt._)`${C}.validate`,y,y.$async)}function _(C){let M=Gc(t,C);ns(t,M,C,C.$async)}function $(C){let M=e.scopeValue("schema",c.code.source===!0?{ref:C,code:(0,lt.stringify)(C)}:{ref:C}),R=e.name("valid"),N=t.subschema({schema:C,dataTypes:[],schemaPath:lt.nil,topSchemaRef:M,errSchemaPath:r},R);t.mergeEvaluated(N),t.ok(R)}}};function Gc(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,lt._)`${r.scopeValue("wrapper",{ref:e})}.validate`}Cr.getValidate=Gc;function ns(t,e,r,n){let{gen:a,it:s}=t,{allErrors:i,schemaEnv:c,opts:f}=s,y=f.passContext?Jr.default.this:lt.nil;n?p():E();function p(){if(!c.$async)throw new Error("async schema referenced by sync schema");let C=a.let("valid");a.try(()=>{a.code((0,lt._)`await ${(0,Bc.callValidateCode)(t,e,y)}`),$(e),i||a.assign(C,!0)},M=>{a.if((0,lt._)`!(${M} instanceof ${s.ValidationError})`,()=>a.throw(M)),_(M),i||a.assign(C,!1)}),t.ok(C)}function E(){t.result((0,Bc.callValidateCode)(t,e,y),()=>$(e),()=>_(e))}function _(C){let M=(0,lt._)`${C}.errors`;a.assign(Jr.default.vErrors,(0,lt._)`${Jr.default.vErrors} === null ? ${M} : ${Jr.default.vErrors}.concat(${M})`),a.assign(Jr.default.errors,(0,lt._)`${Jr.default.vErrors}.length`)}function $(C){var M;if(!s.opts.unevaluated)return;let R=(M=r==null?void 0:r.validate)===null||M===void 0?void 0:M.evaluated;if(s.props!==!0)if(R&&!R.dynamicProps)R.props!==void 0&&(s.props=rs.mergeEvaluated.props(a,R.props,s.props));else{let N=a.var("props",(0,lt._)`${C}.evaluated.props`);s.props=rs.mergeEvaluated.props(a,N,s.props,lt.Name)}if(s.items!==!0)if(R&&!R.dynamicItems)R.items!==void 0&&(s.items=rs.mergeEvaluated.items(a,R.items,s.items));else{let N=a.var("items",(0,lt._)`${C}.evaluated.items`);s.items=rs.mergeEvaluated.items(a,N,s.items,lt.Name)}}}Cr.callRef=ns;Cr.default=Tp});var Kc=j(Ki=>{"use strict";Object.defineProperty(Ki,"__esModule",{value:!0});var Pp=Vc(),kp=zc(),Ip=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",Pp.default,kp.default];Ki.default=Ip});var Wc=j(Wi=>{"use strict";Object.defineProperty(Wi,"__esModule",{value:!0});var as=Z(),mr=as.operators,ss={maximum:{okStr:"<=",ok:mr.LTE,fail:mr.GT},minimum:{okStr:">=",ok:mr.GTE,fail:mr.LT},exclusiveMaximum:{okStr:"<",ok:mr.LT,fail:mr.GTE},exclusiveMinimum:{okStr:">",ok:mr.GT,fail:mr.LTE}},Dp={message:({keyword:t,schemaCode:e})=>(0,as.str)`must be ${ss[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,as._)`{comparison: ${ss[t].okStr}, limit: ${e}}`},Rp={keyword:Object.keys(ss),type:"number",schemaType:"number",$data:!0,error:Dp,code(t){let{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,as._)`${r} ${ss[e].fail} ${n} || isNaN(${r})`)}};Wi.default=Rp});var Yc=j(Yi=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});var Vn=Z(),Np={message:({schemaCode:t})=>(0,Vn.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,Vn._)`{multipleOf: ${t}}`},Ap={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:Np,code(t){let{gen:e,data:r,schemaCode:n,it:a}=t,s=a.opts.multipleOfPrecision,i=e.let("res"),c=s?(0,Vn._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${s}`:(0,Vn._)`${i} !== parseInt(${i})`;t.fail$data((0,Vn._)`(${n} === 0 || (${i} = ${r}/${n}, ${c}))`)}};Yi.default=Ap});var Qc=j(Ji=>{"use strict";Object.defineProperty(Ji,"__esModule",{value:!0});function Jc(t){let e=t.length,r=0,n=0,a;for(;n<e;)r++,a=t.charCodeAt(n++),a>=55296&&a<=56319&&n<e&&(a=t.charCodeAt(n),(a&64512)===56320&&n++);return r}Ji.default=Jc;Jc.code='require("ajv/dist/runtime/ucs2length").default'});var Xc=j(Qi=>{"use strict";Object.defineProperty(Qi,"__esModule",{value:!0});var Mr=Z(),Lp=de(),Op=Qc(),xp={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,Mr.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,Mr._)`{limit: ${t}}`},qp={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:xp,code(t){let{keyword:e,data:r,schemaCode:n,it:a}=t,s=e==="maxLength"?Mr.operators.GT:Mr.operators.LT,i=a.opts.unicode===!1?(0,Mr._)`${r}.length`:(0,Mr._)`${(0,Lp.useFunc)(t.gen,Op.default)}(${r})`;t.fail$data((0,Mr._)`${i} ${s} ${n}`)}};Qi.default=qp});var Zc=j(Xi=>{"use strict";Object.defineProperty(Xi,"__esModule",{value:!0});var jp=gt(),is=Z(),Fp={message:({schemaCode:t})=>(0,is.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,is._)`{pattern: ${t}}`},Hp={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:Fp,code(t){let{data:e,$data:r,schema:n,schemaCode:a,it:s}=t,i=s.opts.unicodeRegExp?"u":"",c=r?(0,is._)`(new RegExp(${a}, ${i}))`:(0,jp.usePattern)(t,n);t.fail$data((0,is._)`!${c}.test(${e})`)}};Xi.default=Hp});var eu=j(Zi=>{"use strict";Object.defineProperty(Zi,"__esModule",{value:!0});var Bn=Z(),Vp={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,Bn.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,Bn._)`{limit: ${t}}`},Bp={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:Vp,code(t){let{keyword:e,data:r,schemaCode:n}=t,a=e==="maxProperties"?Bn.operators.GT:Bn.operators.LT;t.fail$data((0,Bn._)`Object.keys(${r}).length ${a} ${n}`)}};Zi.default=Bp});var tu=j(eo=>{"use strict";Object.defineProperty(eo,"__esModule",{value:!0});var Un=gt(),Gn=Z(),Up=de(),Gp={message:({params:{missingProperty:t}})=>(0,Gn.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,Gn._)`{missingProperty: ${t}}`},zp={keyword:"required",type:"object",schemaType:"array",$data:!0,error:Gp,code(t){let{gen:e,schema:r,schemaCode:n,data:a,$data:s,it:i}=t,{opts:c}=i;if(!s&&r.length===0)return;let f=r.length>=c.loopRequired;if(i.allErrors?y():p(),c.strictRequired){let $=t.parentSchema.properties,{definedProperties:C}=t.it;for(let M of r)if(($==null?void 0:$[M])===void 0&&!C.has(M)){let R=i.schemaEnv.baseId+i.errSchemaPath,N=`required property "${M}" is not defined at "${R}" (strictRequired)`;(0,Up.checkStrictMode)(i,N,i.opts.strictRequired)}}function y(){if(f||s)t.block$data(Gn.nil,E);else for(let $ of r)(0,Un.checkReportMissingProp)(t,$)}function p(){let $=e.let("missing");if(f||s){let C=e.let("valid",!0);t.block$data(C,()=>_($,C)),t.ok(C)}else e.if((0,Un.checkMissingProp)(t,r,$)),(0,Un.reportMissingProp)(t,$),e.else()}function E(){e.forOf("prop",n,$=>{t.setParams({missingProperty:$}),e.if((0,Un.noPropertyInData)(e,a,$,c.ownProperties),()=>t.error())})}function _($,C){t.setParams({missingProperty:$}),e.forOf($,n,()=>{e.assign(C,(0,Un.propertyInData)(e,a,$,c.ownProperties)),e.if((0,Gn.not)(C),()=>{t.error(),e.break()})},Gn.nil)}}};eo.default=zp});var ru=j(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:!0});var zn=Z(),Kp={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,zn.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,zn._)`{limit: ${t}}`},Wp={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:Kp,code(t){let{keyword:e,data:r,schemaCode:n}=t,a=e==="maxItems"?zn.operators.GT:zn.operators.LT;t.fail$data((0,zn._)`${r}.length ${a} ${n}`)}};to.default=Wp});var os=j(ro=>{"use strict";Object.defineProperty(ro,"__esModule",{value:!0});var nu=Di();nu.code='require("ajv/dist/runtime/equal").default';ro.default=nu});var au=j(ao=>{"use strict";Object.defineProperty(ao,"__esModule",{value:!0});var no=An(),Fe=Z(),Yp=de(),Jp=os(),Qp={message:({params:{i:t,j:e}})=>(0,Fe.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Fe._)`{i: ${t}, j: ${e}}`},Xp={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:Qp,code(t){let{gen:e,data:r,$data:n,schema:a,parentSchema:s,schemaCode:i,it:c}=t;if(!n&&!a)return;let f=e.let("valid"),y=s.items?(0,no.getSchemaTypes)(s.items):[];t.block$data(f,p,(0,Fe._)`${i} === false`),t.ok(f);function p(){let C=e.let("i",(0,Fe._)`${r}.length`),M=e.let("j");t.setParams({i:C,j:M}),e.assign(f,!0),e.if((0,Fe._)`${C} > 1`,()=>(E()?_:$)(C,M))}function E(){return y.length>0&&!y.some(C=>C==="object"||C==="array")}function _(C,M){let R=e.name("item"),N=(0,no.checkDataTypes)(y,R,c.opts.strictNumbers,no.DataType.Wrong),U=e.const("indices",(0,Fe._)`{}`);e.for((0,Fe._)`;${C}--;`,()=>{e.let(R,(0,Fe._)`${r}[${C}]`),e.if(N,(0,Fe._)`continue`),y.length>1&&e.if((0,Fe._)`typeof ${R} == "string"`,(0,Fe._)`${R} += "_"`),e.if((0,Fe._)`typeof ${U}[${R}] == "number"`,()=>{e.assign(M,(0,Fe._)`${U}[${R}]`),t.error(),e.assign(f,!1).break()}).code((0,Fe._)`${U}[${R}] = ${C}`)})}function $(C,M){let R=(0,Yp.useFunc)(e,Jp.default),N=e.name("outer");e.label(N).for((0,Fe._)`;${C}--;`,()=>e.for((0,Fe._)`${M} = ${C}; ${M}--;`,()=>e.if((0,Fe._)`${R}(${r}[${C}], ${r}[${M}])`,()=>{t.error(),e.assign(f,!1).break(N)})))}}};ao.default=Xp});var su=j(io=>{"use strict";Object.defineProperty(io,"__esModule",{value:!0});var so=Z(),Zp=de(),eh=os(),th={message:"must be equal to constant",params:({schemaCode:t})=>(0,so._)`{allowedValue: ${t}}`},rh={keyword:"const",$data:!0,error:th,code(t){let{gen:e,data:r,$data:n,schemaCode:a,schema:s}=t;n||s&&typeof s=="object"?t.fail$data((0,so._)`!${(0,Zp.useFunc)(e,eh.default)}(${r}, ${a})`):t.fail((0,so._)`${s} !== ${r}`)}};io.default=rh});var iu=j(oo=>{"use strict";Object.defineProperty(oo,"__esModule",{value:!0});var Kn=Z(),nh=de(),ah=os(),sh={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,Kn._)`{allowedValues: ${t}}`},ih={keyword:"enum",schemaType:"array",$data:!0,error:sh,code(t){let{gen:e,data:r,$data:n,schema:a,schemaCode:s,it:i}=t;if(!n&&a.length===0)throw new Error("enum must have non-empty array");let c=a.length>=i.opts.loopEnum,f,y=()=>f!=null?f:f=(0,nh.useFunc)(e,ah.default),p;if(c||n)p=e.let("valid"),t.block$data(p,E);else{if(!Array.isArray(a))throw new Error("ajv implementation error");let $=e.const("vSchema",s);p=(0,Kn.or)(...a.map((C,M)=>_($,M)))}t.pass(p);function E(){e.assign(p,!1),e.forOf("v",s,$=>e.if((0,Kn._)`${y()}(${r}, ${$})`,()=>e.assign(p,!0).break()))}function _($,C){let M=a[C];return typeof M=="object"&&M!==null?(0,Kn._)`${y()}(${r}, ${$}[${C}])`:(0,Kn._)`${r} === ${M}`}}};oo.default=ih});var ou=j(lo=>{"use strict";Object.defineProperty(lo,"__esModule",{value:!0});var oh=Wc(),lh=Yc(),ch=Xc(),uh=Zc(),dh=eu(),fh=tu(),mh=ru(),ph=au(),hh=su(),vh=iu(),gh=[oh.default,lh.default,ch.default,uh.default,dh.default,fh.default,mh.default,ph.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},hh.default,vh.default];lo.default=gh});var uo=j(Wn=>{"use strict";Object.defineProperty(Wn,"__esModule",{value:!0});Wn.validateAdditionalItems=void 0;var Tr=Z(),co=de(),yh={message:({params:{len:t}})=>(0,Tr.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Tr._)`{limit: ${t}}`},bh={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:yh,code(t){let{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,co.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}lu(t,n)}};function lu(t,e){let{gen:r,schema:n,data:a,keyword:s,it:i}=t;i.items=!0;let c=r.const("len",(0,Tr._)`${a}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,Tr._)`${c} <= ${e.length}`);else if(typeof n=="object"&&!(0,co.alwaysValidSchema)(i,n)){let y=r.var("valid",(0,Tr._)`${c} <= ${e.length}`);r.if((0,Tr.not)(y),()=>f(y)),t.ok(y)}function f(y){r.forRange("i",e.length,c,p=>{t.subschema({keyword:s,dataProp:p,dataPropType:co.Type.Num},y),i.allErrors||r.if((0,Tr.not)(y),()=>r.break())})}}Wn.validateAdditionalItems=lu;Wn.default=bh});var fo=j(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:!0});Yn.validateTuple=void 0;var cu=Z(),ls=de(),_h=gt(),Eh={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return uu(t,"additionalItems",e);r.items=!0,!(0,ls.alwaysValidSchema)(r,e)&&t.ok((0,_h.validateArray)(t))}};function uu(t,e,r=t.schema){let{gen:n,parentSchema:a,data:s,keyword:i,it:c}=t;p(a),c.opts.unevaluated&&r.length&&c.items!==!0&&(c.items=ls.mergeEvaluated.items(n,r.length,c.items));let f=n.name("valid"),y=n.const("len",(0,cu._)`${s}.length`);r.forEach((E,_)=>{(0,ls.alwaysValidSchema)(c,E)||(n.if((0,cu._)`${y} > ${_}`,()=>t.subschema({keyword:i,schemaProp:_,dataProp:_},f)),t.ok(f))});function p(E){let{opts:_,errSchemaPath:$}=c,C=r.length,M=C===E.minItems&&(C===E.maxItems||E[e]===!1);if(_.strictTuples&&!M){let R=`"${i}" is ${C}-tuple, but minItems or maxItems/${e} are not specified or different at path "${$}"`;(0,ls.checkStrictMode)(c,R,_.strictTuples)}}}Yn.validateTuple=uu;Yn.default=Eh});var du=j(mo=>{"use strict";Object.defineProperty(mo,"__esModule",{value:!0});var $h=fo(),Sh={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,$h.validateTuple)(t,"items")};mo.default=Sh});var mu=j(po=>{"use strict";Object.defineProperty(po,"__esModule",{value:!0});var fu=Z(),wh=de(),Ch=gt(),Mh=uo(),Th={message:({params:{len:t}})=>(0,fu.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,fu._)`{limit: ${t}}`},Ph={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:Th,code(t){let{schema:e,parentSchema:r,it:n}=t,{prefixItems:a}=r;n.items=!0,!(0,wh.alwaysValidSchema)(n,e)&&(a?(0,Mh.validateAdditionalItems)(t,a):t.ok((0,Ch.validateArray)(t)))}};po.default=Ph});var pu=j(ho=>{"use strict";Object.defineProperty(ho,"__esModule",{value:!0});var bt=Z(),cs=de(),kh={message:({params:{min:t,max:e}})=>e===void 0?(0,bt.str)`must contain at least ${t} valid item(s)`:(0,bt.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,bt._)`{minContains: ${t}}`:(0,bt._)`{minContains: ${t}, maxContains: ${e}}`},Ih={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:kh,code(t){let{gen:e,schema:r,parentSchema:n,data:a,it:s}=t,i,c,{minContains:f,maxContains:y}=n;s.opts.next?(i=f===void 0?1:f,c=y):i=1;let p=e.const("len",(0,bt._)`${a}.length`);if(t.setParams({min:i,max:c}),c===void 0&&i===0){(0,cs.checkStrictMode)(s,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(c!==void 0&&i>c){(0,cs.checkStrictMode)(s,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,cs.alwaysValidSchema)(s,r)){let M=(0,bt._)`${p} >= ${i}`;c!==void 0&&(M=(0,bt._)`${M} && ${p} <= ${c}`),t.pass(M);return}s.items=!0;let E=e.name("valid");c===void 0&&i===1?$(E,()=>e.if(E,()=>e.break())):i===0?(e.let(E,!0),c!==void 0&&e.if((0,bt._)`${a}.length > 0`,_)):(e.let(E,!1),_()),t.result(E,()=>t.reset());function _(){let M=e.name("_valid"),R=e.let("count",0);$(M,()=>e.if(M,()=>C(R)))}function $(M,R){e.forRange("i",0,p,N=>{t.subschema({keyword:"contains",dataProp:N,dataPropType:cs.Type.Num,compositeRule:!0},M),R()})}function C(M){e.code((0,bt._)`${M}++`),c===void 0?e.if((0,bt._)`${M} >= ${i}`,()=>e.assign(E,!0).break()):(e.if((0,bt._)`${M} > ${c}`,()=>e.assign(E,!1).break()),i===1?e.assign(E,!0):e.if((0,bt._)`${M} >= ${i}`,()=>e.assign(E,!0)))}}};ho.default=Ih});var gu=j(Vt=>{"use strict";Object.defineProperty(Vt,"__esModule",{value:!0});Vt.validateSchemaDeps=Vt.validatePropertyDeps=Vt.error=void 0;var vo=Z(),Dh=de(),Jn=gt();Vt.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let n=e===1?"property":"properties";return(0,vo.str)`must have ${n} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:n}})=>(0,vo._)`{property: ${t},
    missingProperty: ${n},
    depsCount: ${e},
    deps: ${r}}`};var Rh={keyword:"dependencies",type:"object",schemaType:"object",error:Vt.error,code(t){let[e,r]=Nh(t);hu(t,e),vu(t,r)}};function Nh({schema:t}){let e={},r={};for(let n in t){if(n==="__proto__")continue;let a=Array.isArray(t[n])?e:r;a[n]=t[n]}return[e,r]}function hu(t,e=t.schema){let{gen:r,data:n,it:a}=t;if(Object.keys(e).length===0)return;let s=r.let("missing");for(let i in e){let c=e[i];if(c.length===0)continue;let f=(0,Jn.propertyInData)(r,n,i,a.opts.ownProperties);t.setParams({property:i,depsCount:c.length,deps:c.join(", ")}),a.allErrors?r.if(f,()=>{for(let y of c)(0,Jn.checkReportMissingProp)(t,y)}):(r.if((0,vo._)`${f} && (${(0,Jn.checkMissingProp)(t,c,s)})`),(0,Jn.reportMissingProp)(t,s),r.else())}}Vt.validatePropertyDeps=hu;function vu(t,e=t.schema){let{gen:r,data:n,keyword:a,it:s}=t,i=r.name("valid");for(let c in e)(0,Dh.alwaysValidSchema)(s,e[c])||(r.if((0,Jn.propertyInData)(r,n,c,s.opts.ownProperties),()=>{let f=t.subschema({keyword:a,schemaProp:c},i);t.mergeValidEvaluated(f,i)},()=>r.var(i,!0)),t.ok(i))}Vt.validateSchemaDeps=vu;Vt.default=Rh});var bu=j(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:!0});var yu=Z(),Ah=de(),Lh={message:"property name must be valid",params:({params:t})=>(0,yu._)`{propertyName: ${t.propertyName}}`},Oh={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:Lh,code(t){let{gen:e,schema:r,data:n,it:a}=t;if((0,Ah.alwaysValidSchema)(a,r))return;let s=e.name("valid");e.forIn("key",n,i=>{t.setParams({propertyName:i}),t.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},s),e.if((0,yu.not)(s),()=>{t.error(!0),a.allErrors||e.break()})}),t.ok(s)}};go.default=Oh});var bo=j(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:!0});var us=gt(),It=Z(),xh=Jt(),ds=de(),qh={message:"must NOT have additional properties",params:({params:t})=>(0,It._)`{additionalProperty: ${t.additionalProperty}}`},jh={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:qh,code(t){let{gen:e,schema:r,parentSchema:n,data:a,errsCount:s,it:i}=t;if(!s)throw new Error("ajv implementation error");let{allErrors:c,opts:f}=i;if(i.props=!0,f.removeAdditional!=="all"&&(0,ds.alwaysValidSchema)(i,r))return;let y=(0,us.allSchemaProperties)(n.properties),p=(0,us.allSchemaProperties)(n.patternProperties);E(),t.ok((0,It._)`${s} === ${xh.default.errors}`);function E(){e.forIn("key",a,R=>{!y.length&&!p.length?C(R):e.if(_(R),()=>C(R))})}function _(R){let N;if(y.length>8){let U=(0,ds.schemaRefOrVal)(i,n.properties,"properties");N=(0,us.isOwnProperty)(e,U,R)}else y.length?N=(0,It.or)(...y.map(U=>(0,It._)`${R} === ${U}`)):N=It.nil;return p.length&&(N=(0,It.or)(N,...p.map(U=>(0,It._)`${(0,us.usePattern)(t,U)}.test(${R})`))),(0,It.not)(N)}function $(R){e.code((0,It._)`delete ${a}[${R}]`)}function C(R){if(f.removeAdditional==="all"||f.removeAdditional&&r===!1){$(R);return}if(r===!1){t.setParams({additionalProperty:R}),t.error(),c||e.break();return}if(typeof r=="object"&&!(0,ds.alwaysValidSchema)(i,r)){let N=e.name("valid");f.removeAdditional==="failing"?(M(R,N,!1),e.if((0,It.not)(N),()=>{t.reset(),$(R)})):(M(R,N),c||e.if((0,It.not)(N),()=>e.break()))}}function M(R,N,U){let H={keyword:"additionalProperties",dataProp:R,dataPropType:ds.Type.Str};U===!1&&Object.assign(H,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(H,N)}}};yo.default=jh});var $u=j(Eo=>{"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});var Fh=qn(),_u=gt(),_o=de(),Eu=bo(),Hh={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:n,data:a,it:s}=t;s.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&Eu.default.code(new Fh.KeywordCxt(s,Eu.default,"additionalProperties"));let i=(0,_u.allSchemaProperties)(r);for(let E of i)s.definedProperties.add(E);s.opts.unevaluated&&i.length&&s.props!==!0&&(s.props=_o.mergeEvaluated.props(e,(0,_o.toHash)(i),s.props));let c=i.filter(E=>!(0,_o.alwaysValidSchema)(s,r[E]));if(c.length===0)return;let f=e.name("valid");for(let E of c)y(E)?p(E):(e.if((0,_u.propertyInData)(e,a,E,s.opts.ownProperties)),p(E),s.allErrors||e.else().var(f,!0),e.endIf()),t.it.definedProperties.add(E),t.ok(f);function y(E){return s.opts.useDefaults&&!s.compositeRule&&r[E].default!==void 0}function p(E){t.subschema({keyword:"properties",schemaProp:E,dataProp:E},f)}}};Eo.default=Hh});var Mu=j($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});var Su=gt(),fs=Z(),wu=de(),Cu=de(),Vh={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:n,parentSchema:a,it:s}=t,{opts:i}=s,c=(0,Su.allSchemaProperties)(r),f=c.filter(M=>(0,wu.alwaysValidSchema)(s,r[M]));if(c.length===0||f.length===c.length&&(!s.opts.unevaluated||s.props===!0))return;let y=i.strictSchema&&!i.allowMatchingProperties&&a.properties,p=e.name("valid");s.props!==!0&&!(s.props instanceof fs.Name)&&(s.props=(0,Cu.evaluatedPropsToName)(e,s.props));let{props:E}=s;_();function _(){for(let M of c)y&&$(M),s.allErrors?C(M):(e.var(p,!0),C(M),e.if(p))}function $(M){for(let R in y)new RegExp(M).test(R)&&(0,wu.checkStrictMode)(s,`property ${R} matches pattern ${M} (use allowMatchingProperties)`)}function C(M){e.forIn("key",n,R=>{e.if((0,fs._)`${(0,Su.usePattern)(t,M)}.test(${R})`,()=>{let N=f.includes(M);N||t.subschema({keyword:"patternProperties",schemaProp:M,dataProp:R,dataPropType:Cu.Type.Str},p),s.opts.unevaluated&&E!==!0?e.assign((0,fs._)`${E}[${R}]`,!0):!N&&!s.allErrors&&e.if((0,fs.not)(p),()=>e.break())})})}}};$o.default=Vh});var Tu=j(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});var Bh=de(),Uh={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:n}=t;if((0,Bh.alwaysValidSchema)(n,r)){t.fail();return}let a=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},a),t.failResult(a,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};So.default=Uh});var Pu=j(wo=>{"use strict";Object.defineProperty(wo,"__esModule",{value:!0});var Gh=gt(),zh={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Gh.validateUnion,error:{message:"must match a schema in anyOf"}};wo.default=zh});var ku=j(Co=>{"use strict";Object.defineProperty(Co,"__esModule",{value:!0});var ms=Z(),Kh=de(),Wh={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,ms._)`{passingSchemas: ${t.passing}}`},Yh={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:Wh,code(t){let{gen:e,schema:r,parentSchema:n,it:a}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(a.opts.discriminator&&n.discriminator)return;let s=r,i=e.let("valid",!1),c=e.let("passing",null),f=e.name("_valid");t.setParams({passing:c}),e.block(y),t.result(i,()=>t.reset(),()=>t.error(!0));function y(){s.forEach((p,E)=>{let _;(0,Kh.alwaysValidSchema)(a,p)?e.var(f,!0):_=t.subschema({keyword:"oneOf",schemaProp:E,compositeRule:!0},f),E>0&&e.if((0,ms._)`${f} && ${i}`).assign(i,!1).assign(c,(0,ms._)`[${c}, ${E}]`).else(),e.if(f,()=>{e.assign(i,!0),e.assign(c,E),_&&t.mergeEvaluated(_,ms.Name)})})}}};Co.default=Yh});var Iu=j(Mo=>{"use strict";Object.defineProperty(Mo,"__esModule",{value:!0});var Jh=de(),Qh={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let a=e.name("valid");r.forEach((s,i)=>{if((0,Jh.alwaysValidSchema)(n,s))return;let c=t.subschema({keyword:"allOf",schemaProp:i},a);t.ok(a),t.mergeEvaluated(c)})}};Mo.default=Qh});var Nu=j(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});var ps=Z(),Ru=de(),Xh={message:({params:t})=>(0,ps.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,ps._)`{failingKeyword: ${t.ifClause}}`},Zh={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:Xh,code(t){let{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,Ru.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let a=Du(n,"then"),s=Du(n,"else");if(!a&&!s)return;let i=e.let("valid",!0),c=e.name("_valid");if(f(),t.reset(),a&&s){let p=e.let("ifClause");t.setParams({ifClause:p}),e.if(c,y("then",p),y("else",p))}else a?e.if(c,y("then")):e.if((0,ps.not)(c),y("else"));t.pass(i,()=>t.error(!0));function f(){let p=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},c);t.mergeEvaluated(p)}function y(p,E){return()=>{let _=t.subschema({keyword:p},c);e.assign(i,c),t.mergeValidEvaluated(_,i),E?e.assign(E,(0,ps._)`${p}`):t.setParams({ifClause:p})}}}};function Du(t,e){let r=t.schema[e];return r!==void 0&&!(0,Ru.alwaysValidSchema)(t,r)}To.default=Zh});var Au=j(Po=>{"use strict";Object.defineProperty(Po,"__esModule",{value:!0});var ev=de(),tv={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,ev.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};Po.default=tv});var Lu=j(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});var rv=uo(),nv=du(),av=fo(),sv=mu(),iv=pu(),ov=gu(),lv=bu(),cv=bo(),uv=$u(),dv=Mu(),fv=Tu(),mv=Pu(),pv=ku(),hv=Iu(),vv=Nu(),gv=Au();function yv(t=!1){let e=[fv.default,mv.default,pv.default,hv.default,vv.default,gv.default,lv.default,cv.default,ov.default,uv.default,dv.default];return t?e.push(nv.default,sv.default):e.push(rv.default,av.default),e.push(iv.default),e}ko.default=yv});var Ou=j(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0});var Ie=Z(),bv={message:({schemaCode:t})=>(0,Ie.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,Ie._)`{format: ${t}}`},_v={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:bv,code(t,e){let{gen:r,data:n,$data:a,schema:s,schemaCode:i,it:c}=t,{opts:f,errSchemaPath:y,schemaEnv:p,self:E}=c;if(!f.validateFormats)return;a?_():$();function _(){let C=r.scopeValue("formats",{ref:E.formats,code:f.code.formats}),M=r.const("fDef",(0,Ie._)`${C}[${i}]`),R=r.let("fType"),N=r.let("format");r.if((0,Ie._)`typeof ${M} == "object" && !(${M} instanceof RegExp)`,()=>r.assign(R,(0,Ie._)`${M}.type || "string"`).assign(N,(0,Ie._)`${M}.validate`),()=>r.assign(R,(0,Ie._)`"string"`).assign(N,M)),t.fail$data((0,Ie.or)(U(),H()));function U(){return f.strictSchema===!1?Ie.nil:(0,Ie._)`${i} && !${N}`}function H(){let oe=p.$async?(0,Ie._)`(${M}.async ? await ${N}(${n}) : ${N}(${n}))`:(0,Ie._)`${N}(${n})`,B=(0,Ie._)`(typeof ${N} == "function" ? ${oe} : ${N}.test(${n}))`;return(0,Ie._)`${N} && ${N} !== true && ${R} === ${e} && !${B}`}}function $(){let C=E.formats[s];if(!C){U();return}if(C===!0)return;let[M,R,N]=H(C);M===e&&t.pass(oe());function U(){if(f.strictSchema===!1){E.logger.warn(B());return}throw new Error(B());function B(){return`unknown format "${s}" ignored in schema at path "${y}"`}}function H(B){let L=B instanceof RegExp?(0,Ie.regexpCode)(B):f.code.formats?(0,Ie._)`${f.code.formats}${(0,Ie.getProperty)(s)}`:void 0,J=r.scopeValue("formats",{key:s,ref:B,code:L});return typeof B=="object"&&!(B instanceof RegExp)?[B.type||"string",B.validate,(0,Ie._)`${J}.validate`]:["string",B,J]}function oe(){if(typeof C=="object"&&!(C instanceof RegExp)&&C.async){if(!p.$async)throw new Error("async format in sync schema");return(0,Ie._)`await ${N}(${n})`}return typeof R=="function"?(0,Ie._)`${N}(${n})`:(0,Ie._)`${N}.test(${n})`}}}};Io.default=_v});var xu=j(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});var Ev=Ou(),$v=[Ev.default];Do.default=$v});var qu=j(Qr=>{"use strict";Object.defineProperty(Qr,"__esModule",{value:!0});Qr.contentVocabulary=Qr.metadataVocabulary=void 0;Qr.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Qr.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var Fu=j(Ro=>{"use strict";Object.defineProperty(Ro,"__esModule",{value:!0});var Sv=Kc(),wv=ou(),Cv=Lu(),Mv=xu(),ju=qu(),Tv=[Sv.default,wv.default,(0,Cv.default)(),Mv.default,ju.metadataVocabulary,ju.contentVocabulary];Ro.default=Tv});var Hu=j(Qn=>{"use strict";Object.defineProperty(Qn,"__esModule",{value:!0});Qn.DiscrError=void 0;var Pv;(function(t){t.Tag="tag",t.Mapping="mapping"})(Pv=Qn.DiscrError||(Qn.DiscrError={}))});var Bu=j(Ao=>{"use strict";Object.defineProperty(Ao,"__esModule",{value:!0});var Xr=Z(),No=Hu(),Vu=Za(),kv=de(),Iv={message:({params:{discrError:t,tagName:e}})=>t===No.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,Xr._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},Dv={keyword:"discriminator",type:"object",schemaType:"object",error:Iv,code(t){let{gen:e,data:r,schema:n,parentSchema:a,it:s}=t,{oneOf:i}=a;if(!s.opts.discriminator)throw new Error("discriminator: requires discriminator option");let c=n.propertyName;if(typeof c!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");let f=e.let("valid",!1),y=e.const("tag",(0,Xr._)`${r}${(0,Xr.getProperty)(c)}`);e.if((0,Xr._)`typeof ${y} == "string"`,()=>p(),()=>t.error(!1,{discrError:No.DiscrError.Tag,tag:y,tagName:c})),t.ok(f);function p(){let $=_();e.if(!1);for(let C in $)e.elseIf((0,Xr._)`${y} === ${C}`),e.assign(f,E($[C]));e.else(),t.error(!1,{discrError:No.DiscrError.Mapping,tag:y,tagName:c}),e.endIf()}function E($){let C=e.name("valid"),M=t.subschema({keyword:"oneOf",schemaProp:$},C);return t.mergeEvaluated(M,Xr.Name),C}function _(){var $;let C={},M=N(a),R=!0;for(let oe=0;oe<i.length;oe++){let B=i[oe];(B==null?void 0:B.$ref)&&!(0,kv.schemaHasRulesButRef)(B,s.self.RULES)&&(B=Vu.resolveRef.call(s.self,s.schemaEnv.root,s.baseId,B==null?void 0:B.$ref),B instanceof Vu.SchemaEnv&&(B=B.schema));let L=($=B==null?void 0:B.properties)===null||$===void 0?void 0:$[c];if(typeof L!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${c}"`);R=R&&(M||N(B)),U(L,oe)}if(!R)throw new Error(`discriminator: "${c}" must be required`);return C;function N({required:oe}){return Array.isArray(oe)&&oe.includes(c)}function U(oe,B){if(oe.const)H(oe.const,B);else if(oe.enum)for(let L of oe.enum)H(L,B);else throw new Error(`discriminator: "properties/${c}" must have "const" or "enum"`)}function H(oe,B){if(typeof oe!="string"||oe in C)throw new Error(`discriminator: "${c}" values must be unique strings`);C[oe]=B}}}};Ao.default=Dv});var Uu=j((M_,Rv)=>{Rv.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var Ku=j((Ce,zu)=>{"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Ce.MissingRefError=Ce.ValidationError=Ce.CodeGen=Ce.Name=Ce.nil=Ce.stringify=Ce.str=Ce._=Ce.KeywordCxt=void 0;var Nv=Hc(),Av=Fu(),Lv=Bu(),Gu=Uu(),Ov=["/properties"],hs="http://json-schema.org/draft-07/schema",vs=class extends Nv.default{_addVocabularies(){super._addVocabularies(),Av.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(Lv.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(Gu,Ov):Gu;this.addMetaSchema(e,hs,!1),this.refs["http://json-schema.org/schema"]=hs}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(hs)?hs:void 0)}};zu.exports=Ce=vs;Object.defineProperty(Ce,"__esModule",{value:!0});Ce.default=vs;var xv=qn();Object.defineProperty(Ce,"KeywordCxt",{enumerable:!0,get:function(){return xv.KeywordCxt}});var Zr=Z();Object.defineProperty(Ce,"_",{enumerable:!0,get:function(){return Zr._}});Object.defineProperty(Ce,"str",{enumerable:!0,get:function(){return Zr.str}});Object.defineProperty(Ce,"stringify",{enumerable:!0,get:function(){return Zr.stringify}});Object.defineProperty(Ce,"nil",{enumerable:!0,get:function(){return Zr.nil}});Object.defineProperty(Ce,"Name",{enumerable:!0,get:function(){return Zr.Name}});Object.defineProperty(Ce,"CodeGen",{enumerable:!0,get:function(){return Zr.CodeGen}});var qv=Ja();Object.defineProperty(Ce,"ValidationError",{enumerable:!0,get:function(){return qv.default}});var jv=Qa();Object.defineProperty(Ce,"MissingRefError",{enumerable:!0,get:function(){return jv.default}})});var Fo=(t,e)=>(t+e)/2,ga=(t,e)=>Math.random()*(e-t)+t;var Ar=(t,e,r)=>Math.max(e,Math.min(t,r));function O(t,e){let r=(e||document).querySelector(t);if(!r)throw Error(`HTMLElement with selectors ${t} could not be found!`);return r}function ya(t,e,r){let n=[...t.querySelectorAll(":scope > [data-tab-target]")];for(let a of n)a.addEventListener("click",()=>{n.forEach(c=>c.classList.toggle("selected",c===a));let s=a.getAttribute("data-tab-target"),i=O(`[data-tab-content="${s}"]`,e);r(a,i)})}function ba(t,e){var n;let r=t.getAttribute("data-tab-target");[...((n=e.parentElement)==null?void 0:n.children)||[]].filter(a=>a.hasAttribute("data-tab-content")).forEach(a=>{a.classList.toggle("hidden",a.getAttribute("data-tab-content")!==r)})}function Ke(t,e){let r="data-highlight-notification";if(t.classList.contains("selected"))return;t.setAttribute(r,"");let n=()=>{t.removeAttribute(r),t.removeEventListener(e,n)};t.addEventListener(e,n)}var cd=/<a.+?(?=<\/a>)<\/a>/g,ud=/data\-raw\=\"([^\"]*)/,dd=/>(.+)<\/a>/;async function Ho(){let e=[...(await(await fetch(envVariables.configReadmeUrl)).text()).matchAll(cd)].map(n=>n[0]),r=[];for(let n of e){let a=n.match(ud),s=n.match(dd);if(!a||!s)continue;let i=a[1],c=s[1];Ds(i)&&r.push({url:i,name:c})}return r}function Ds(t){return/^https:\/\/raw\.githubusercontent\.com\/.+?(?=\.json)/.test(t)}var Ns=jo(Bo(),1),pn={save:fd,load:md};async function fd(t,e){try{switch(t){case"Game":return await pd("ts-game",e)}}catch(r){console.error(r)}}async function md(t){try{switch(t){case"Game":let e=await hd("ts-game");return e||null;default:return null}}catch(e){console.error(e)}}async function pd(t,e){let r=window.btoa(JSON.stringify(e)),n=new Blob([r],{type:"text/plain"});return await Ns.default.setItem(t,n)}async function hd(t){let e=await Ns.default.getItem(t);if(!e)return e;let r=await e.text();return JSON.parse(window.atob(r))}async function _a(){let t=[],e=await pn.load("Game");if(!e)return t;for(let r of Object.values(e)){let n=ce({},r.meta);t.push(n)}return t}var Os,Ea=class{constructor(){P(this,"config");P(this,"remoteEntryHandler",new As);P(this,"localEntryHandler",new Ls)}getActiveEntry(){return Os}async getEntryListElements(e){switch(e){case"remote":return await this.remoteEntryHandler.getEntryListElements();case"local":return await this.localEntryHandler.getEntryListElements()}}},As=class{constructor(){}async getEntries(){return await Ho()}async getEntryListElements(){let e=await this.getEntries(),r=[];for(let n of e){let a=document.createElement("li");a.classList.add("g-list-item"),a.textContent=n.name,a.addEventListener("click",()=>{Os=n}),r.push(a)}return r}},Ls=class{constructor(){}async getEntries(){return await _a()}async getEntryListElements(){let e=await this.getEntries(),r=[];for(let n of e.filter(a=>a.url)){let a=document.createElement("li");a.classList.add("g-list-item");let s=this.generateTimeText(n.startTimeMS);a.insertAdjacentHTML("beforeend",`<div>${n.name}</div><div class="g-text-small">${s}</div>`),a.addEventListener("click",()=>{Os=n}),r.push(a)}return r}generateTimeText(e=0){let r=Date.now()-e,n=Math.floor(r/864e5).toFixed(),a=(Math.floor(r/36e5)%24).toFixed(),s=(Math.floor(r/6e4)%60).toFixed();return`Last Played ${n}d ${a}h ${s}min`}};var ft=class{constructor(){P(this,"listeners",new Map)}listen(e,r){let n={callback:e,opts:r};this.listeners.set(e,n)}removeListener(e){this.listeners.delete(e)}removeAllListeners(){this.listeners.clear()}invoke(e){var r;this.listeners.forEach(n=>{n.callback(e)});for(let[n,a]of this.listeners.entries())(r=a.opts)!=null&&r.once&&this.listeners.delete(n)}};var We=class{constructor(e){P(this,"defaultValue");P(this,"value");P(this,"listeners",new Map([["change",new ft],["set",new ft],["add",new ft],["subtract",new ft]]));this.defaultValue=e,this.value=e}set(e){var r,n;this.value=e,(r=this.listeners.get("set"))==null||r.invoke(this.value),(n=this.listeners.get("change"))==null||n.invoke(this.value)}get(){return this.value}add(e){var r,n;this.value+=e,(r=this.listeners.get("add"))==null||r.invoke(this.value),(n=this.listeners.get("change"))==null||n.invoke(this.value)}subtract(e){var r,n;this.value-=e,(r=this.listeners.get("subtract"))==null||r.invoke(this.value),(n=this.listeners.get("change"))==null||n.invoke(this.value)}reset(){this.value=this.defaultValue,this.listeners.forEach(e=>e.removeAllListeners())}addListener(e,r){var n;(n=this.listeners.get(e))==null||n.listen(r)}removeListener(e,r){var n;(n=this.listeners.get(e))==null||n.removeListener(r)}};var mt={None:1<<0,Attack:1<<1,Physical:1<<2,Elemental:1<<3,Chaos:1<<4,Skill:1<<5},$a=[{desc:"#% Increased Physical Damage",tags:["Physical"],stats:[{name:"Damage",valueType:"Inc",flags:mt.Physical}]},{desc:"#% More Physical Damage",tags:["Physical"],stats:[{name:"Damage",valueType:"More",flags:mt.Physical}]},{desc:"#% More Damage",tags:[],stats:[{name:"Damage",valueType:"More"}]},{desc:"Adds # To # Physical Damage",tags:["Physical"],stats:[{name:"MinDamage",valueType:"Base",flags:mt.Physical},{name:"MaxDamage",valueType:"Base",flags:mt.Physical}]},{desc:"+#% Hit Chance",tags:[],stats:[{name:"HitChance",valueType:"Base"}]},{desc:"#% Increased Attack Speed",tags:["Speed"],stats:[{name:"AttackSpeed",valueType:"Inc"}]},{desc:"#% More Attack Speed",tags:["Speed"],stats:[{name:"AttackSpeed",valueType:"More"}]},{desc:"#% Increased Maximum Mana",tags:["Mana"],stats:[{name:"MaxMana",valueType:"Inc"}]},{desc:"+# Maximum Mana",tags:["Mana"],stats:[{name:"MaxMana",valueType:"Base"}]},{desc:"+# Mana Regeneration",tags:["Mana"],stats:[{name:"ManaRegen",valueType:"Base"}]},{desc:"+#% Critical Hit Chance",tags:["Critical"],stats:[{name:"CritChance",valueType:"Base"}]},{desc:"+#% Critical Hit Multiplier",tags:["Critical"],stats:[{name:"CritMulti",valueType:"Base"}]},{desc:"+# Gold Per Second",tags:["Gold"],stats:[{name:"GoldPerSecond",valueType:"Base"}]},{desc:"#% Increased Gold Per Second",tags:["Gold"],stats:[{name:"GoldPerSecond",valueType:"Inc"}]},{desc:"#% Increased Skill Duration",tags:["Gold"],stats:[{name:"Duration",valueType:"Inc",flags:mt.Skill}]}],Ye=class{constructor(e){P(this,"text");P(this,"template");P(this,"tags",[]);P(this,"stats",[]);this.text=e;let r=[...e.matchAll(new RegExp("{(?<v1>\\d+(\\.\\d+)?)(-(?<v2>\\d+(\\.\\d+)?))?\\}","g"))],n=e.replace(/{[^}]+}/g,"#");if(!$a.some(a=>a.desc===n))throw Error("Failed to find mod template. Invalid mod description");this.template=$a.find(a=>a.desc===n),this.tags=this.template.tags;for(let a of this.template.stats){let s=r[this.template.stats.indexOf(a)].groups;if(!s)throw Error();let{v1:i,v2:c}=s,f=parseFloat(i),y=parseFloat(c)||f,p=f;this.stats.push(new hr({name:a.name,valueType:a.valueType,value:p,min:f,max:y,flags:a.flags||0}))}}get templateDesc(){return this.template.desc}get desc(){let e=0;return this.templateDesc.replace(/#+/g,r=>{var s;return((s=this.stats[e++].value)==null?void 0:s.toFixed(r.length-1))||"#"})}static compare(e,r){return e.compare(r)}static sort(e,r){return e.sort(r)}sort(e){return $a.findIndex(r=>r.desc===this.templateDesc)-$a.findIndex(r=>r.desc===e.templateDesc)}compare(e){return this.templateDesc===e.templateDesc}copy(){return new Ye(this.text)}setStatValues(e){if(this.stats.length===e.length)return this.stats.forEach((r,n)=>r.value=e[n]),!0}},hr=class{constructor(e){P(this,"name");P(this,"valueType");P(this,"value");P(this,"flags");P(this,"min");P(this,"max");P(this,"source");this.name=e.name,this.valueType=e.valueType,this.value=e.value,this.flags=e.flags||0,this.min=e.min||this.value,this.max=e.max||this.value||this.min,this.source=e.source}randomizeValue(){this.value=Math.random()*(this.max-this.min)+this.min}},Sa=class{constructor(){P(this,"_modList");P(this,"onChange");this._modList=[],this.onChange=new ft}get modList(){return this._modList}add(e,r){e.forEach(n=>n.source=r),this.modList.push(...e),this.onChange.invoke([...this.modList])}removeBySource(e){this._modList=this.modList.filter(r=>r.source!==e),this.onChange.invoke([...this.modList])}clear(){this._modList=[],this.onChange.invoke([...this.modList])}};var wa={Physical:1<<0,Elemental:1<<1,Chaos:1<<2},vd=(()=>{let t=[],e=Object.values(wa).reduce((r,n)=>r+n);for(let r=0;r<=e;r++){let n=["Damage"];Object.entries(wa).forEach(([a,s])=>{if(s&r){let i=`${a}Damage`;n.push(i)}}),t.push(n)}return t})();function Uo(t){let e={statModList:t,flags:mt.Attack,calcMinMax:ga},r=pt("HitChance",e)/100,n=ga(0,1),a=r>=n;if(!a)return!1;e.flags=mt.Attack;let s=xs(e),i=Math.min(pt("CritChance",e),100)/100,c=ga(0,1),f=i>=c,y=1;f&&(y=pt("CritMulti",e)/100);let E=Gt("BaseDamageMultiplier",e)/100*y,_=s.totalBaseDamage*E,$=s.physicalDamage*E;return{hit:a,crit:f,totalDamage:_,totalPhysicalDamage:$}}function xs(t){let e=gd(t),r={totalBaseDamage:0,minPhysicalDamage:0,maxPhysicalDamage:0,physicalDamage:0,minElementalDamage:0,maxElementalDamage:0,elementalDamage:0,minChaosDamage:0,maxChaosDamage:0,chaosDamage:0},n=0;{t.flags|=mt.Physical;let{min:a,max:s}=Go("Physical",t,e);r.minPhysicalDamage=a,r.maxPhysicalDamage=s;let i=t.calcMinMax(a,s);r.physicalDamage=i,n+=i}return r.totalBaseDamage=n,r}function Go(t,e,r,n=0){n|=wa[t];let a=0,s=0,i=["Physical","Elemental","Chaos"];for(let _ of i){if(_===t)break;let $=r[_][t];if($>0){let{min:C,max:M}=Go(_,e,r,n);a+=Math.ceil(C*$),s+=Math.ceil(M*$)}}let c=Gt("MinDamage",e),f=Gt("MaxDamage",e),y=vd[n],p=Math.round(Ca(y,c,e)+a),E=Math.round(Ca(y,f,e)+s);return{min:p,max:E}}function gd(t){let e={},r=Object.keys(wa);for(let n=0;n<r.length;n++){let a=r[n],s={},i={},c={},f=0,y=0;for(let _=n+1;_<r.length;_++){let $=r[n],C=`${a}ConvertedTo${$}`;s[$]=Gt(C,t),f+=s[$],i[$]=Gt(C,t),y+=i[$],c[$]=Gt(`${a}GainAs${$}`,t)}let p=y>100?100/y:(100-y)/f;for(let _ of Object.keys(i))i[_]*=p;let E={multi:1};for(let[_,$]of Object.entries(s)){let C=i[_]||0,M=c[_]||0;E[_]=($+C+M)/100}E.multi=1-Math.min((f+y)/100,1),e[a]=E}return e.Chaos={multi:1},e}function zo(t){let e={statModList:t,flags:mt.Attack,calcMinMax:Fo},r=pt("HitChance",e)/100,n=Ar(r,0,1),a=pt("AttackSpeed",e),s=Gt("BaseDamageMultiplier",e)/100,i=pt("MaxMana",e),c=pt("ManaRegen",e),f=pt("AttackManaCost",e),y=pt("CritChance",e)/100,p=Ar(y,0,1),E=Math.max(pt("CritMulti",e),100)/100,_=1+p*E,$=xs(e),C=s*_,M=$.totalBaseDamage*n*a*C;return{hitChance:r*100,clampedHitChance:n*100,attackSpeed:a,critChance:y*100,clampedCritChance:p*100,critMulti:E*100,maxMana:i,manaRegen:c,attackManaCost:f,dps:M,minPhysicalDamage:$.minPhysicalDamage,maxPhysicalDamage:$.maxPhysicalDamage,goldPerSecond:pt("GoldPerSecond",e),skillDurationMultiplier:Ca("Duration",1,Object.assign({},e,{flags:mt.Skill}))}}function Gt(t,e){return qs("Base",t,e)}function Ko(t,e){return Math.max(0,1+qs("Inc",t,e)/100)}function Wo(t,e){return Math.max(0,qs("More",t,e))}function Ca(t,e,r){if(e<=0)return 0;let n=Ko(t,r),a=Wo(t,r);return e*n*a}function pt(t,e){let r=Gt(t,e);if(r===0)return 0;let n=Ko(t,e),a=Wo(t,e);return r*n*a}function qs(t,e,r){e=Array.isArray(e)?e:[e];let n=t==="More"?1:0,a=(i,c)=>(i&c)===c,s=r.statModList.filter(i=>!(!e.includes(i.name)||i.valueType!==t||!a(r.flags,i.flags||0)));for(let i of s){let c=i.value;t==="More"?n*=1+c/100:n+=c}return Math.max(0,n)}var js=O(".p-game .s-enemy [data-health-bar]"),Ot,Be,ir,Fs=new ft;Fs.listen(()=>{Be=Ot[++ir],Be.init()});function Hs(t){Ot=[],ir=0,Ot.push(...t.enemyList.map(e=>new Ma(e))),Ot.push(new Ta),Be=Ot[ir],Be.init()}function yd(t){Be.takeDamage(t)}function bd(t){ir=Ar(t-1,0,Ot.length-1),Be=Ot[ir],Be.init()}function Yo(t){t.enemy={index:ir,health:Be.health,dummyDamage:Be==null?void 0:Be.damage}}function Jo(t){let e=t.enemy;!e||(ir=e.index||0,Be=Ot[ir],Be.health=e.health,Be instanceof Ta&&(Be.damage=e.dummyDamage||0),Be.init())}var Ma=class{constructor(e){this.maxHealth=e;P(this,"health");this.health=e}init(){this.updateHealthBar()}takeDamage(e){this.health=Ar(this.health-e,0,this.health),this.updateHealthBar(),this.health===0&&Fs.invoke(this)}updateHealthBar(){let e=this.health/this.maxHealth*100;js.style.width=`${e}%`}},Ta=class extends Ma{constructor(){super(1);P(this,"damage");this.damage=0}init(){js.style.width="100%",this.updateHealthBar()}takeDamage(r){this.damage+=r,this.updateHealthBar()}updateHealthBar(){js.setAttribute("data-damage",this.damage.toFixed())}},Vs={init:Hs,spawnEnemyAt:bd,dealDamage:yd,onDeath:Fs};var Ct=(t,e)=>{let r=new IntersectionObserver(n);return r.observe(t),r;function n(a){a.forEach(s=>{e(s.isIntersecting,r)})}};var xt=class extends We{constructor(r,n){super(r);P(this,"hidden");this.hidden=n||!1}},Pa={"Time Played":new xt(0),"Gold Generated":new xt(0),"Mana Generated":new xt(0),Hits:new xt(0),"Critical Hits":new xt(0),"Total Damage":new xt(0),"Total Physical Damage":new xt(0),"Prestige Count":new xt(0)},Le=Pa,Qo=0;Ct(document.querySelector(".p-game .p-statistics"),_d);function _d(t){t?(Object.entries(Pa).forEach(([e,r])=>Xo(e,r)),Qo=Re.subscribe(()=>Object.entries(Pa).forEach(([e,r])=>Xo(e,r)),{intervalMilliseconds:1e3})):Re.unsubscribe(Qo)}function Zo(){let t=[],e=r=>{let n=document.createElement("li");n.classList.add("g-field","hidden");let a=document.createElement("div");n.appendChild(a);let s=document.createElement("var");return n.appendChild(s),a.textContent=r,s.setAttribute("data-stat",r),s.setAttribute("data-format-type",Ed(r)),n};for(let r of Object.keys(Pa)){let n=e(r);t.push(n)}document.querySelector(".p-statistics ul").replaceChildren(...t)}function Ed(t){switch(t){case"Time Played":return"time"}return""}function Xo(t,e){var s;let r=document.querySelector(`.p-statistics [data-stat="${t}"]`);if(!r)return;let n=e.get()===0;if((s=r.parentElement)==null||s.classList.toggle("hidden",n),n)return;switch(r.getAttribute("data-format-type")){case"time":let i=new Date(0);i.setSeconds(e.get());let c=i.toISOString().substring(11,19);r.textContent=c;break;default:r.textContent=e.get().toFixed(0)}}var Bs=document.querySelector(".p-game > .s-stats"),$d=document.querySelector(".p-combat [data-mana-bar]"),el,Pe=new Sa;Pe.onChange.listen(Us);Vs.onDeath.listen(()=>{q.level.get()<Ot.length-1&&q.level.add(1)});var q=Object.freeze({level:new We(1),gold:new We(0),goldPerSecond:new We(0),attackSpeed:new We(0),attackManaCost:new We(0),maxMana:new We(0),curMana:new We(0),manaRegen:new We(0),skillDurationMultiplier:new We(1)});function tl(t){Pe.clear(),Object.values(q).forEach(e=>e.reset()),q.level.addListener("change",e=>O('[data-stat="level"]',Bs).textContent=e.toFixed()),q.gold.addListener("change",e=>O('[data-stat="gold"]',Bs).textContent=e.toFixed()),q.level.set(1),q.gold.set(0),q.curMana.addListener("change",e=>{let r=q.maxMana.get();e>r&&q.curMana.set(r),Sd()}),t&&t.modList.forEach(e=>{Pe.add(new Ye(e).stats,"Player")}),Re.subscribe(()=>{let e=q.goldPerSecond.get();q.gold.add(e),Le["Gold Generated"].add(e)},{intervalMilliseconds:1e3}),Re.subscribe(e=>{let r=q.manaRegen.get()*e;q.curMana.add(r),Le["Mana Generated"].add(r)}),wd()}async function ka(){await Us(),q.curMana.set(q.maxMana.get())}async function Us(){return new Promise(t=>{clearTimeout(el),el=window.setTimeout(async()=>{let e=zo(Pe.modList);q.attackSpeed.set(e.attackSpeed),q.goldPerSecond.set(e.goldPerSecond),q.maxMana.set(e.maxMana),q.manaRegen.set(e.manaRegen),q.attackManaCost.set(e.attackManaCost),q.skillDurationMultiplier.set(e.skillDurationMultiplier),Bs.querySelectorAll("[data-stat]").forEach(r=>{let n=r.getAttribute("data-stat"),a=e[n];if(typeof a=="number"){let s=Number(r.getAttribute("data-digits")||0);r.textContent=a.toFixed(s)}}),t(null)},1)})}function Sd(){let t=q.curMana.get()/q.maxMana.get()*100;$d.style.width=t+"%"}function wd(){let t=0;Re.subscribe(e=>{let r=1/q.attackSpeed.get();if(t+=e,t>=r){let n=q.curMana.get(),a=q.attackManaCost.get();n>a&&(q.curMana.subtract(a),Cd(),t=0)}})}function Cd(){let t=Uo(Pe.modList);!t||(Le.Hits.add(1),Le["Total Damage"].add(t.totalDamage),Le["Total Physical Damage"].add(t.totalPhysicalDamage),t.crit&&Le["Critical Hits"].add(1),Vs.dealDamage(t.totalDamage))}function rl(t){t.player={level:q.level.get(),gold:q.gold.get(),curMana:q.curMana.get()}}async function nl(t){let e=t.player;!e||(q.level.set(e.level||1),q.gold.set(e.gold||0),q.curMana.set(e.curMana||0),await Us())}var Ia=class{constructor(){P(this,"modalElement",O(".p-game .p-combat [data-skill-modal]"));P(this,"skillListContainer",O("[data-skill-list]",this.modalElement));P(this,"skillInfoContainer",O("[data-skill-info]",this.modalElement));P(this,"applyButton",O('[data-value="apply"]',this.modalElement));P(this,"removeButton",O('[data-value="remove"]',this.modalElement));P(this,"cancelButton",O('[data-value="cancel"]',this.modalElement));P(this,"skillSlot");P(this,"selectedSkill");this.applyButton.addEventListener("click",()=>this.apply()),this.removeButton.addEventListener("click",()=>this.remove()),this.cancelButton.addEventListener("click",()=>this.cancel())}open(e){this.skillSlot=e.skillSlot,this.removeButton.classList.toggle("hidden",!e.canRemove),this.removeButton.toggleAttribute("disabled",this.skillSlot.skill===void 0),this.populateSkillList(e.skills),this.modalElement.classList.remove("hidden")}populateSkillList(e){var a,s,i,c,f,y;let r=Array.from(((s=(a=this.skillSlot)==null?void 0:a.element.parentElement)==null?void 0:s.children)||[]).map(p=>p.getAttribute("data-skill-name")),n=[];for(let p of e){let E=document.createElement("li");E.textContent=p.name,E.classList.add("g-list-item"),E.setAttribute("data-skill-name",p.name);let _=r.some($=>$===p.name);E.toggleAttribute("disabled",_),E.addEventListener("click",()=>{var C;this.showInfo(p),n.forEach(M=>M.classList.toggle("selected",M===E)),this.applyButton.toggleAttribute("disabled",p===((C=this.skillSlot)==null?void 0:C.skill));let $=p;this.selectedSkill=$}),n.push(E)}if(this.skillListContainer.replaceChildren(...n),(i=this.skillSlot)!=null&&i.skill){let p=this.skillListContainer.querySelector(`[data-skill-name="${(f=(c=this.skillSlot)==null?void 0:c.skill)==null?void 0:f.name}"]`);p&&p.click()}else(y=n[0])==null||y.click()}showInfo(e){var i,c,f;O("[data-title]").textContent=e.name,O('[data-stat="manaCost"]',this.skillInfoContainer).textContent=e.manaCost.toFixed();let r=O('[data-stat="attackSpeed"]',this.skillInfoContainer),n=O('[data-stat="baseDamageMultiplier"]',this.skillInfoContainer),a=O('[data-stat="baseDuration"]',this.skillInfoContainer);[r,n,a].forEach(y=>{var p;return(p=y.parentElement)==null?void 0:p.classList.add("hidden")}),e instanceof Lr?((i=r.parentElement)==null||i.classList.remove("hidden"),r.textContent=e.attackSpeed.toFixed(2),(c=n.parentElement)==null||c.classList.remove("hidden"),n.textContent=e.baseDamageMultiplier.toFixed(0)+"%"):e instanceof hn&&((f=a.parentElement)==null||f.classList.remove("hidden"),a.textContent=`${e.baseDuration.toFixed()}s`);let s=[];for(let y of e.mods){let p=document.createElement("div");p.classList.add("g-mod-desc"),p.textContent=y.desc,s.push(p)}O("[data-mod-list]",this.skillInfoContainer).replaceChildren(...s)}apply(){!this.selectedSkill||!this.skillSlot||(this.skillSlot.set(this.selectedSkill),this.close())}remove(){!this.skillSlot||(this.skillSlot.set(void 0),this.close())}cancel(){this.close()}close(){this.modalElement.classList.add("hidden")}};var al=new Ia,Da=class{constructor(){P(this,"element");P(this,"_skill");this.element=this.createElement()}get skill(){return this._skill}set(e){this._skill=e;let r=(e==null?void 0:e.name)||"[Empty]";this.element.setAttribute("data-skill-name",r),O("[data-label]",this.element).textContent=r}},Ra=class extends Da{constructor(r){super();P(this,"skillSlotContainer",O(".p-game .s-player .s-skills [data-attack-skill]"));P(this,"skills");this.skillSlotContainer.appendChild(this.element),this.skills=r}set(r){var n;super.set(r),(n=this._skill)==null||n.enable()}edit(){al.open({canRemove:!1,skills:this.skills,skillSlot:this})}createElement(){let r=document.createElement("div");return r.classList.add("g-field"),r.setAttribute("data-skill-slot","attack-skill"),r.insertAdjacentHTML("beforeend","<div data-label></div>"),r.insertAdjacentHTML("beforeend",'<button class="g-button" data-edit>Edit</button>'),r.querySelector("button[data-edit]").addEventListener("click",()=>this.edit()),r}},vn=class extends Da{constructor(r){super();P(this,"buffSkillList",O(".p-game .s-player .s-skills ul[data-buff-skill-list]"));P(this,"progressBar");P(this,"skills");P(this,"running",!1);this.buffSkillList.appendChild(this.element),this.progressBar=O("[data-progress-bar]",this.element),this.skills=r,this.set(void 0)}trigger(){!this._skill||this.running||!(q.curMana.get()>=this._skill.manaCost)||(q.curMana.subtract(this._skill.manaCost),this.start())}start(){if(!this._skill)return;let r=()=>{var p;return((p=this._skill)==null?void 0:p.baseDuration)||0*q.skillDurationMultiplier.get()},n=r(),a=100,s=n,i=-1,c=()=>{s=r(),n=s*(a/100)};q.skillDurationMultiplier.addListener("change",c),Pe.add(this._skill.mods.flatMap(p=>p.stats),this._skill.sourceName);let f=()=>{i=Re.subscribe(p=>{if(n<=0){Re.unsubscribe(i),y();return}n-=p,a=Math.max(0,n/s*100),this.progressBar.style.width=`${a}%`})},y=()=>{q.skillDurationMultiplier.removeListener("change",c),this._skill&&Pe.removeBySource(this._skill.sourceName),this.running=!1,this.progressBar.style.width="0%"};f(),this.running=!0}edit(){al.open({canRemove:!0,skills:this.skills,skillSlot:this})}createElement(){let r=document.createElement("li");return r.classList.add("g-field"),r.setAttribute("data-skill-slot","buff-skill"),r.insertAdjacentHTML("beforeend",`
        <div class="wrapper">
            <div data-progress-bar></div>
            <div class="g-button" data-label></div>
        </div>`),r.insertAdjacentHTML("beforeend",'<button class="g-button" data-edit>Edit</button>'),O("[data-edit]",r).addEventListener("click",()=>this.edit()),O("[data-label]",r).addEventListener("click",()=>this.trigger()),r}};var Or,gn,Na,yn,Md=document.querySelector(".p-game .s-player .s-skills [data-attack-skill]"),Td=document.querySelector(".p-game .s-player .s-skills ul[data-buff-skill-list]");function sl(t){if(Or=[],gn=[],yn=[],Md.replaceChildren(),Td.replaceChildren(),t.attackSkills.skillList.sort((e,r)=>e.levelReq-r.levelReq),t.attackSkills.skillList[0].levelReq>1)throw Error("There must be an attack skill with a level requirement of 1");if(Or=t.attackSkills.skillList.map(e=>new Lr(e)),Na=new Ra(Or),Na.set(Or[0]),t.buffSkills){gn=t.buffSkills.skillList.map(e=>new hn(e));for(let e of t.buffSkills.skillSlots){if(e.levelReq<=1){yn.push(new vn(gn));continue}let r=n=>{n<e.levelReq||(yn.push(new vn(gn)),q.level.removeListener("change",r))};q.level.addListener("change",r)}}}function il(t){var e;t.skills={attackSkillName:((e=Na.skill)==null?void 0:e.name)||"invalid name",buffSkillNames:yn.map(r=>{var n;return((n=r.skill)==null?void 0:n.name)||""}).filter(r=>(r==null?void 0:r.length)>0)}}function ol(t){let e=Or.find(r=>{var n;return r.name===((n=t.skills)==null?void 0:n.attackSkillName)});Na.set(e||Or[0]),yn.forEach((r,n)=>r==null?void 0:r.set(gn.find(a=>{var s,i;return a.name===((i=(s=t.skills)==null?void 0:s.buffSkillNames)==null?void 0:i[n])})))}var Aa=class{constructor(e){P(this,"name");P(this,"levelReq");P(this,"manaCost");P(this,"mods");var r;this.name=e.name,this.levelReq=e.levelReq,this.manaCost=e.manaCost,this.mods=((r=e.mods)==null?void 0:r.map(n=>new Ye(n)))||[]}get sourceName(){return`Skill/${this.name}`}},La=class extends Aa{constructor(r){super(r);P(this,"attackSpeed");P(this,"baseDamageMultiplier");this.attackSpeed=r.attackSpeed,this.baseDamageMultiplier=r.baseDamageMultiplier}enable(){var r;Pe.removeBySource((r=La.active)==null?void 0:r.sourceName),La.active=this,Pe.add([new hr({name:"BaseDamageMultiplier",valueType:"Base",value:this.baseDamageMultiplier})],this.sourceName),Pe.add([new hr({name:"AttackSpeed",valueType:"Base",value:this.attackSpeed})],this.sourceName),Pe.add([new hr({name:"AttackManaCost",valueType:"Base",value:this.manaCost})],this.sourceName),this.mods.forEach(n=>Pe.add(n.stats,this.sourceName))}},Lr=La;P(Lr,"active");var hn=class extends Aa{constructor(r){super(r);P(this,"baseDuration");this.baseDuration=r.baseDuration}};var bn=class{constructor(){P(this,"running",!1);P(this,"instances",new Map);P(this,"animInstances",new Map);P(this,"loopId",0);P(this,"animLoopId",0);P(this,"counter",0);P(this,"animCounter",0)}subscribe(e,r){let n=this.counter++,a={callback:e,time:0,id:n,options:r};return this.instances.set(n,a),n}subscribeAnim(e){let r=this.animCounter++,n={callback:e,id:r};return this.animInstances.set(r,n),r}unsubscribe(e){this.instances.delete(e)}unsubscribeAnim(e){this.animInstances.delete(e)}reset(){this.instances.clear(),this.running=!1}start(){this.running||(this.running=!0,this.beginLoop(),this.beginAnimationLoop())}stop(){this.running=!1,clearTimeout(this.loopId),cancelAnimationFrame(this.animLoopId||0)}beginLoop(){let e=0,r=performance.now(),n=()=>{clearTimeout(this.loopId),this.loopId=window.setTimeout(()=>{let a=performance.now()-r+e;for(r=performance.now();a>=40;)a-=40,this.instances.forEach(s=>{var c;s.time+=40;let i=((c=s.options)==null?void 0:c.intervalMilliseconds)||0;s.time>i&&(s.callback(.04),s.time-=i||s.time)});e=a,n()},40)};n()}beginAnimationLoop(){let e=performance.now(),r=()=>{let n=performance.now()-e;e=performance.now();let a=n/1e3;for(let s of this.animInstances.values())s.callback(a);this.animLoopId=requestAnimationFrame(r)};this.animLoopId=requestAnimationFrame(r)}};var ll="Passives",Gs=O('.p-game > menu [data-tab-target="passives"]'),Oa=O(".p-game .p-passives"),Pd=O("[data-passives-list]",Oa),kd=O("header [data-cur-points]",Oa),Id=O("header [data-max-points]",Oa),Dd=O("header [data-clear]",Oa);Dd.addEventListener("click",()=>Nd());var cl=()=>zs*(q.level.get()-1),Rd=()=>at.filter(t=>t.assigned).reduce((t,e)=>t+=e.points,0),at,zs;function ul(t){if(!!t){at=[],zs=1;for(let e of t.passiveList){let r=new Ks(e);at.push(r)}if(Pd.replaceChildren(...at.map(e=>e.element)),_n(),t.levelReq>1){let e=r=>{r>=t.levelReq&&(Gs.classList.remove("hidden"),q.level.removeListener("change",e))};q.level.addListener("change",e)}q.level.addListener("add",e=>{at.forEach(n=>n.tryUnlock()),Math.floor(cl()-(zs*e-2))>0&&Ke(Gs,"click"),_n()})}}function Nd(){at.filter(t=>t.assigned).forEach(t=>t.unassign()),_n()}function _n(){let t=cl(),e=Rd(),r=t-e;Id.textContent=t.toFixed(),kd.textContent=e.toFixed();for(let n of at)n.assigned||n.element.toggleAttribute("disabled",n.points>r),n.element.classList.toggle("selected",n.assigned)}function dl(t){t.passives={list:at.filter(e=>e.assigned).map(e=>({index:at.indexOf(e),desc:e.mod.desc}))}}function fl(t){let e=t.passives;if(!e){at.forEach(n=>n.unassign());return}e.list.every(n=>at[n.index].mod.desc===n.desc)&&(e.list.forEach(n=>{at[n.index].assign()}),_n())}var Ks=class{constructor(e){P(this,"levelReq");P(this,"points");P(this,"mod");P(this,"element");P(this,"_assigned");P(this,"locked");this.levelReq=e.levelReq,this.points=e.points,this.mod=new Ye(e.mod),this.element=this.createElement(),this.locked=this.levelReq>1,this.element.classList.toggle("hidden",this.locked),this._assigned=!1}get assigned(){return this._assigned}tryUnlock(){!this.locked||q.level.get()<this.levelReq||(this.locked=!1,this.element.classList.remove("hidden"),Ke(Gs,"click"),Ke(this.element,"mouseover"))}assign(){this._assigned=!0,Pe.add(this.mod.copy().stats,ll.concat("/",at.indexOf(this).toFixed()))}unassign(){this._assigned=!1,Pe.removeBySource(ll.concat("/",at.indexOf(this).toFixed()))}toggle(){this._assigned?this.unassign():this.assign()}createElement(){let e=document.createElement("li");return e.classList.add("g-list-item","g-field"),e.insertAdjacentHTML("beforeend",`<div>${this.mod.desc}</div>`),e.insertAdjacentHTML("beforeend",`<var>${this.points}</var>`),e.addEventListener("click",()=>{this.toggle(),_n()}),e}};var qr={reforge:{desc:"Reforge the item with new random modifiers",validate:t=>new Oe().modsIsNotEmpty(t.modTables.general),getItemMods:t=>new xe().addMultiple(t.modTables.general,xr(0)).modList},reforgeIncludePhysical:{desc:"Reforge the item with new random modifiers, including a [physical] modifier",validate:t=>new Oe().modsIsNotEmpty(t.modTables.general).modsContainsTag(t.modTables.general,"Physical"),getItemMods:t=>new xe().addOneByTag(t.modTables.general,"Physical").addMultiple(t.modTables.general,xr(1)).modList},reforgeIncludeMana:{desc:"Reforge the item with new random modifiers, including a [mana] modifier",validate:t=>new Oe().modsIsNotEmpty(t.modTables.general).modsContainsTag(t.modTables.general,"Mana"),getItemMods:t=>new xe().addOneByTag(t.modTables.general,"Mana").addMultiple(t.modTables.general,xr(1)).modList},reforgeIncludeCritical:{desc:"Reforge the item with new random modifiers, including a [critical] modifier",validate:t=>new Oe().modsIsNotEmpty(t.modTables.general).modsContainsTag(t.modTables.general,"Critical"),getItemMods:t=>new xe().addOneByTag(t.modTables.general,"Critical").addMultiple(t.modTables.general,xr(1)).modList},reforgeHigherChanceSameMods:{desc:"Reforge the item with a higher chance of receiving the same modifiers",validate:t=>new Oe().itemHasModifiers(t.itemModList).modsIsNotEmpty(t.modTables.general),getItemMods:t=>{let e=[...t.modTables.general].map(r=>r.copy()).reduce((r,n)=>(t.itemModList.some(a=>a===n)&&(n.weight*=20),r.push(n),r),[]);return new xe().addMultiple(e,xr(0)).modList}},reforgeLowerChanceSameMods:{desc:"Reforge the item with a lower chance of receiving the same modifiers",validate:t=>new Oe().itemHasModifiers(t.itemModList).modsIsNotEmpty(t.modTables.general),getItemMods:t=>{let e=[...t.modTables.general].map(r=>r.copy()).reduce((r,n)=>(t.itemModList.some(a=>a===n)&&(n.weight*=.02),r.push(n),r),[]);return new xe().addMultiple(e,xr(0)).modList}},addRandom:{desc:"Add a random modifier",validate:t=>new Oe().itemHasSpaceForMods(t.itemModList).modsIsNotEmpty(t.modTables.general),getItemMods:t=>new xe(t.itemModList).addOne(t.modTables.general).modList},addPhysical:{desc:"Add a [physical] modifier",validate:t=>new Oe().modsIsNotEmpty(t.modTables.general).itemHasSpaceForMods(t.itemModList).itemCanCraftModWithTag(t.itemModList,t.modTables.general,"Physical"),getItemMods:t=>new xe(t.itemModList).addOneByTag(t.modTables.general,"Physical").modList},addMana:{desc:"Add a [mana] modifier",validate:t=>new Oe().modsIsNotEmpty(t.modTables.general).itemHasSpaceForMods(t.itemModList).itemCanCraftModWithTag(t.itemModList,t.modTables.general,"Mana"),getItemMods:t=>new xe(t.itemModList).addOneByTag(t.modTables.general,"Mana").modList},addCritical:{desc:"Add a [critical] modifier",validate:t=>new Oe().modsIsNotEmpty(t.modTables.general).itemHasSpaceForMods(t.itemModList).itemCanCraftModWithTag(t.itemModList,t.modTables.general,"Critical"),getItemMods:t=>new xe(t.itemModList).addOneByTag(t.modTables.general,"Critical").modList},removeRandom:{desc:"Remove a random modifier",validate:t=>new Oe().itemHasModifiers(t.itemModList),getItemMods:t=>new xe(t.itemModList).removeRandom().modList},removeRandomAddRandom:{desc:"Remove a random modifier and add a new random modifier",validate:t=>new Oe().itemHasModifiers(t.itemModList).modsIsNotEmpty(t.modTables.general),getItemMods:t=>new xe(t.itemModList).removeRandom().addOne(t.modTables.general).modList},removeRandomAddPhysical:{desc:"Remove a random modifier and add a new [physical] modifier",validate:t=>new Oe().itemHasModifiers(t.itemModList).modsContainsTag(t.modTables.general,"Physical").itemCanCraftModWithTag(t.itemModList,t.modTables.general,"Physical"),getItemMods:t=>new xe(t.itemModList).removeRandom().addOneByTag(t.modTables.general,"Physical").modList},removeRandomAddMana:{desc:"Remove a random modifier and add a new [mana] modifier",validate:t=>new Oe().itemHasModifiers(t.itemModList).modsContainsTag(t.modTables.general,"Mana").itemCanCraftModWithTag(t.itemModList,t.modTables.general,"Mana"),getItemMods:t=>new xe(t.itemModList).removeRandom().addOneByTag(t.modTables.general,"Mana").modList},removeRandomAddCritical:{desc:"Remove a random modifier and add a new [critical] modifier",validate:t=>new Oe().itemHasModifiers(t.itemModList).modsContainsTag(t.modTables.general,"Critical").itemCanCraftModWithTag(t.itemModList,t.modTables.general,"Critical"),getItemMods:t=>new xe(t.itemModList).removeRandom().addOneByTag(t.modTables.general,"Critical").modList}},Oe=class{constructor(){P(this,"errors",[]);this.errors=[]}itemHasSpaceForMods(e){return e.length>=6&&this.errors.push("Item cannot have any more modifiers"),this}itemHasModifiers(e){return e.length===0&&this.errors.push("Item has no modifiers"),this}itemCanCraftModWithTag(e,r,n){return r.filter(s=>{var i;return((i=s.tags)==null?void 0:i.includes(n))&&!e.some(c=>c.compare(s))}).length===0&&this.errors.push(`There are no ${n} modifiers available`),this}modsIsNotEmpty(e){return e.length===0&&this.errors.push("No modifiers available"),this}modsContainsTag(e,r){return e.some(n=>{var a;return(a=n.tags)==null?void 0:a.includes(r)})||this.errors.push(`No modifier was available with the tag: ${r}`),this}},xe=class{constructor(e=[]){P(this,"modList");this.modList=[...e]}addOne(e){return this.modList.push(...this.generateMods(e,this.modList,1)),this}addOneByTag(e,r){return e=e.filter(n=>{var a;return(a=n.tags)==null?void 0:a.includes(r)}),this.modList.push(...this.generateMods(e,this.modList,1)),this}addMultiple(e,r){return this.modList.push(...this.generateMods(e,this.modList,r)),this}removeRandom(){let e=this.randomRangeInt(0,this.modList.length);return this.modList.splice(e,1),this}generateMods(e,r=[],n){let a=[];for(let s=0;s<n;s++){let i=[...a,...r];e=e.filter(y=>!i.some(p=>y.templateDesc===p.templateDesc));let c=e.reduce((y,p)=>y+=p.weight,0),f=Math.random()*c;for(let y of e)if(c-=y.weight,c<=f){let p=y.copy();p.stats.forEach(E=>E.randomizeValue()),a.push(p);break}}return a}randomRangeInt(e,r){return Math.floor(Math.random()*(r-e)+e)}},xr=(t=0)=>{let e=[0,0,40,50,30,20].slice(t,6),r=e.reduce((a,s)=>a+s),n=Math.random()*r;for(let a=0;a<e.length;a++)if(r-=e[a],r<=n)return a+1;throw Error()};var Fr=O(".p-game .p-items"),ml=O("menu[data-item-list]",Fr),Ad=O("ul[data-mod-list]",Fr),Ys=O(".s-preset-container",Fr),Ld=O("[data-new]",Ys),pl=O("[data-edit]",Ys),Ws=O("[data-preset-list]",Ys),st=O("[data-craft-preset-modal]",Fr),Od=O("[data-craft-list]",st),jr=O(".s-craft-container",Fr),xd=O("button[data-craft-button]",jr),En=O('.p-game > menu [data-tab-target="items"]');Ld.addEventListener("click",()=>{gl("New Preset",[]).edit()});pl.addEventListener("click",()=>{var t;return(t=ht.active)==null?void 0:t.edit()});O('footer [data-value="apply"]',st).addEventListener("click",()=>{var t;return(t=ht.active)==null?void 0:t.apply()});O('footer [data-value="delete"]',st).addEventListener("click",()=>{var t;return(t=ht.active)==null?void 0:t.delete()});O('footer [data-value="apply"]',st).addEventListener("click",()=>{st.classList.add("hidden")});O('footer [data-value="delete"]',st).addEventListener("click",()=>{st.classList.add("hidden")});O('footer [data-value="cancel"]',st).addEventListener("click",()=>{st.classList.add("hidden")});xd.addEventListener("click",()=>Hd());Ct(Fr,()=>{gr()});var hl=()=>zt.filter(t=>t.levelReq<=q.level.get()).map(t=>t.id),xa,yr,zt,qt;function vl(t){if(xa=[],yr=[],zt=[],qt==null||qt.forEach(e=>e.delete()),qt=[],!!t){for(let e of t.modTables.general)for(let r=0;r<e.length;r++){let n=e[r];xa.push(new $n(n,e))}if(qd(t.itemList),jd(t.craftList),gl("All",Object.keys(qr),!0),Fd(),yr[0].element.click(),q.level.addListener("add",e=>zt.forEach(r=>r.tryUnlock(e))),q.gold.addListener("change",()=>{gr(),Js()}),t.levelReq>1){let e=r=>{t.levelReq<=r&&(q.level.removeListener("change",e),En.classList.remove("hidden"),Ke(En,"mouseover"))};q.level.addListener("change",e)}else En.classList.remove("hidden")}}function qd(t){for(let e of t){let r=new jt(e);if(yr.push(r),r.levelReq<=1){r.element.classList.remove("hidden");continue}let n=a=>{e.levelReq<=a&&(r.element.classList.remove("hidden"),Ke(En,"click"),Ke(r.element,"mouseover"),q.level.removeListener("add",n))};q.level.addListener("add",n)}ml.replaceChildren(...yr.map(e=>e.element))}function jd(t){var e;for(let r of t){let n=new Kt(r);zt.push(n),n.element.addEventListener("click",()=>{zt.map(a=>a.element).forEach(a=>{a.classList.toggle("selected",a===n.element)}),n.select(),Js()})}O("[data-craft-list]",jr).replaceChildren(...zt.map(r=>r.element)),(e=zt.find(r=>!r.locked))==null||e.select()}function gl(t,e,r=!1){let n=new ht(t,e,r);return Ws.appendChild(n.element),n.select(),n}function Fd(){let t=zt.map(e=>e.element.cloneNode(!0));t.forEach(e=>{e.addEventListener("click",()=>{e.classList.toggle("selected",!e.classList.contains("selected"))})}),Od.replaceChildren(...t)}function yl(){var t;if((t=jt.active)!=null&&t.mods){let e=[];for(let r of jt.active.mods.sort(Ye.sort)){let n=r.desc,a=document.createElement("li");a.classList.add("g-mod-desc"),a.textContent=n,e.push(a)}Ad.replaceChildren(...e)}}function gr(){var n;if(!ht.active)return;let t=hl(),e=ht.active.ids.filter(a=>t.includes(a));zt.forEach(a=>{let s=a.cost<=q.gold.get(),i=O("[data-cost]",a.element);i==null||i.toggleAttribute("data-insufficient-cost",!s),a.element.classList.toggle("hidden",a.locked||!e.includes(a.id))}),jr.querySelector("[data-craft-id].selected:not(.hidden)")||(n=jr.querySelector("[data-craft-id]:not(.hidden)"))==null||n.click()}function bl(){return{itemModList:jt.active.mods,modTables:{general:xa.filter(t=>t.levelReq<=q.level.get())}}}function Js(){if(!jt.active)return;let t="",e=qr[Kt.active.id];if(!e){console.error("invalid craft id");return}q.gold.get()<Kt.active.cost&&(t="You cannot afford this craft");let r=bl(),n=e.validate(r);n.errors.length>0&&(t=n.errors[0]),O("[data-craft-message]",jr).textContent=t,O("[data-craft-button]",jr).toggleAttribute("disabled",t.length>0)}function Hd(){if(!jt.active||!qr[Kt.active.id])return;let t=qr[Kt.active.id],e=bl();jt.active.mods=t.getItemMods(e),q.gold.subtract(Kt.active.cost),yl(),gr()}var Qs=class{constructor({name:e,levelReq:r}){P(this,"name");P(this,"levelReq");P(this,"element");P(this,"sourceName");P(this,"_mods");this.name=e,this.levelReq=r,this._mods=[],this.element=this.createElement(),this.sourceName=`Skills/${e}`}get mods(){return this._mods}set mods(e){Pe.removeBySource(this.sourceName),this._mods=e,Pe.add(this.mods.flatMap(r=>r.stats),this.sourceName)}createElement(){let e=document.createElement("li");return e.classList.add("g-list-item","hidden"),e.textContent=this.name,e.addEventListener("click",()=>{Qs.active=this,ml.querySelectorAll("li").forEach(r=>{r.classList.toggle("selected",r===e)}),yl(),Js()}),e}},jt=Qs;P(jt,"active");var $n=class extends Ye{constructor(r,n){super(r.mod);P(this,"itemModData");P(this,"levelReq");P(this,"weight");P(this,"groupIndex");P(this,"modGroup");this.itemModData=r,this.levelReq=r.levelReq,this.weight=r.weight,this.groupIndex=n.findIndex(a=>a===r),this.modGroup=n}get tier(){let r=this.modGroup.filter(n=>n.levelReq<=q.level.get()).length-1;return Math.max(1,r-this.groupIndex)}copy(){return new $n(this.itemModData,this.modGroup)}},Xs=class{constructor(e){P(this,"id");P(this,"levelReq");P(this,"cost");P(this,"element");P(this,"_locked",!0);this.id=e.id,this.levelReq=e.levelReq,this.cost=e.cost,this.element=this.createElement(),this._locked=this.levelReq>1}get locked(){return this._locked}tryUnlock(e){this.locked&&e>=this.levelReq&&(Ke(En,"click"),Ke(ht.default.element,"click"),Ke(this.element,"mouseover"),gr(),this._locked=!1)}select(){Xs.active=this,this.element.click()}createElement(){let e=document.createElement("li");e.classList.add("g-field","g-list-item","hidden");let r=qr[this.id].desc.replace(/\[\w+\]/g,n=>`<span>${n.substring(1,n.length-1)}</span>`);return e.insertAdjacentHTML("beforeend",`<div>${r}</div>`),e.insertAdjacentHTML("beforeend",`<i data-cost="${this.cost}">${this.cost}</i>`),e.setAttribute("data-craft-id",this.id),e}},Kt=Xs;P(Kt,"active");var vr=class{constructor(e,r=[],n=!1){P(this,"name");P(this,"ids");P(this,"element");this.name=e,this.ids=[...r],n&&(vr.default=this),this.element=this.createElement(),this.setName(this.name),qt.push(this)}get isDefault(){return vr.default===this}static create(){return new vr("New Preset",[])}select(){this.element.click()}setName(e){this.name=e.replace(/[^A-Za-z 0-9]/g,""),this.element.textContent=this.name}edit(){this.openModal()}delete(){var e,r;vr.active=null,this.element.previousElementSibling?(e=this.element.previousElementSibling)==null||e.click():(r=this.element.nextElementSibling)==null||r.click(),this.element.remove(),qt=qt.filter(n=>n!==this),gr()}apply(){let e=O("input[data-name]",st).value;this.setName(e);let r=st.querySelectorAll("[data-craft-list] [data-craft-id].selected");this.ids=Array.from(r).map(n=>n.getAttribute("data-craft-id")),gr()}createElement(){let e=document.createElement("li");return e.classList.add("g-list-item","preset"),e.addEventListener("click",()=>{vr.active=this,Ws.querySelectorAll("li").forEach(r=>{r.classList.toggle("selected",r===e)}),pl.toggleAttribute("disabled",this.isDefault),gr()}),Ws.appendChild(e),e}openModal(){st.querySelector("input[data-name]").value=this.name;let e=hl();st.querySelectorAll("[data-craft-list] [data-craft-id]").forEach(r=>{let n=r.getAttribute("data-craft-id"),a=!e.includes(n);r.classList.toggle("hidden",a);let s=!a&&this.ids.includes(n);r.classList.toggle("selected",s)}),st.classList.remove("hidden")}},ht=vr;P(ht,"active"),P(ht,"default");function _l(t){let e=r=>r.mods.map(n=>({desc:n.templateDesc,values:n.stats.map(a=>a.value)}));t.items={items:yr.map(r=>({name:r.name,modList:e(r)})),craftPresets:qt.filter(r=>!r.isDefault).map(r=>({name:r.name,ids:r.ids}))}}function El(t){var e,r,n;if(!!t.items){qt.filter(a=>!a.isDefault).forEach(a=>a.delete());for(let a of t.items.items){if(!yr.find(c=>c.name===a.name)){console.warn("Could not load Item with name: ",a.name);continue}let i=[];for(let c of a.modList){let f=(e=xa.find(p=>c.desc===p.templateDesc))==null?void 0:e.copy();!f||!f.setStatValues(c.values)||i.push(f)}}for(let a of t.items.craftPresets)new ht(a.name,a.ids);(r=qt[0])==null||r.select(),(n=yr[0])==null||n.element.click()}}var Vd=[[/^Reach Level {(\d+)}$/,()=>q.level.get().toFixed()],[/^Prestige {\d+}?$/,()=>Le["Prestige Count"].get().toFixed()],[/^Deal Damage {(\d+)}$/,()=>Le["Total Damage"].get().toFixed()],[/^Deal Physical Damage {(\d+)}$/,()=>Le["Total Physical Damage"].get().toFixed()],[/^Perform Hits {(\d+)}$/,()=>Le.Hits.get().toFixed()],[/^Perform Critical Hits {(\d+)}$/,()=>Le["Critical Hits"].get().toFixed()],[/^Generate Gold {(\d+)}$/,()=>Le["Gold Generated"].get().toFixed()],[/^Regenerate Mana {(\d+)}$/,()=>Le["Mana Generated"].get().toFixed()]],Zs=document.querySelector('.p-game > menu [data-tab-target="achievements"]'),Hr=[],$l=-1;Ct(document.querySelector(".p-game .p-achievements"),Ud);function Sl(t){Hr.splice(0);for(let e of t.list)Hr.push(new ei(e));if(document.querySelector(".p-achievements ul").replaceChildren(...Hr.map(e=>e.element)),Re.subscribe(()=>{Bd()},{intervalMilliseconds:1e3}),t.levelReq>1){let e=r=>{r>=t.levelReq&&(q.level.removeListener("add",e),Zs.classList.remove("hidden"),Ke(Zs,"click"))};q.level.addListener("add",e)}}function Bd(){Hr.forEach(t=>{t.validate()&&t.complete()})}function Ud(t){t?(Hr.forEach(e=>e.updateDescription()),$l=Re.subscribe(()=>Hr.forEach(e=>e.updateDescription()),{intervalMilliseconds:1e3})):Re.unsubscribe($l)}var ei=class{constructor(e){P(this,"completed",!1);P(this,"validator");P(this,"matchIndex");P(this,"targetValue");P(this,"description");P(this,"modList");P(this,"element");var a;this.description=e.description.replace(/[{}]/g,""),this.modList=[...(e==null?void 0:e.modList)||[]];let r=Vd.find(s=>s[0].exec(e.description));if(!r)throw Error("no achievement validator found");this.validator=r;let n=r[0].exec(e.description);this.targetValue=Number(n[1]),this.matchIndex=(a=e.description.match(/{\d+}/))==null?void 0:a.index,this.element=this.createElement()}updateDescription(){this.completed||(this.element.querySelector("[data-cur-value]").textContent=this.validator[1]())}validate(){if(this.completed)return;let e=Number(this.validator[1]()),r=!1;return this.validator[2]?r=this.validator[2](e,this.targetValue):r=e>=this.targetValue,r}complete(){this.completed=!0,this.applyModifiers(),this.removeCurValueFromDesc(),this.element.querySelector("var").toggleAttribute("data-valid",this.completed),Ke(Zs,"click"),Ke(this.element,"mouseover")}applyModifiers(){let e=this.modList.map(r=>new Ye(r));Pe.add(e.flatMap(r=>r.stats),"Achievement/"+this.description)}removeCurValueFromDesc(){let e=this.element.querySelector("var"),r=e.innerHTML,n=r.indexOf("</span>");e.innerHTML=r.substring(n+8)}createElement(){let e=document.createElement("li");e.classList.add("g-accordion");let r=document.createElement("div");if(e.appendChild(r),r.classList.add("header"),r.insertAdjacentHTML("beforeend",`<div>${this.description.substring(0,this.matchIndex)}<var><span data-cur-value>${this.validator[1]()}</span>/${this.targetValue.toString()}</var>${this.description.substring(this.matchIndex+this.targetValue.toString().length)}</div>`),this.modList.length>0){let n=document.createElement("div");e.appendChild(n),n.classList.add("content");for(let a of this.modList)n.insertAdjacentHTML("beforeend",`<div class="g-mod-desc">${a.replace(/[{}]/g,"")}</div>`);r.insertAdjacentHTML("beforeend","<i></i>"),r.addEventListener("click",()=>{r.toggleAttribute("data-open")})}return e}};var Gd=["passives","items","achievements"];function wl(t){let e=Object.fromEntries(Object.entries(t).filter(([r])=>t[r]&&Gd.includes(r)));for(let r of Object.keys(e))if(!!e[r])switch(r){case"passives":ul(e.passives);break;case"items":vl(e.items);break;case"achievements":Sl(e.achievements);break}}function Cl(t){dl(t),_l(t)}function Ml(t){fl(t),El(t)}async function Tl(){let t=await pn.load("Game");return t?new Map(Object.entries(t)):new Map}async function Pl(t){let e=await Tl(),r=e.get(t.id)||{meta:Object.assign({},t)};return[rl,Yo,il,Cl].forEach(n=>n(r)),e.set(t.id,r),pn.save("Game",Object.fromEntries(e)),!0}async function ti(t){let e=t.meta.id,n=(await Tl()).get(e);return n?(t.meta=ce(ce({},t.meta),n.meta),[nl,Jo,ol,Ml].forEach(a=>a(n)),ka(),!0):(console.log("could not load",e),!1)}var kl=O(".p-game");ya(O(":scope > menu",kl),O(".s-middle",kl),ba);envVariables.env!=="production"&&(Object.defineProperty(window,"TS",{value:{setLevel:t=>q.level.set(t),setGold:t=>q.level.set(t),save:()=>{Sn&&Pl(Sn.meta)},load:()=>{Sn&&ti(Sn)}}}),document.addEventListener("keydown",t=>{t.code==="Space"&&(Re.running?(document.title="Tinkerers Subject (Stopped)",Re.stop()):(Re.start(),document.title="Tinkerers Subject (Running)"))}));var Re=new bn,Sn;async function qa(t){Sn=t,Re.reset(),Hs(t.enemies),tl(t.player),sl(t.skills),wl(t),Re.subscribe(()=>{Le["Time Played"].add(1)},{intervalMilliseconds:1e3}),await ka(),Zo(),envVariables.env==="production"&&Re.start(),await ti(t)}var Yu=jo(Ku(),1);var Wu={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["skills","enemies"],properties:{meta:{type:"object",description:"Internal properties not used within the game",properties:{description:{type:"string",description:"A short text used at the home screen when a user selects the configuration",maxLength:240,pattern:"^[A-Za-z0-9 \\.]*$"}}},enemies:{type:"object",required:["enemyList"],properties:{enemyList:{type:"array",minItems:1,items:{type:"integer",minimum:1}}}},player:{type:"object",properties:{modList:{type:"array",items:{$ref:"#/definitions/mod"}}}},skills:{type:"object",required:["attackSkills"],properties:{attackSkills:{type:"object",required:["skillList"],properties:{skillList:{type:"array",minItems:1,items:{type:"object",required:["name","attackSpeed","manaCost","baseDamageMultiplier","levelReq"],properties:{name:{type:"string"},levelReq:{type:"integer",minimum:1,default:1,description:`Required player level
Note - At least one skill must have a value of 1`},attackSpeed:{type:"number",minimum:.001,maximum:10,default:1,description:"Number of attacks per second"},manaCost:{type:"integer",minimum:0},baseDamageMultiplier:{type:"integer",minimum:1,default:100,description:"A multiplier used to balance the skill. A value of 100 is 100% of base damage."},mods:{type:"array",items:{$ref:"#/definitions/mod"}}}}}}},buffSkills:{type:"object",required:["skillList","skillSlots"],properties:{skillSlots:{type:"array",minItems:1,items:{type:"object",required:["levelReq"],properties:{levelReq:{type:"integer",minimum:1}}}},skillList:{type:"array",items:{type:"object",required:["name","baseDuration","manaCost","levelReq"],properties:{name:{type:"string"},levelReq:{type:"number"},baseDuration:{type:"integer"},manaCost:{type:"integer"},mods:{type:"array",items:{$ref:"#/definitions/mod"}}}}}}}}},passives:{type:"object",required:["levelReq","passiveList"],properties:{levelReq:{$ref:"#/definitions/levelReq"},passiveList:{type:"array",items:{type:"object",required:["levelReq","mod","points"],properties:{levelReq:{$ref:"#/definitions/levelReq"},mod:{$ref:"#/definitions/mod"},points:{type:"integer",minimum:1}}}}}},items:{type:"object",required:["itemList","craftList","modTables"],properties:{levelReq:{$ref:"#/definitions/levelReq"},itemList:{type:"array",items:{type:"object",properties:{name:{type:"string"},levelReq:{type:"integer",minimum:0}}}},craftList:{type:"array",minItems:1,items:{type:"object",required:["id","levelReq","cost"],properties:{id:{enum:["reforge","reforgeIncludePhysical","reforgeIncludeCritical","reforgeIncludeMana","reforgeHigherChanceSameMods","reforgeLowerChanceSameMods","addRandom","addPhysical","addCritical","addMana","removeRandom","removePhysical","removeCritical","removeMana","removeRandomAddPhysical","removeRandomAddCritical","removeRandomAddMana"]},levelReq:{type:"integer",minimum:0},cost:{type:"integer",minimum:0}}}},modTables:{type:"object",required:["general"],properties:{general:{type:"array",items:{type:"array",items:{type:"object",required:["weight","levelReq","mod"],properties:{weight:{type:"integer",minimum:0},levelReq:{type:"integer",minimum:0},mod:{$ref:"#/definitions/mod"}}}}}}}}},achievements:{type:"object",properties:{levelReq:{$ref:"#/definitions/levelReq"},list:{type:"array",items:{type:"object",required:["description"],properties:{description:{type:"string",anyOf:[{enum:["Reach Level {#}"]},{pattern:"^Reach Level \\{\\d+\\}$"},{enum:["Prestige {#}"]},{pattern:"^Prestige \\{\\d+?\\}$"},{enum:["Deal Damage {#}","Deal Physical Damage {#}"]},{pattern:"^Deal( Physical| Elemental)? Damage \\{\\d+\\}$"},{enum:["Generate Gold {#}"]},{pattern:"^Generate Gold \\{\\d+\\}$"},{enum:["Regenerate Mana {#}"]},{pattern:"^Regenerate Mana \\{\\d+\\}$"},{enum:["Perform Hits {#}"]},{pattern:"^Perform Hits \\{\\d+\\}$"},{enum:["Perform Critical Hits {#} Total Critical Hits"]},{pattern:"^Perform Critical Hits \\{\\d+\\}$"}]},modList:{type:"array",description:"Each mod will be applied upon completing the achievement",items:{$ref:"#/definitions/mod"}}}}}}},prestige:{type:"object",required:["goldMultiplier"],properties:{goldMultiplier:{type:"integer",default:20,description:"Each prestige will apply this multiplier to gold per second"}}}},definitions:{mod:{type:"string",oneOf:[{enum:["Adds {#} To {#} Physical Damage"]},{pattern:"^Adds \\{(\\d+(\\.\\d+)?)(-\\d+(\\.\\d+)?)?\\} To \\{(\\d+(\\.\\d+)?)(-\\d+(\\.\\d+)?)?\\} Physical Damage$"},{enum:["{#}% Increased Physical Damage"]},{pattern:"^\\{(\\d+(\\.\\d+)?)(-\\d+(\\.\\d+)?)?\\}% Increased Physical Damage$"},{enum:["{#}% More Physical Damage"]},{pattern:"^\\{(\\d+(\\.\\d+)?)(-\\d+(\\.\\d+)?)?\\}% More Physical Damage$"},{enum:["{#}% More Damage"]},{pattern:"^\\{(\\d+(\\.\\d+)?)(-\\d+(\\.\\d+)?)?\\}% More Damage$"},{enum:["+{#}% Hit Chance"]},{pattern:"^\\+\\{(\\d+(\\.\\d+)?)(-\\d+(\\.\\d+)?)?\\}% Hit Chance$"},{enum:["{#}% Increased Attack Speed"]},{pattern:"^\\{(\\d+(\\.\\d+)?)(-\\d+(\\.\\d+)?)?\\}% Increased Attack Speed$"},{enum:["{#}% More Attack Speed"]},{pattern:"^\\{(\\d+(\\.\\d+)?)(-\\d+(\\.\\d+)?)?\\}% More Attack Speed$"},{enum:["+{#}% Critical Hit Chance"]},{pattern:"^\\+\\{(\\d+(\\.\\d+)?)(-\\d+(\\.\\d+)?)?\\}% Critical Hit Chance$"},{enum:["+{#}% Critical Hit Multiplier"]},{pattern:"^\\+\\{(\\d+(\\.\\d+)?)(-\\d+(\\.\\d+)?)?\\}% Critical Hit Multiplier$"},{enum:["+{#} Maximum Mana"]},{pattern:"^\\+\\{(\\d+(\\.\\d+)?)(-\\d+(\\.\\d+)?)?\\} Maximum Mana$"},{enum:["{#}% Increased Maximum Mana"]},{pattern:"^\\{(\\d+(\\.\\d+)?)(-\\d+(\\.\\d+)?)?\\}% Increased Maximum Mana$"},{enum:["+{#} Mana Regeneration"]},{pattern:"^\\+\\{(\\d+(\\.\\d+)?)(-\\d+(\\.\\d+)?)?\\} Mana Regeneration$"},{enum:["+{#} Gold Per Second"]},{pattern:"^\\+\\{(\\d+(\\.\\d+)?)(-\\d+(\\.\\d+)?)?\\} Gold Per Second$"},{enum:["{#}% Increased Gold Per Second"]},{pattern:"^\\{(\\d+(\\.\\d+)?)(-\\d+(\\.\\d+)?)?\\}% Increased Gold Per Second$"}]},name:{type:"string",pattern:"^[A-Za-z 0-9]{3,16}$"},levelReq:{type:"integer",default:1,minimum:1}}};var gs=new Yu.default().compile(Wu);var Zu=O('[data-type="remote"]'),Hv=O('[data-type="local"]'),Ju=O("[data-config-list]"),ys=O("[data-config-info]"),Qu=O("[data-start]",ys),Xu=new Ea,Lo;[Zu,Hv].forEach((t,e,r)=>{t.addEventListener("click",async()=>{r.forEach(a=>a.classList.toggle("selected",a===t));let n=t.getAttribute("data-type");Uv(n)})});Ct(O(".p-home"),(t,e)=>{t&&(Zu.click(),e.disconnect())});async function Vv(t,e){if(e.meta=ce(ce({},e.meta),t),e.meta.id||(e.meta.id=crypto.randomUUID()),e.meta.startTimeMS||(e.meta.startTimeMS=Date.now()),!gs(e)){console.log("Configuration is not valid");return}await qa(e),O('body > header [data-tab-target="game"]').click()}async function Bv(t){let e=await Gv(t.url);if(!e){console.error("invalid url");return}O("[data-title]",ys).textContent=e.meta.name,O("[data-desc]",ys).textContent=e.meta.description||"",Qu.removeEventListener("click",Lo),Lo=()=>{Vv(t,e)},Qu.addEventListener("click",Lo)}async function Uv(t){let e=await Xu.getEntryListElements(t);if(ys.classList.toggle("hidden",e.length===0),e.length===0){let r="";switch(t){case"remote":r="Failed to load remote configurations";break;case"local":r="You do not have any saved games yet";break}Ju.textContent=r;return}for(let r of e)r.addEventListener("click",()=>{e.forEach(a=>a.classList.toggle("selected",a===r));let n=Xu.getActiveEntry();Bv(n)});Ju.replaceChildren(...e),e[0].click()}async function Gv(t){if(!Ds(t)){console.error("invalid url");return}try{return await(await fetch(t)).json()}catch(r){console.error(r)}}var en=O("body > header button"),zv=O(".p-home"),Kv=O(".p-game");ya(en.parentElement,document.body,ba);Ct(zv,t=>{t&&(en.textContent="Back",en.setAttribute("data-tab-target","game"))});Ct(Kv,t=>{t&&(en.textContent="Home",en.classList.remove("hidden"),en.setAttribute("data-tab-target","home"))});Wv();async function Wv(){globalThis.envVariables=await(await fetch("/public/env.json")).json(),envVariables.env==="dev-config"?await Yv():O(".p-home").classList.remove("hidden"),document.body.classList.remove("hidden")}async function Yv(){let t=envVariables.gConfigPath;try{let e=await fetch(t);if(e.status===404){document.body.textContent=`${e.url} | ${e.statusText}`;return}let r=await e.json();if(!gs(r)){document.body.textContent="Your configuration file is not valid";return}let a=(await _a()).find(s=>s.id==="temp");r.meta=nt(ce({},r.meta),{id:"temp"}),a&&(r.meta=ce(ce({},r.meta),a)),await qa(r),O('body > header [data-tab-target="game"]').click()}catch(e){console.error(e)}}})();
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */
//# sourceMappingURL=main.js.map

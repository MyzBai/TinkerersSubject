"use strict";(()=>{var Lu=Object.create;var Es=Object.defineProperty,xu=Object.defineProperties,qu=Object.getOwnPropertyDescriptor,ju=Object.getOwnPropertyDescriptors,Fu=Object.getOwnPropertyNames,Co=Object.getOwnPropertySymbols,Vu=Object.getPrototypeOf,To=Object.prototype.hasOwnProperty,Hu=Object.prototype.propertyIsEnumerable;var bs=(t,e,r)=>e in t?Es(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Pe=(t,e)=>{for(var r in e||(e={}))To.call(e,r)&&bs(t,r,e[r]);if(Co)for(var r of Co(e))Hu.call(e,r)&&bs(t,r,e[r]);return t},dt=(t,e)=>xu(t,ju(e));var mn=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var x=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Bu=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of Fu(e))!To.call(t,a)&&a!==r&&Es(t,a,{get:()=>e[a],enumerable:!(n=qu(e,a))||n.enumerable});return t};var Mo=(t,e,r)=>(r=t!=null?Lu(Vu(t)):{},Bu(e||!t||!t.__esModule?Es(r,"default",{value:t,enumerable:!0}):r,t));var k=(t,e,r)=>(bs(t,typeof e!="symbol"?e+"":e,r),r);var ml=x((fl,Vs)=>{(function(t){if(typeof fl=="object"&&typeof Vs<"u")Vs.exports=t();else if(typeof define=="function"&&define.amd)define([],t);else{var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e=this,e.localforage=t()}})(function(){var t,e,r;return function n(a,s,i){function c(h,E){if(!s[h]){if(!a[h]){var b=typeof mn=="function"&&mn;if(!E&&b)return b(h,!0);if(f)return f(h,!0);var $=new Error("Cannot find module '"+h+"'");throw $.code="MODULE_NOT_FOUND",$}var C=s[h]={exports:{}};a[h][0].call(C.exports,function(T){var N=a[h][1][T];return c(N||T)},C,C.exports,n,a,s,i)}return s[h].exports}for(var f=typeof mn=="function"&&mn,y=0;y<i.length;y++)c(i[y]);return c}({1:[function(n,a,s){(function(i){"use strict";var c=i.MutationObserver||i.WebKitMutationObserver,f;if(c){var y=0,h=new c(T),E=i.document.createTextNode("");h.observe(E,{characterData:!0}),f=function(){E.data=y=++y%2}}else if(!i.setImmediate&&typeof i.MessageChannel<"u"){var b=new i.MessageChannel;b.port1.onmessage=T,f=function(){b.port2.postMessage(0)}}else"document"in i&&"onreadystatechange"in i.document.createElement("script")?f=function(){var R=i.document.createElement("script");R.onreadystatechange=function(){T(),R.onreadystatechange=null,R.parentNode.removeChild(R),R=null},i.document.documentElement.appendChild(R)}:f=function(){setTimeout(T,0)};var $,C=[];function T(){$=!0;for(var R,U,F=C.length;F;){for(U=C,C=[],R=-1;++R<F;)U[R]();F=C.length}$=!1}a.exports=N;function N(R){C.push(R)===1&&!$&&f()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,a,s){"use strict";var i=n(1);function c(){}var f={},y=["REJECTED"],h=["FULFILLED"],E=["PENDING"];a.exports=b;function b(O){if(typeof O!="function")throw new TypeError("resolver must be a function");this.state=E,this.queue=[],this.outcome=void 0,O!==c&&N(this,O)}b.prototype.catch=function(O){return this.then(null,O)},b.prototype.then=function(O,J){if(typeof O!="function"&&this.state===h||typeof J!="function"&&this.state===y)return this;var z=new this.constructor(c);if(this.state!==E){var te=this.state===h?O:J;C(z,te,this.outcome)}else this.queue.push(new $(z,O,J));return z};function $(O,J,z){this.promise=O,typeof J=="function"&&(this.onFulfilled=J,this.callFulfilled=this.otherCallFulfilled),typeof z=="function"&&(this.onRejected=z,this.callRejected=this.otherCallRejected)}$.prototype.callFulfilled=function(O){f.resolve(this.promise,O)},$.prototype.otherCallFulfilled=function(O){C(this.promise,this.onFulfilled,O)},$.prototype.callRejected=function(O){f.reject(this.promise,O)},$.prototype.otherCallRejected=function(O){C(this.promise,this.onRejected,O)};function C(O,J,z){i(function(){var te;try{te=J(z)}catch(ae){return f.reject(O,ae)}te===O?f.reject(O,new TypeError("Cannot resolve promise with itself")):f.resolve(O,te)})}f.resolve=function(O,J){var z=R(T,J);if(z.status==="error")return f.reject(O,z.value);var te=z.value;if(te)N(O,te);else{O.state=h,O.outcome=J;for(var ae=-1,Me=O.queue.length;++ae<Me;)O.queue[ae].callFulfilled(J)}return O},f.reject=function(O,J){O.state=y,O.outcome=J;for(var z=-1,te=O.queue.length;++z<te;)O.queue[z].callRejected(J);return O};function T(O){var J=O&&O.then;if(O&&(typeof O=="object"||typeof O=="function")&&typeof J=="function")return function(){J.apply(O,arguments)}}function N(O,J){var z=!1;function te(Ae){z||(z=!0,f.reject(O,Ae))}function ae(Ae){z||(z=!0,f.resolve(O,Ae))}function Me(){J(ae,te)}var Se=R(Me);Se.status==="error"&&te(Se.value)}function R(O,J){var z={};try{z.value=O(J),z.status="success"}catch(te){z.status="error",z.value=te}return z}b.resolve=U;function U(O){return O instanceof this?O:f.resolve(new this(c),O)}b.reject=F;function F(O){var J=new this(c);return f.reject(J,O)}b.all=oe;function oe(O){var J=this;if(Object.prototype.toString.call(O)!=="[object Array]")return this.reject(new TypeError("must be an array"));var z=O.length,te=!1;if(!z)return this.resolve([]);for(var ae=new Array(z),Me=0,Se=-1,Ae=new this(c);++Se<z;)Ze(O[Se],Se);return Ae;function Ze(Jt,Mr){J.resolve(Jt).then(tn,function(Vt){te||(te=!0,f.reject(Ae,Vt))});function tn(Vt){ae[Mr]=Vt,++Me===z&&!te&&(te=!0,f.resolve(Ae,ae))}}}b.race=B;function B(O){var J=this;if(Object.prototype.toString.call(O)!=="[object Array]")return this.reject(new TypeError("must be an array"));var z=O.length,te=!1;if(!z)return this.resolve([]);for(var ae=-1,Me=new this(c);++ae<z;)Se(O[ae]);return Me;function Se(Ae){J.resolve(Ae).then(function(Ze){te||(te=!0,f.resolve(Me,Ze))},function(Ze){te||(te=!0,f.reject(Me,Ze))})}}},{1:1}],3:[function(n,a,s){(function(i){"use strict";typeof i.Promise!="function"&&(i.Promise=n(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,a,s){"use strict";var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o};function c(o,d){if(!(o instanceof d))throw new TypeError("Cannot call a class as a function")}function f(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch(o){return}}var y=f();function h(){try{if(!y||!y.open)return!1;var o=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),d=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!o||d)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch(l){return!1}}function E(o,d){o=o||[],d=d||{};try{return new Blob(o,d)}catch(v){if(v.name!=="TypeError")throw v;for(var l=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,g=new l,_=0;_<o.length;_+=1)g.append(o[_]);return g.getBlob(d.type)}}typeof Promise>"u"&&n(3);var b=Promise;function $(o,d){d&&o.then(function(l){d(null,l)},function(l){d(l)})}function C(o,d,l){typeof d=="function"&&o.then(d),typeof l=="function"&&o.catch(l)}function T(o){return typeof o!="string"&&(console.warn(o+" used as a key, but it is not a string."),o=String(o)),o}function N(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var R="local-forage-detect-blob-support",U=void 0,F={},oe=Object.prototype.toString,B="readonly",O="readwrite";function J(o){for(var d=o.length,l=new ArrayBuffer(d),g=new Uint8Array(l),_=0;_<d;_++)g[_]=o.charCodeAt(_);return l}function z(o){return new b(function(d){var l=o.transaction(R,O),g=E([""]);l.objectStore(R).put(g,"key"),l.onabort=function(_){_.preventDefault(),_.stopPropagation(),d(!1)},l.oncomplete=function(){var _=navigator.userAgent.match(/Chrome\/(\d+)/),v=navigator.userAgent.match(/Edge\//);d(v||!_||parseInt(_[1],10)>=43)}}).catch(function(){return!1})}function te(o){return typeof U=="boolean"?b.resolve(U):z(o).then(function(d){return U=d,U})}function ae(o){var d=F[o.name],l={};l.promise=new b(function(g,_){l.resolve=g,l.reject=_}),d.deferredOperations.push(l),d.dbReady?d.dbReady=d.dbReady.then(function(){return l.promise}):d.dbReady=l.promise}function Me(o){var d=F[o.name],l=d.deferredOperations.pop();if(l)return l.resolve(),l.promise}function Se(o,d){var l=F[o.name],g=l.deferredOperations.pop();if(g)return g.reject(d),g.promise}function Ae(o,d){return new b(function(l,g){if(F[o.name]=F[o.name]||Xn(),o.db)if(d)ae(o),o.db.close();else return l(o.db);var _=[o.name];d&&_.push(o.version);var v=y.open.apply(y,_);d&&(v.onupgradeneeded=function(M){var P=v.result;try{P.createObjectStore(o.storeName),M.oldVersion<=1&&P.createObjectStore(R)}catch(I){if(I.name==="ConstraintError")console.warn('The database "'+o.name+'" has been upgraded from version '+M.oldVersion+" to version "+M.newVersion+', but the storage "'+o.storeName+'" already exists.');else throw I}}),v.onerror=function(M){M.preventDefault(),g(v.error)},v.onsuccess=function(){var M=v.result;M.onversionchange=function(P){P.target.close()},l(M),Me(o)}})}function Ze(o){return Ae(o,!1)}function Jt(o){return Ae(o,!0)}function Mr(o,d){if(!o.db)return!0;var l=!o.db.objectStoreNames.contains(o.storeName),g=o.version<o.db.version,_=o.version>o.db.version;if(g&&(o.version!==d&&console.warn('The database "'+o.name+`" can't be downgraded from version `+o.db.version+" to version "+o.version+"."),o.version=o.db.version),_||l){if(l){var v=o.db.version+1;v>o.version&&(o.version=v)}return!0}return!1}function tn(o){return new b(function(d,l){var g=new FileReader;g.onerror=l,g.onloadend=function(_){var v=btoa(_.target.result||"");d({__local_forage_encoded_blob:!0,data:v,type:o.type})},g.readAsBinaryString(o)})}function Vt(o){var d=J(atob(o.data));return E([d],{type:o.type})}function rn(o){return o&&o.__local_forage_encoded_blob}function Jn(o){var d=this,l=d._initReady().then(function(){var g=F[d._dbInfo.name];if(g&&g.dbReady)return g.dbReady});return C(l,o,o),l}function Qn(o){ae(o);for(var d=F[o.name],l=d.forages,g=0;g<l.length;g++){var _=l[g];_._dbInfo.db&&(_._dbInfo.db.close(),_._dbInfo.db=null)}return o.db=null,Ze(o).then(function(v){return o.db=v,Mr(o)?Jt(o):v}).then(function(v){o.db=d.db=v;for(var M=0;M<l.length;M++)l[M]._dbInfo.db=v}).catch(function(v){throw Se(o,v),v})}function bt(o,d,l,g){g===void 0&&(g=1);try{var _=o.db.transaction(o.storeName,d);l(null,_)}catch(v){if(g>0&&(!o.db||v.name==="InvalidStateError"||v.name==="NotFoundError"))return b.resolve().then(function(){if(!o.db||v.name==="NotFoundError"&&!o.db.objectStoreNames.contains(o.storeName)&&o.version<=o.db.version)return o.db&&(o.version=o.db.version+1),Jt(o)}).then(function(){return Qn(o).then(function(){bt(o,d,l,g-1)})}).catch(l);l(v)}}function Xn(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Qt(o){var d=this,l={db:null};if(o)for(var g in o)l[g]=o[g];var _=F[l.name];_||(_=Xn(),F[l.name]=_),_.forages.push(d),d._initReady||(d._initReady=d.ready,d.ready=Jn);var v=[];function M(){return b.resolve()}for(var P=0;P<_.forages.length;P++){var I=_.forages[P];I!==d&&v.push(I._initReady().catch(M))}var D=_.forages.slice(0);return b.all(v).then(function(){return l.db=_.db,Ze(l)}).then(function(A){return l.db=A,Mr(l,d._defaultConfig.version)?Jt(l):A}).then(function(A){l.db=_.db=A,d._dbInfo=l;for(var j=0;j<D.length;j++){var Y=D[j];Y!==d&&(Y._dbInfo.db=l.db,Y._dbInfo.version=l.version)}})}function et(o,d){var l=this;o=T(o);var g=new b(function(_,v){l.ready().then(function(){bt(l._dbInfo,B,function(M,P){if(M)return v(M);try{var I=P.objectStore(l._dbInfo.storeName),D=I.get(o);D.onsuccess=function(){var A=D.result;A===void 0&&(A=null),rn(A)&&(A=Vt(A)),_(A)},D.onerror=function(){v(D.error)}}catch(A){v(A)}})}).catch(v)});return $(g,d),g}function lt(o,d){var l=this,g=new b(function(_,v){l.ready().then(function(){bt(l._dbInfo,B,function(M,P){if(M)return v(M);try{var I=P.objectStore(l._dbInfo.storeName),D=I.openCursor(),A=1;D.onsuccess=function(){var j=D.result;if(j){var Y=j.value;rn(Y)&&(Y=Vt(Y));var le=o(Y,j.key,A++);le!==void 0?_(le):j.continue()}else _()},D.onerror=function(){v(D.error)}}catch(j){v(j)}})}).catch(v)});return $(g,d),g}function Xt(o,d,l){var g=this;o=T(o);var _=new b(function(v,M){var P;g.ready().then(function(){return P=g._dbInfo,oe.call(d)==="[object Blob]"?te(P.db).then(function(I){return I?d:tn(d)}):d}).then(function(I){bt(g._dbInfo,O,function(D,A){if(D)return M(D);try{var j=A.objectStore(g._dbInfo.storeName);I===null&&(I=void 0);var Y=j.put(I,o);A.oncomplete=function(){I===void 0&&(I=null),v(I)},A.onabort=A.onerror=function(){var le=Y.error?Y.error:Y.transaction.error;M(le)}}catch(le){M(le)}})}).catch(M)});return $(_,l),_}function nn(o,d){var l=this;o=T(o);var g=new b(function(_,v){l.ready().then(function(){bt(l._dbInfo,O,function(M,P){if(M)return v(M);try{var I=P.objectStore(l._dbInfo.storeName),D=I.delete(o);P.oncomplete=function(){_()},P.onerror=function(){v(D.error)},P.onabort=function(){var A=D.error?D.error:D.transaction.error;v(A)}}catch(A){v(A)}})}).catch(v)});return $(g,d),g}function an(o){var d=this,l=new b(function(g,_){d.ready().then(function(){bt(d._dbInfo,O,function(v,M){if(v)return _(v);try{var P=M.objectStore(d._dbInfo.storeName),I=P.clear();M.oncomplete=function(){g()},M.onabort=M.onerror=function(){var D=I.error?I.error:I.transaction.error;_(D)}}catch(D){_(D)}})}).catch(_)});return $(l,o),l}function sn(o){var d=this,l=new b(function(g,_){d.ready().then(function(){bt(d._dbInfo,B,function(v,M){if(v)return _(v);try{var P=M.objectStore(d._dbInfo.storeName),I=P.count();I.onsuccess=function(){g(I.result)},I.onerror=function(){_(I.error)}}catch(D){_(D)}})}).catch(_)});return $(l,o),l}function Zn(o,d){var l=this,g=new b(function(_,v){if(o<0){_(null);return}l.ready().then(function(){bt(l._dbInfo,B,function(M,P){if(M)return v(M);try{var I=P.objectStore(l._dbInfo.storeName),D=!1,A=I.openKeyCursor();A.onsuccess=function(){var j=A.result;if(!j){_(null);return}o===0||D?_(j.key):(D=!0,j.advance(o))},A.onerror=function(){v(A.error)}}catch(j){v(j)}})}).catch(v)});return $(g,d),g}function us(o){var d=this,l=new b(function(g,_){d.ready().then(function(){bt(d._dbInfo,B,function(v,M){if(v)return _(v);try{var P=M.objectStore(d._dbInfo.storeName),I=P.openKeyCursor(),D=[];I.onsuccess=function(){var A=I.result;if(!A){g(D);return}D.push(A.key),A.continue()},I.onerror=function(){_(I.error)}}catch(A){_(A)}})}).catch(_)});return $(l,o),l}function ds(o,d){d=N.apply(this,arguments);var l=this.config();o=typeof o!="function"&&o||{},o.name||(o.name=o.name||l.name,o.storeName=o.storeName||l.storeName);var g=this,_;if(!o.name)_=b.reject("Invalid arguments");else{var v=o.name===l.name&&g._dbInfo.db,M=v?b.resolve(g._dbInfo.db):Ze(o).then(function(P){var I=F[o.name],D=I.forages;I.db=P;for(var A=0;A<D.length;A++)D[A]._dbInfo.db=P;return P});o.storeName?_=M.then(function(P){if(!!P.objectStoreNames.contains(o.storeName)){var I=P.version+1;ae(o);var D=F[o.name],A=D.forages;P.close();for(var j=0;j<A.length;j++){var Y=A[j];Y._dbInfo.db=null,Y._dbInfo.version=I}var le=new b(function(fe,pe){var ve=y.open(o.name,I);ve.onerror=function(He){var Nt=ve.result;Nt.close(),pe(He)},ve.onupgradeneeded=function(){var He=ve.result;He.deleteObjectStore(o.storeName)},ve.onsuccess=function(){var He=ve.result;He.close(),fe(He)}});return le.then(function(fe){D.db=fe;for(var pe=0;pe<A.length;pe++){var ve=A[pe];ve._dbInfo.db=fe,Me(ve._dbInfo)}}).catch(function(fe){throw(Se(o,fe)||b.resolve()).catch(function(){}),fe})}}):_=M.then(function(P){ae(o);var I=F[o.name],D=I.forages;P.close();for(var A=0;A<D.length;A++){var j=D[A];j._dbInfo.db=null}var Y=new b(function(le,fe){var pe=y.deleteDatabase(o.name);pe.onerror=function(){var ve=pe.result;ve&&ve.close(),fe(pe.error)},pe.onblocked=function(){console.warn('dropInstance blocked for database "'+o.name+'" until all open connections are closed')},pe.onsuccess=function(){var ve=pe.result;ve&&ve.close(),le(ve)}});return Y.then(function(le){I.db=le;for(var fe=0;fe<D.length;fe++){var pe=D[fe];Me(pe._dbInfo)}}).catch(function(le){throw(Se(o,le)||b.resolve()).catch(function(){}),le})})}return $(_,d),_}var Et={_driver:"asyncStorage",_initStorage:Qt,_support:h(),iterate:lt,getItem:et,setItem:Xt,removeItem:nn,clear:an,length:sn,key:Zn,keys:us,dropInstance:ds};function fs(){return typeof openDatabase=="function"}var $t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ea="~~local_forage_type~",on=/^~~local_forage_type~([^~]+)~/,Pr="__lfsc__:",It=Pr.length,tt="arbf",kr="blob",ta="si08",ra="ui08",na="uic8",aa="si16",ct="si32",Zt="ur16",ln="ui32",cn="fl32",er="fl64",un=It+tt.length,sa=Object.prototype.toString;function ia(o){var d=o.length*.75,l=o.length,g,_=0,v,M,P,I;o[o.length-1]==="="&&(d--,o[o.length-2]==="="&&d--);var D=new ArrayBuffer(d),A=new Uint8Array(D);for(g=0;g<l;g+=4)v=$t.indexOf(o[g]),M=$t.indexOf(o[g+1]),P=$t.indexOf(o[g+2]),I=$t.indexOf(o[g+3]),A[_++]=v<<2|M>>4,A[_++]=(M&15)<<4|P>>2,A[_++]=(P&3)<<6|I&63;return D}function Ir(o){var d=new Uint8Array(o),l="",g;for(g=0;g<d.length;g+=3)l+=$t[d[g]>>2],l+=$t[(d[g]&3)<<4|d[g+1]>>4],l+=$t[(d[g+1]&15)<<2|d[g+2]>>6],l+=$t[d[g+2]&63];return d.length%3===2?l=l.substring(0,l.length-1)+"=":d.length%3===1&&(l=l.substring(0,l.length-2)+"=="),l}function ut(o,d){var l="";if(o&&(l=sa.call(o)),o&&(l==="[object ArrayBuffer]"||o.buffer&&sa.call(o.buffer)==="[object ArrayBuffer]")){var g,_=Pr;o instanceof ArrayBuffer?(g=o,_+=tt):(g=o.buffer,l==="[object Int8Array]"?_+=ta:l==="[object Uint8Array]"?_+=ra:l==="[object Uint8ClampedArray]"?_+=na:l==="[object Int16Array]"?_+=aa:l==="[object Uint16Array]"?_+=Zt:l==="[object Int32Array]"?_+=ct:l==="[object Uint32Array]"?_+=ln:l==="[object Float32Array]"?_+=cn:l==="[object Float64Array]"?_+=er:d(new Error("Failed to get type for BinaryArray"))),d(_+Ir(g))}else if(l==="[object Blob]"){var v=new FileReader;v.onload=function(){var M=ea+o.type+"~"+Ir(this.result);d(Pr+kr+M)},v.readAsArrayBuffer(o)}else try{d(JSON.stringify(o))}catch(M){console.error("Couldn't convert value into a JSON string: ",o),d(null,M)}}function ms(o){if(o.substring(0,It)!==Pr)return JSON.parse(o);var d=o.substring(un),l=o.substring(It,un),g;if(l===kr&&on.test(d)){var _=d.match(on);g=_[1],d=d.substring(_[0].length)}var v=ia(d);switch(l){case tt:return v;case kr:return E([v],{type:g});case ta:return new Int8Array(v);case ra:return new Uint8Array(v);case na:return new Uint8ClampedArray(v);case aa:return new Int16Array(v);case Zt:return new Uint16Array(v);case ct:return new Int32Array(v);case ln:return new Uint32Array(v);case cn:return new Float32Array(v);case er:return new Float64Array(v);default:throw new Error("Unkown type: "+l)}}var dn={serialize:ut,deserialize:ms,stringToBuffer:ia,bufferToString:Ir};function oa(o,d,l,g){o.executeSql("CREATE TABLE IF NOT EXISTS "+d.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],l,g)}function hs(o){var d=this,l={db:null};if(o)for(var g in o)l[g]=typeof o[g]!="string"?o[g].toString():o[g];var _=new b(function(v,M){try{l.db=openDatabase(l.name,String(l.version),l.description,l.size)}catch(P){return M(P)}l.db.transaction(function(P){oa(P,l,function(){d._dbInfo=l,v()},function(I,D){M(D)})},M)});return l.serializer=dn,_}function Dt(o,d,l,g,_,v){o.executeSql(l,g,_,function(M,P){P.code===P.SYNTAX_ERR?M.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[d.storeName],function(I,D){D.rows.length?v(I,P):oa(I,d,function(){I.executeSql(l,g,_,v)},v)},v):v(M,P)},v)}function ps(o,d){var l=this;o=T(o);var g=new b(function(_,v){l.ready().then(function(){var M=l._dbInfo;M.db.transaction(function(P){Dt(P,M,"SELECT * FROM "+M.storeName+" WHERE key = ? LIMIT 1",[o],function(I,D){var A=D.rows.length?D.rows.item(0).value:null;A&&(A=M.serializer.deserialize(A)),_(A)},function(I,D){v(D)})})}).catch(v)});return $(g,d),g}function tr(o,d){var l=this,g=new b(function(_,v){l.ready().then(function(){var M=l._dbInfo;M.db.transaction(function(P){Dt(P,M,"SELECT * FROM "+M.storeName,[],function(I,D){for(var A=D.rows,j=A.length,Y=0;Y<j;Y++){var le=A.item(Y),fe=le.value;if(fe&&(fe=M.serializer.deserialize(fe)),fe=o(fe,le.key,Y+1),fe!==void 0){_(fe);return}}_()},function(I,D){v(D)})})}).catch(v)});return $(g,d),g}function la(o,d,l,g){var _=this;o=T(o);var v=new b(function(M,P){_.ready().then(function(){d===void 0&&(d=null);var I=d,D=_._dbInfo;D.serializer.serialize(d,function(A,j){j?P(j):D.db.transaction(function(Y){Dt(Y,D,"INSERT OR REPLACE INTO "+D.storeName+" (key, value) VALUES (?, ?)",[o,A],function(){M(I)},function(le,fe){P(fe)})},function(Y){if(Y.code===Y.QUOTA_ERR){if(g>0){M(la.apply(_,[o,I,l,g-1]));return}P(Y)}})})}).catch(P)});return $(v,l),v}function ca(o,d,l){return la.apply(this,[o,d,l,1])}function vs(o,d){var l=this;o=T(o);var g=new b(function(_,v){l.ready().then(function(){var M=l._dbInfo;M.db.transaction(function(P){Dt(P,M,"DELETE FROM "+M.storeName+" WHERE key = ?",[o],function(){_()},function(I,D){v(D)})})}).catch(v)});return $(g,d),g}function fn(o){var d=this,l=new b(function(g,_){d.ready().then(function(){var v=d._dbInfo;v.db.transaction(function(M){Dt(M,v,"DELETE FROM "+v.storeName,[],function(){g()},function(P,I){_(I)})})}).catch(_)});return $(l,o),l}function ua(o){var d=this,l=new b(function(g,_){d.ready().then(function(){var v=d._dbInfo;v.db.transaction(function(M){Dt(M,v,"SELECT COUNT(key) as c FROM "+v.storeName,[],function(P,I){var D=I.rows.item(0).c;g(D)},function(P,I){_(I)})})}).catch(_)});return $(l,o),l}function gs(o,d){var l=this,g=new b(function(_,v){l.ready().then(function(){var M=l._dbInfo;M.db.transaction(function(P){Dt(P,M,"SELECT key FROM "+M.storeName+" WHERE id = ? LIMIT 1",[o+1],function(I,D){var A=D.rows.length?D.rows.item(0).key:null;_(A)},function(I,D){v(D)})})}).catch(v)});return $(g,d),g}function da(o){var d=this,l=new b(function(g,_){d.ready().then(function(){var v=d._dbInfo;v.db.transaction(function(M){Dt(M,v,"SELECT key FROM "+v.storeName,[],function(P,I){for(var D=[],A=0;A<I.rows.length;A++)D.push(I.rows.item(A).key);g(D)},function(P,I){_(I)})})}).catch(_)});return $(l,o),l}function ys(o){return new b(function(d,l){o.transaction(function(g){g.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(_,v){for(var M=[],P=0;P<v.rows.length;P++)M.push(v.rows.item(P).name);d({db:o,storeNames:M})},function(_,v){l(v)})},function(g){l(g)})})}function fa(o,d){d=N.apply(this,arguments);var l=this.config();o=typeof o!="function"&&o||{},o.name||(o.name=o.name||l.name,o.storeName=o.storeName||l.storeName);var g=this,_;return o.name?_=new b(function(v){var M;o.name===l.name?M=g._dbInfo.db:M=openDatabase(o.name,"","",0),o.storeName?v({db:M,storeNames:[o.storeName]}):v(ys(M))}).then(function(v){return new b(function(M,P){v.db.transaction(function(I){function D(le){return new b(function(fe,pe){I.executeSql("DROP TABLE IF EXISTS "+le,[],function(){fe()},function(ve,He){pe(He)})})}for(var A=[],j=0,Y=v.storeNames.length;j<Y;j++)A.push(D(v.storeNames[j]));b.all(A).then(function(){M()}).catch(function(le){P(le)})},function(I){P(I)})})}):_=b.reject("Invalid arguments"),$(_,d),_}var m={_driver:"webSQLStorage",_initStorage:hs,_support:fs(),iterate:tr,getItem:ps,setItem:ca,removeItem:vs,clear:fn,length:ua,key:gs,keys:da,dropInstance:fa};function u(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch(o){return!1}}function p(o,d){var l=o.name+"/";return o.storeName!==d.storeName&&(l+=o.storeName+"/"),l}function S(){var o="_localforage_support_test";try{return localStorage.setItem(o,!0),localStorage.removeItem(o),!1}catch(d){return!0}}function w(){return!S()||localStorage.length>0}function L(o){var d=this,l={};if(o)for(var g in o)l[g]=o[g];return l.keyPrefix=p(o,d._defaultConfig),w()?(d._dbInfo=l,l.serializer=dn,b.resolve()):b.reject()}function K(o){var d=this,l=d.ready().then(function(){for(var g=d._dbInfo.keyPrefix,_=localStorage.length-1;_>=0;_--){var v=localStorage.key(_);v.indexOf(g)===0&&localStorage.removeItem(v)}});return $(l,o),l}function re(o,d){var l=this;o=T(o);var g=l.ready().then(function(){var _=l._dbInfo,v=localStorage.getItem(_.keyPrefix+o);return v&&(v=_.serializer.deserialize(v)),v});return $(g,d),g}function de(o,d){var l=this,g=l.ready().then(function(){for(var _=l._dbInfo,v=_.keyPrefix,M=v.length,P=localStorage.length,I=1,D=0;D<P;D++){var A=localStorage.key(D);if(A.indexOf(v)===0){var j=localStorage.getItem(A);if(j&&(j=_.serializer.deserialize(j)),j=o(j,A.substring(M),I++),j!==void 0)return j}}});return $(g,d),g}function Ce(o,d){var l=this,g=l.ready().then(function(){var _=l._dbInfo,v;try{v=localStorage.key(o)}catch(M){v=null}return v&&(v=v.substring(_.keyPrefix.length)),v});return $(g,d),g}function ee(o){var d=this,l=d.ready().then(function(){for(var g=d._dbInfo,_=localStorage.length,v=[],M=0;M<_;M++){var P=localStorage.key(M);P.indexOf(g.keyPrefix)===0&&v.push(P.substring(g.keyPrefix.length))}return v});return $(l,o),l}function be(o){var d=this,l=d.keys().then(function(g){return g.length});return $(l,o),l}function Te(o,d){var l=this;o=T(o);var g=l.ready().then(function(){var _=l._dbInfo;localStorage.removeItem(_.keyPrefix+o)});return $(g,d),g}function _e(o,d,l){var g=this;o=T(o);var _=g.ready().then(function(){d===void 0&&(d=null);var v=d;return new b(function(M,P){var I=g._dbInfo;I.serializer.serialize(d,function(D,A){if(A)P(A);else try{localStorage.setItem(I.keyPrefix+o,D),M(v)}catch(j){(j.name==="QuotaExceededError"||j.name==="NS_ERROR_DOM_QUOTA_REACHED")&&P(j),P(j)}})})});return $(_,l),_}function se(o,d){if(d=N.apply(this,arguments),o=typeof o!="function"&&o||{},!o.name){var l=this.config();o.name=o.name||l.name,o.storeName=o.storeName||l.storeName}var g=this,_;return o.name?_=new b(function(v){o.storeName?v(p(o,g._defaultConfig)):v(o.name+"/")}).then(function(v){for(var M=localStorage.length-1;M>=0;M--){var P=localStorage.key(M);P.indexOf(v)===0&&localStorage.removeItem(P)}}):_=b.reject("Invalid arguments"),$(_,d),_}var Ee={_driver:"localStorageWrapper",_initStorage:L,_support:u(),iterate:de,getItem:re,setItem:_e,removeItem:Te,clear:K,length:be,key:Ce,keys:ee,dropInstance:se},me=function(d,l){return d===l||typeof d=="number"&&typeof l=="number"&&isNaN(d)&&isNaN(l)},Ht=function(d,l){for(var g=d.length,_=0;_<g;){if(me(d[_],l))return!0;_++}return!1},Ve=Array.isArray||function(o){return Object.prototype.toString.call(o)==="[object Array]"},Re={},he={},Ne={INDEXEDDB:Et,WEBSQL:m,LOCALSTORAGE:Ee},rt=[Ne.INDEXEDDB._driver,Ne.WEBSQL._driver,Ne.LOCALSTORAGE._driver],ze=["dropInstance"],St=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ze),wt={description:"",driver:rt.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function fr(o,d){o[d]=function(){var l=arguments;return o.ready().then(function(){return o[d].apply(o,l)})}}function rr(){for(var o=1;o<arguments.length;o++){var d=arguments[o];if(d)for(var l in d)d.hasOwnProperty(l)&&(Ve(d[l])?arguments[0][l]=d[l].slice():arguments[0][l]=d[l])}return arguments[0]}var Dr=function(){function o(d){c(this,o);for(var l in Ne)if(Ne.hasOwnProperty(l)){var g=Ne[l],_=g._driver;this[l]=_,Re[_]||this.defineDriver(g)}this._defaultConfig=rr({},wt),this._config=rr({},this._defaultConfig,d),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return o.prototype.config=function(l){if((typeof l>"u"?"undefined":i(l))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var g in l){if(g==="storeName"&&(l[g]=l[g].replace(/\W/g,"_")),g==="version"&&typeof l[g]!="number")return new Error("Database version must be a number.");this._config[g]=l[g]}return"driver"in l&&l.driver?this.setDriver(this._config.driver):!0}else return typeof l=="string"?this._config[l]:this._config},o.prototype.defineDriver=function(l,g,_){var v=new b(function(M,P){try{var I=l._driver,D=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!l._driver){P(D);return}for(var A=St.concat("_initStorage"),j=0,Y=A.length;j<Y;j++){var le=A[j],fe=!Ht(ze,le);if((fe||l[le])&&typeof l[le]!="function"){P(D);return}}var pe=function(){for(var Nt=function(ma){return function(){var _s=new Error("Method "+ma+" is not implemented by the current driver"),ha=b.reject(_s);return $(ha,arguments[arguments.length-1]),ha}},Rt=0,wo=ze.length;Rt<wo;Rt++){var At=ze[Rt];l[At]||(l[At]=Nt(At))}};pe();var ve=function(Nt){Re[I]&&console.info("Redefining LocalForage driver: "+I),Re[I]=l,he[I]=Nt,M()};"_support"in l?l._support&&typeof l._support=="function"?l._support().then(ve,P):ve(!!l._support):ve(!0)}catch(He){P(He)}});return C(v,g,_),v},o.prototype.driver=function(){return this._driver||null},o.prototype.getDriver=function(l,g,_){var v=Re[l]?b.resolve(Re[l]):b.reject(new Error("Driver not found."));return C(v,g,_),v},o.prototype.getSerializer=function(l){var g=b.resolve(dn);return C(g,l),g},o.prototype.ready=function(l){var g=this,_=g._driverSet.then(function(){return g._ready===null&&(g._ready=g._initDriver()),g._ready});return C(_,l,l),_},o.prototype.setDriver=function(l,g,_){var v=this;Ve(l)||(l=[l]);var M=this._getSupportedDrivers(l);function P(){v._config.driver=v.driver()}function I(j){return v._extend(j),P(),v._ready=v._initStorage(v._config),v._ready}function D(j){return function(){var Y=0;function le(){for(;Y<j.length;){var fe=j[Y];return Y++,v._dbInfo=null,v._ready=null,v.getDriver(fe).then(I).catch(le)}P();var pe=new Error("No available storage method found.");return v._driverSet=b.reject(pe),v._driverSet}return le()}}var A=this._driverSet!==null?this._driverSet.catch(function(){return b.resolve()}):b.resolve();return this._driverSet=A.then(function(){var j=M[0];return v._dbInfo=null,v._ready=null,v.getDriver(j).then(function(Y){v._driver=Y._driver,P(),v._wrapLibraryMethodsWithReady(),v._initDriver=D(M)})}).catch(function(){P();var j=new Error("No available storage method found.");return v._driverSet=b.reject(j),v._driverSet}),C(this._driverSet,g,_),this._driverSet},o.prototype.supports=function(l){return!!he[l]},o.prototype._extend=function(l){rr(this,l)},o.prototype._getSupportedDrivers=function(l){for(var g=[],_=0,v=l.length;_<v;_++){var M=l[_];this.supports(M)&&g.push(M)}return g},o.prototype._wrapLibraryMethodsWithReady=function(){for(var l=0,g=St.length;l<g;l++)fr(this,St[l])},o.prototype.createInstance=function(l){return new o(l)},o}(),nr=new Dr;a.exports=nr},{3:3}]},{},[4])(4)})});var wn=x(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.regexpCode=ce.getEsmExportName=ce.getProperty=ce.safeStringify=ce.stringify=ce.strConcat=ce.addCodeArg=ce.str=ce._=ce.nil=ce._Code=ce.Name=ce.IDENTIFIER=ce._CodeOrName=void 0;var $n=class{};ce._CodeOrName=$n;ce.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var yr=class extends $n{constructor(e){if(super(),!ce.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};ce.Name=yr;var vt=class extends $n{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,n)=>(n instanceof yr&&(r[n.str]=(r[n.str]||0)+1),r),{})}};ce._Code=vt;ce.nil=new vt("");function pl(t,...e){let r=[t[0]],n=0;for(;n<e.length;)zs(r,e[n]),r.push(t[++n]);return new vt(r)}ce._=pl;var Gs=new vt("+");function vl(t,...e){let r=[Sn(t[0])],n=0;for(;n<e.length;)r.push(Gs),zs(r,e[n]),r.push(Gs,Sn(t[++n]));return wd(r),new vt(r)}ce.str=vl;function zs(t,e){e instanceof vt?t.push(...e._items):e instanceof yr?t.push(e):t.push(Md(e))}ce.addCodeArg=zs;function wd(t){let e=1;for(;e<t.length-1;){if(t[e]===Gs){let r=Cd(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function Cd(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof yr||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof yr))return`"${t}${e.slice(1)}`}function Td(t,e){return e.emptyStr()?t:t.emptyStr()?e:vl`${t}${e}`}ce.strConcat=Td;function Md(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:Sn(Array.isArray(t)?t.join(","):t)}function Pd(t){return new vt(Sn(t))}ce.stringify=Pd;function Sn(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}ce.safeStringify=Sn;function kd(t){return typeof t=="string"&&ce.IDENTIFIER.test(t)?new vt(`.${t}`):pl`[${t}]`}ce.getProperty=kd;function Id(t){if(typeof t=="string"&&ce.IDENTIFIER.test(t))return new vt(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}ce.getEsmExportName=Id;function Dd(t){return new vt(t.toString())}ce.regexpCode=Dd});var Js=x(Je=>{"use strict";Object.defineProperty(Je,"__esModule",{value:!0});Je.ValueScope=Je.ValueScopeName=Je.Scope=Je.varKinds=Je.UsedValueState=void 0;var st=wn(),Ks=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},Ws;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(Ws=Je.UsedValueState||(Je.UsedValueState={}));Je.varKinds={const:new st.Name("const"),let:new st.Name("let"),var:new st.Name("var")};var Na=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof st.Name?e:this.name(e)}name(e){return new st.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,n;if(((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0?void 0:n.has(e))||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};Je.Scope=Na;var Ra=class extends st.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=(0,st._)`.${new st.Name(r)}[${n}]`}};Je.ValueScopeName=Ra;var Nd=(0,st._)`\n`,Ys=class extends Na{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts=dt(Pe({},e),{_n:e.lines?Nd:st.nil})}get(){return this._scope}name(e){return new Ra(e,this._newName(e))}value(e,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let a=this.toName(e),{prefix:s}=a,i=(n=r.key)!==null&&n!==void 0?n:r.ref,c=this._values[s];if(c){let h=c.get(i);if(h)return h}else c=this._values[s]=new Map;c.set(i,a);let f=this._scope[s]||(this._scope[s]=[]),y=f.length;return f[y]=r.ref,a.setValue(r,{property:s,itemIndex:y}),a}getValue(e,r){let n=this._values[e];if(!!n)return n.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,st._)`${e}${n.scopePath}`})}scopeCode(e=this._values,r,n){return this._reduceValues(e,a=>{if(a.value===void 0)throw new Error(`CodeGen: name "${a}" has no value`);return a.value.code},r,n)}_reduceValues(e,r,n={},a){let s=st.nil;for(let i in e){let c=e[i];if(!c)continue;let f=n[i]=n[i]||new Map;c.forEach(y=>{if(f.has(y))return;f.set(y,Ws.Started);let h=r(y);if(h){let E=this.opts.es5?Je.varKinds.var:Je.varKinds.const;s=(0,st._)`${s}${E} ${y} = ${h};${this.opts._n}`}else if(h=a==null?void 0:a(y))s=(0,st._)`${s}${h}${this.opts._n}`;else throw new Ks(y);f.set(y,Ws.Completed)})}return s}};Je.ValueScope=Ys});var Z=x(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.or=Q.and=Q.not=Q.CodeGen=Q.operators=Q.varKinds=Q.ValueScopeName=Q.ValueScope=Q.Scope=Q.Name=Q.regexpCode=Q.stringify=Q.getProperty=Q.nil=Q.strConcat=Q.str=Q._=void 0;var ne=wn(),Ct=Js(),sr=wn();Object.defineProperty(Q,"_",{enumerable:!0,get:function(){return sr._}});Object.defineProperty(Q,"str",{enumerable:!0,get:function(){return sr.str}});Object.defineProperty(Q,"strConcat",{enumerable:!0,get:function(){return sr.strConcat}});Object.defineProperty(Q,"nil",{enumerable:!0,get:function(){return sr.nil}});Object.defineProperty(Q,"getProperty",{enumerable:!0,get:function(){return sr.getProperty}});Object.defineProperty(Q,"stringify",{enumerable:!0,get:function(){return sr.stringify}});Object.defineProperty(Q,"regexpCode",{enumerable:!0,get:function(){return sr.regexpCode}});Object.defineProperty(Q,"Name",{enumerable:!0,get:function(){return sr.Name}});var xa=Js();Object.defineProperty(Q,"Scope",{enumerable:!0,get:function(){return xa.Scope}});Object.defineProperty(Q,"ValueScope",{enumerable:!0,get:function(){return xa.ValueScope}});Object.defineProperty(Q,"ValueScopeName",{enumerable:!0,get:function(){return xa.ValueScopeName}});Object.defineProperty(Q,"varKinds",{enumerable:!0,get:function(){return xa.varKinds}});Q.operators={GT:new ne._Code(">"),GTE:new ne._Code(">="),LT:new ne._Code("<"),LTE:new ne._Code("<="),EQ:new ne._Code("==="),NEQ:new ne._Code("!=="),NOT:new ne._Code("!"),OR:new ne._Code("||"),AND:new ne._Code("&&"),ADD:new ne._Code("+")};var zt=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},Qs=class extends zt{constructor(e,r,n){super(),this.varKind=e,this.name=r,this.rhs=n}render({es5:e,_n:r}){let n=e?Ct.varKinds.var:this.varKind,a=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${a};`+r}optimizeNames(e,r){if(!!e[this.name.str])return this.rhs&&(this.rhs=Ur(this.rhs,e,r)),this}get names(){return this.rhs instanceof ne._CodeOrName?this.rhs.names:{}}},Aa=class extends zt{constructor(e,r,n){super(),this.lhs=e,this.rhs=r,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof ne.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=Ur(this.rhs,e,r),this}get names(){let e=this.lhs instanceof ne.Name?{}:Pe({},this.lhs.names);return La(e,this.rhs)}},Xs=class extends Aa{constructor(e,r,n,a){super(e,n,a),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},Zs=class extends zt{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},ei=class extends zt{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},ti=class extends zt{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},ri=class extends zt{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=Ur(this.code,e,r),this}get names(){return this.code instanceof ne._CodeOrName?this.code.names:{}}},Cn=class extends zt{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,n)=>r+n.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let n=e[r].optimizeNodes();Array.isArray(n)?e.splice(r,1,...n):n?e[r]=n:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:n}=this,a=n.length;for(;a--;){let s=n[a];s.optimizeNames(e,r)||(Rd(e,s.names),n.splice(a,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>br(e,r.names),{})}},Kt=class extends Cn{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},ni=class extends Cn{},Br=class extends Kt{};Br.kind="else";var Tt=class extends Kt{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new Br(n):n}if(r)return e===!1?r instanceof Tt?r:r.nodes:this.nodes.length?this:new Tt(gl(e),r instanceof Tt?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=Ur(this.condition,e,r),this}get names(){let e=super.names;return La(e,this.condition),this.else&&br(e,this.else.names),e}};Tt.kind="if";var _r=class extends Kt{};_r.kind="for";var ai=class extends _r{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(!!super.optimizeNames(e,r))return this.iteration=Ur(this.iteration,e,r),this}get names(){return br(super.names,this.iteration.names)}},si=class extends _r{constructor(e,r,n,a){super(),this.varKind=e,this.name=r,this.from=n,this.to=a}render(e){let r=e.es5?Ct.varKinds.var:this.varKind,{name:n,from:a,to:s}=this;return`for(${r} ${n}=${a}; ${n}<${s}; ${n}++)`+super.render(e)}get names(){let e=La(super.names,this.from);return La(e,this.to)}},Oa=class extends _r{constructor(e,r,n,a){super(),this.loop=e,this.varKind=r,this.name=n,this.iterable=a}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(!!super.optimizeNames(e,r))return this.iterable=Ur(this.iterable,e,r),this}get names(){return br(super.names,this.iterable.names)}},Tn=class extends Kt{constructor(e,r,n){super(),this.name=e,this.args=r,this.async=n}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};Tn.kind="func";var Mn=class extends Cn{render(e){return"return "+super.render(e)}};Mn.kind="return";var ii=class extends Kt{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var n,a;return super.optimizeNames(e,r),(n=this.catch)===null||n===void 0||n.optimizeNames(e,r),(a=this.finally)===null||a===void 0||a.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&br(e,this.catch.names),this.finally&&br(e,this.finally.names),e}},Pn=class extends Kt{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};Pn.kind="catch";var kn=class extends Kt{render(e){return"finally"+super.render(e)}};kn.kind="finally";var oi=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts=dt(Pe({},r),{_n:r.lines?`
`:""}),this._extScope=e,this._scope=new Ct.Scope({parent:e}),this._nodes=[new ni]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let n=this._extScope.value(e,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,n,a){let s=this._scope.toName(r);return n!==void 0&&a&&(this._constants[s.str]=n),this._leafNode(new Qs(e,s,n)),s}const(e,r,n){return this._def(Ct.varKinds.const,e,r,n)}let(e,r,n){return this._def(Ct.varKinds.let,e,r,n)}var(e,r,n){return this._def(Ct.varKinds.var,e,r,n)}assign(e,r,n){return this._leafNode(new Aa(e,r,n))}add(e,r){return this._leafNode(new Xs(e,Q.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==ne.nil&&this._leafNode(new ri(e)),this}object(...e){let r=["{"];for(let[n,a]of e)r.length>1&&r.push(","),r.push(n),(n!==a||this.opts.es5)&&(r.push(":"),(0,ne.addCodeArg)(r,a));return r.push("}"),new ne._Code(r)}if(e,r,n){if(this._blockNode(new Tt(e)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new Tt(e))}else(){return this._elseNode(new Br)}endIf(){return this._endBlockNode(Tt,Br)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new ai(e),r)}forRange(e,r,n,a,s=this.opts.es5?Ct.varKinds.var:Ct.varKinds.let){let i=this._scope.toName(e);return this._for(new si(s,i,r,n),()=>a(i))}forOf(e,r,n,a=Ct.varKinds.const){let s=this._scope.toName(e);if(this.opts.es5){let i=r instanceof ne.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,ne._)`${i}.length`,c=>{this.var(s,(0,ne._)`${i}[${c}]`),n(s)})}return this._for(new Oa("of",a,s,r),()=>n(s))}forIn(e,r,n,a=this.opts.es5?Ct.varKinds.var:Ct.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,ne._)`Object.keys(${r})`,n);let s=this._scope.toName(e);return this._for(new Oa("in",a,s,r),()=>n(s))}endFor(){return this._endBlockNode(_r)}label(e){return this._leafNode(new Zs(e))}break(e){return this._leafNode(new ei(e))}return(e){let r=new Mn;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Mn)}try(e,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let a=new ii;if(this._blockNode(a),this.code(e),r){let s=this.name("e");this._currNode=a.catch=new Pn(s),r(s)}return n&&(this._currNode=a.finally=new kn,this.code(n)),this._endBlockNode(Pn,kn)}throw(e){return this._leafNode(new ti(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=ne.nil,n,a){return this._blockNode(new Tn(e,r,n)),a&&this.code(a).endFunc(),this}endFunc(){return this._endBlockNode(Tn)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let n=this._currNode;if(n instanceof e||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof Tt))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};Q.CodeGen=oi;function br(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function La(t,e){return e instanceof ne._CodeOrName?br(t,e.names):t}function Ur(t,e,r){if(t instanceof ne.Name)return n(t);if(!a(t))return t;return new ne._Code(t._items.reduce((s,i)=>(i instanceof ne.Name&&(i=n(i)),i instanceof ne._Code?s.push(...i._items):s.push(i),s),[]));function n(s){let i=r[s.str];return i===void 0||e[s.str]!==1?s:(delete e[s.str],i)}function a(s){return s instanceof ne._Code&&s._items.some(i=>i instanceof ne.Name&&e[i.str]===1&&r[i.str]!==void 0)}}function Rd(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function gl(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,ne._)`!${li(t)}`}Q.not=gl;var Ad=yl(Q.operators.AND);function Od(...t){return t.reduce(Ad)}Q.and=Od;var Ld=yl(Q.operators.OR);function xd(...t){return t.reduce(Ld)}Q.or=xd;function yl(t){return(e,r)=>e===ne.nil?r:r===ne.nil?e:(0,ne._)`${li(e)} ${t} ${li(r)}`}function li(t){return t instanceof ne.Name?t:(0,ne._)`(${t})`}});var ue=x(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.checkStrictMode=X.getErrorPath=X.Type=X.useFunc=X.setEvaluated=X.evaluatedPropsToName=X.mergeEvaluated=X.eachItem=X.unescapeJsonPointer=X.escapeJsonPointer=X.escapeFragment=X.unescapeFragment=X.schemaRefOrVal=X.schemaHasRulesButRef=X.schemaHasRules=X.checkUnknownRules=X.alwaysValidSchema=X.toHash=void 0;var ye=Z(),qd=wn();function jd(t){let e={};for(let r of t)e[r]=!0;return e}X.toHash=jd;function Fd(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(El(t,e),!$l(e,t.self.RULES.all))}X.alwaysValidSchema=Fd;function El(t,e=t.schema){let{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;let a=n.RULES.keywords;for(let s in e)a[s]||Tl(t,`unknown keyword: "${s}"`)}X.checkUnknownRules=El;function $l(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}X.schemaHasRules=$l;function Vd(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}X.schemaHasRulesButRef=Vd;function Hd({topSchemaRef:t,schemaPath:e},r,n,a){if(!a){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,ye._)`${r}`}return(0,ye._)`${t}${e}${(0,ye.getProperty)(n)}`}X.schemaRefOrVal=Hd;function Bd(t){return Sl(decodeURIComponent(t))}X.unescapeFragment=Bd;function Ud(t){return encodeURIComponent(ci(t))}X.escapeFragment=Ud;function ci(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}X.escapeJsonPointer=ci;function Sl(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}X.unescapeJsonPointer=Sl;function Gd(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}X.eachItem=Gd;function _l({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(a,s,i,c)=>{let f=i===void 0?s:i instanceof ye.Name?(s instanceof ye.Name?t(a,s,i):e(a,s,i),i):s instanceof ye.Name?(e(a,i,s),s):r(s,i);return c===ye.Name&&!(f instanceof ye.Name)?n(a,f):f}}X.mergeEvaluated={props:_l({mergeNames:(t,e,r)=>t.if((0,ye._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,ye._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,ye._)`${r} || {}`).code((0,ye._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,ye._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,ye._)`${r} || {}`),ui(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:Pe(Pe({},t),e),resultToName:wl}),items:_l({mergeNames:(t,e,r)=>t.if((0,ye._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,ye._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,ye._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,ye._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function wl(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,ye._)`{}`);return e!==void 0&&ui(t,r,e),r}X.evaluatedPropsToName=wl;function ui(t,e,r){Object.keys(r).forEach(n=>t.assign((0,ye._)`${e}${(0,ye.getProperty)(n)}`,!0))}X.setEvaluated=ui;var bl={};function zd(t,e){return t.scopeValue("func",{ref:e,code:bl[e.code]||(bl[e.code]=new qd._Code(e.code))})}X.useFunc=zd;var Cl;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(Cl=X.Type||(X.Type={}));function Kd(t,e,r){if(t instanceof ye.Name){let n=e===Cl.Num;return r?n?(0,ye._)`"[" + ${t} + "]"`:(0,ye._)`"['" + ${t} + "']"`:n?(0,ye._)`"/" + ${t}`:(0,ye._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,ye.getProperty)(t).toString():"/"+ci(t)}X.getErrorPath=Kd;function Tl(t,e,r=t.opts.strictSchema){if(!!r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}X.checkStrictMode=Tl});var Wt=x(di=>{"use strict";Object.defineProperty(di,"__esModule",{value:!0});var Ue=Z(),Wd={data:new Ue.Name("data"),valCxt:new Ue.Name("valCxt"),instancePath:new Ue.Name("instancePath"),parentData:new Ue.Name("parentData"),parentDataProperty:new Ue.Name("parentDataProperty"),rootData:new Ue.Name("rootData"),dynamicAnchors:new Ue.Name("dynamicAnchors"),vErrors:new Ue.Name("vErrors"),errors:new Ue.Name("errors"),this:new Ue.Name("this"),self:new Ue.Name("self"),scope:new Ue.Name("scope"),json:new Ue.Name("json"),jsonPos:new Ue.Name("jsonPos"),jsonLen:new Ue.Name("jsonLen"),jsonPart:new Ue.Name("jsonPart")};di.default=Wd});var In=x(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.extendErrors=Ge.resetErrorsCount=Ge.reportExtraError=Ge.reportError=Ge.keyword$DataError=Ge.keywordError=void 0;var ie=Z(),qa=ue(),Qe=Wt();Ge.keywordError={message:({keyword:t})=>(0,ie.str)`must pass "${t}" keyword validation`};Ge.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,ie.str)`"${t}" keyword must be ${e} ($data)`:(0,ie.str)`"${t}" keyword is invalid ($data)`};function Yd(t,e=Ge.keywordError,r,n){let{it:a}=t,{gen:s,compositeRule:i,allErrors:c}=a,f=kl(t,e,r);(n!=null?n:i||c)?Ml(s,f):Pl(a,(0,ie._)`[${f}]`)}Ge.reportError=Yd;function Jd(t,e=Ge.keywordError,r){let{it:n}=t,{gen:a,compositeRule:s,allErrors:i}=n,c=kl(t,e,r);Ml(a,c),s||i||Pl(n,Qe.default.vErrors)}Ge.reportExtraError=Jd;function Qd(t,e){t.assign(Qe.default.errors,e),t.if((0,ie._)`${Qe.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,ie._)`${Qe.default.vErrors}.length`,e),()=>t.assign(Qe.default.vErrors,null)))}Ge.resetErrorsCount=Qd;function Xd({gen:t,keyword:e,schemaValue:r,data:n,errsCount:a,it:s}){if(a===void 0)throw new Error("ajv implementation error");let i=t.name("err");t.forRange("i",a,Qe.default.errors,c=>{t.const(i,(0,ie._)`${Qe.default.vErrors}[${c}]`),t.if((0,ie._)`${i}.instancePath === undefined`,()=>t.assign((0,ie._)`${i}.instancePath`,(0,ie.strConcat)(Qe.default.instancePath,s.errorPath))),t.assign((0,ie._)`${i}.schemaPath`,(0,ie.str)`${s.errSchemaPath}/${e}`),s.opts.verbose&&(t.assign((0,ie._)`${i}.schema`,r),t.assign((0,ie._)`${i}.data`,n))})}Ge.extendErrors=Xd;function Ml(t,e){let r=t.const("err",e);t.if((0,ie._)`${Qe.default.vErrors} === null`,()=>t.assign(Qe.default.vErrors,(0,ie._)`[${r}]`),(0,ie._)`${Qe.default.vErrors}.push(${r})`),t.code((0,ie._)`${Qe.default.errors}++`)}function Pl(t,e){let{gen:r,validateName:n,schemaEnv:a}=t;a.$async?r.throw((0,ie._)`new ${t.ValidationError}(${e})`):(r.assign((0,ie._)`${n}.errors`,e),r.return(!1))}var Er={keyword:new ie.Name("keyword"),schemaPath:new ie.Name("schemaPath"),params:new ie.Name("params"),propertyName:new ie.Name("propertyName"),message:new ie.Name("message"),schema:new ie.Name("schema"),parentSchema:new ie.Name("parentSchema")};function kl(t,e,r){let{createErrors:n}=t.it;return n===!1?(0,ie._)`{}`:Zd(t,e,r)}function Zd(t,e,r={}){let{gen:n,it:a}=t,s=[ef(a,r),tf(t,r)];return rf(t,e,s),n.object(...s)}function ef({errorPath:t},{instancePath:e}){let r=e?(0,ie.str)`${t}${(0,qa.getErrorPath)(e,qa.Type.Str)}`:t;return[Qe.default.instancePath,(0,ie.strConcat)(Qe.default.instancePath,r)]}function tf({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:n}){let a=n?e:(0,ie.str)`${e}/${t}`;return r&&(a=(0,ie.str)`${a}${(0,qa.getErrorPath)(r,qa.Type.Str)}`),[Er.schemaPath,a]}function rf(t,{params:e,message:r},n){let{keyword:a,data:s,schemaValue:i,it:c}=t,{opts:f,propertyName:y,topSchemaRef:h,schemaPath:E}=c;n.push([Er.keyword,a],[Er.params,typeof e=="function"?e(t):e||(0,ie._)`{}`]),f.messages&&n.push([Er.message,typeof r=="function"?r(t):r]),f.verbose&&n.push([Er.schema,i],[Er.parentSchema,(0,ie._)`${h}${E}`],[Qe.default.data,s]),y&&n.push([Er.propertyName,y])}});var Dl=x(Gr=>{"use strict";Object.defineProperty(Gr,"__esModule",{value:!0});Gr.boolOrEmptySchema=Gr.topBoolOrEmptySchema=void 0;var nf=In(),af=Z(),sf=Wt(),of={message:"boolean schema is false"};function lf(t){let{gen:e,schema:r,validateName:n}=t;r===!1?Il(t,!1):typeof r=="object"&&r.$async===!0?e.return(sf.default.data):(e.assign((0,af._)`${n}.errors`,null),e.return(!0))}Gr.topBoolOrEmptySchema=lf;function cf(t,e){let{gen:r,schema:n}=t;n===!1?(r.var(e,!1),Il(t)):r.var(e,!0)}Gr.boolOrEmptySchema=cf;function Il(t,e){let{gen:r,data:n}=t,a={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,nf.reportError)(a,of,void 0,e)}});var fi=x(zr=>{"use strict";Object.defineProperty(zr,"__esModule",{value:!0});zr.getRules=zr.isJSONType=void 0;var uf=["string","number","integer","boolean","null","object","array"],df=new Set(uf);function ff(t){return typeof t=="string"&&df.has(t)}zr.isJSONType=ff;function mf(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:dt(Pe({},t),{integer:!0,boolean:!0,null:!0}),rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}zr.getRules=mf});var mi=x(ir=>{"use strict";Object.defineProperty(ir,"__esModule",{value:!0});ir.shouldUseRule=ir.shouldUseGroup=ir.schemaHasRulesForType=void 0;function hf({schema:t,self:e},r){let n=e.RULES.types[r];return n&&n!==!0&&Nl(t,n)}ir.schemaHasRulesForType=hf;function Nl(t,e){return e.rules.some(r=>Rl(t,r))}ir.shouldUseGroup=Nl;function Rl(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}ir.shouldUseRule=Rl});var Nn=x(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0});qe.reportTypeError=qe.checkDataTypes=qe.checkDataType=qe.coerceAndCheckDataType=qe.getJSONTypes=qe.getSchemaTypes=qe.DataType=void 0;var pf=fi(),vf=mi(),gf=In(),W=Z(),Al=ue(),Dn;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(Dn=qe.DataType||(qe.DataType={}));function yf(t){let e=Ol(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}qe.getSchemaTypes=yf;function Ol(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(pf.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}qe.getJSONTypes=Ol;function _f(t,e){let{gen:r,data:n,opts:a}=t,s=bf(e,a.coerceTypes),i=e.length>0&&!(s.length===0&&e.length===1&&(0,vf.schemaHasRulesForType)(t,e[0]));if(i){let c=pi(e,n,a.strictNumbers,Dn.Wrong);r.if(c,()=>{s.length?Ef(t,e,s):vi(t)})}return i}qe.coerceAndCheckDataType=_f;var Ll=new Set(["string","number","integer","boolean","null"]);function bf(t,e){return e?t.filter(r=>Ll.has(r)||e==="array"&&r==="array"):[]}function Ef(t,e,r){let{gen:n,data:a,opts:s}=t,i=n.let("dataType",(0,W._)`typeof ${a}`),c=n.let("coerced",(0,W._)`undefined`);s.coerceTypes==="array"&&n.if((0,W._)`${i} == 'object' && Array.isArray(${a}) && ${a}.length == 1`,()=>n.assign(a,(0,W._)`${a}[0]`).assign(i,(0,W._)`typeof ${a}`).if(pi(e,a,s.strictNumbers),()=>n.assign(c,a))),n.if((0,W._)`${c} !== undefined`);for(let y of r)(Ll.has(y)||y==="array"&&s.coerceTypes==="array")&&f(y);n.else(),vi(t),n.endIf(),n.if((0,W._)`${c} !== undefined`,()=>{n.assign(a,c),$f(t,c)});function f(y){switch(y){case"string":n.elseIf((0,W._)`${i} == "number" || ${i} == "boolean"`).assign(c,(0,W._)`"" + ${a}`).elseIf((0,W._)`${a} === null`).assign(c,(0,W._)`""`);return;case"number":n.elseIf((0,W._)`${i} == "boolean" || ${a} === null
              || (${i} == "string" && ${a} && ${a} == +${a})`).assign(c,(0,W._)`+${a}`);return;case"integer":n.elseIf((0,W._)`${i} === "boolean" || ${a} === null
              || (${i} === "string" && ${a} && ${a} == +${a} && !(${a} % 1))`).assign(c,(0,W._)`+${a}`);return;case"boolean":n.elseIf((0,W._)`${a} === "false" || ${a} === 0 || ${a} === null`).assign(c,!1).elseIf((0,W._)`${a} === "true" || ${a} === 1`).assign(c,!0);return;case"null":n.elseIf((0,W._)`${a} === "" || ${a} === 0 || ${a} === false`),n.assign(c,null);return;case"array":n.elseIf((0,W._)`${i} === "string" || ${i} === "number"
              || ${i} === "boolean" || ${a} === null`).assign(c,(0,W._)`[${a}]`)}}}function $f({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,W._)`${e} !== undefined`,()=>t.assign((0,W._)`${e}[${r}]`,n))}function hi(t,e,r,n=Dn.Correct){let a=n===Dn.Correct?W.operators.EQ:W.operators.NEQ,s;switch(t){case"null":return(0,W._)`${e} ${a} null`;case"array":s=(0,W._)`Array.isArray(${e})`;break;case"object":s=(0,W._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":s=i((0,W._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":s=i();break;default:return(0,W._)`typeof ${e} ${a} ${t}`}return n===Dn.Correct?s:(0,W.not)(s);function i(c=W.nil){return(0,W.and)((0,W._)`typeof ${e} == "number"`,c,r?(0,W._)`isFinite(${e})`:W.nil)}}qe.checkDataType=hi;function pi(t,e,r,n){if(t.length===1)return hi(t[0],e,r,n);let a,s=(0,Al.toHash)(t);if(s.array&&s.object){let i=(0,W._)`typeof ${e} != "object"`;a=s.null?i:(0,W._)`!${e} || ${i}`,delete s.null,delete s.array,delete s.object}else a=W.nil;s.number&&delete s.integer;for(let i in s)a=(0,W.and)(a,hi(i,e,r,n));return a}qe.checkDataTypes=pi;var Sf={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,W._)`{type: ${t}}`:(0,W._)`{type: ${e}}`};function vi(t){let e=wf(t);(0,gf.reportError)(e,Sf)}qe.reportTypeError=vi;function wf(t){let{gen:e,data:r,schema:n}=t,a=(0,Al.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:a,schemaValue:a,parentSchema:n,params:{},it:t}}});var ql=x(ja=>{"use strict";Object.defineProperty(ja,"__esModule",{value:!0});ja.assignDefaults=void 0;var Kr=Z(),Cf=ue();function Tf(t,e){let{properties:r,items:n}=t.schema;if(e==="object"&&r)for(let a in r)xl(t,a,r[a].default);else e==="array"&&Array.isArray(n)&&n.forEach((a,s)=>xl(t,s,a.default))}ja.assignDefaults=Tf;function xl(t,e,r){let{gen:n,compositeRule:a,data:s,opts:i}=t;if(r===void 0)return;let c=(0,Kr._)`${s}${(0,Kr.getProperty)(e)}`;if(a){(0,Cf.checkStrictMode)(t,`default is ignored for: ${c}`);return}let f=(0,Kr._)`${c} === undefined`;i.useDefaults==="empty"&&(f=(0,Kr._)`${f} || ${c} === null || ${c} === ""`),n.if(f,(0,Kr._)`${c} = ${(0,Kr.stringify)(r)}`)}});var gt=x(ge=>{"use strict";Object.defineProperty(ge,"__esModule",{value:!0});ge.validateUnion=ge.validateArray=ge.usePattern=ge.callValidateCode=ge.schemaProperties=ge.allSchemaProperties=ge.noPropertyInData=ge.propertyInData=ge.isOwnProperty=ge.hasPropFunc=ge.reportMissingProp=ge.checkMissingProp=ge.checkReportMissingProp=void 0;var $e=Z(),gi=ue(),or=Wt(),Mf=ue();function Pf(t,e){let{gen:r,data:n,it:a}=t;r.if(_i(r,n,e,a.opts.ownProperties),()=>{t.setParams({missingProperty:(0,$e._)`${e}`},!0),t.error()})}ge.checkReportMissingProp=Pf;function kf({gen:t,data:e,it:{opts:r}},n,a){return(0,$e.or)(...n.map(s=>(0,$e.and)(_i(t,e,s,r.ownProperties),(0,$e._)`${a} = ${s}`)))}ge.checkMissingProp=kf;function If(t,e){t.setParams({missingProperty:e},!0),t.error()}ge.reportMissingProp=If;function jl(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,$e._)`Object.prototype.hasOwnProperty`})}ge.hasPropFunc=jl;function yi(t,e,r){return(0,$e._)`${jl(t)}.call(${e}, ${r})`}ge.isOwnProperty=yi;function Df(t,e,r,n){let a=(0,$e._)`${e}${(0,$e.getProperty)(r)} !== undefined`;return n?(0,$e._)`${a} && ${yi(t,e,r)}`:a}ge.propertyInData=Df;function _i(t,e,r,n){let a=(0,$e._)`${e}${(0,$e.getProperty)(r)} === undefined`;return n?(0,$e.or)(a,(0,$e.not)(yi(t,e,r))):a}ge.noPropertyInData=_i;function Fl(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}ge.allSchemaProperties=Fl;function Nf(t,e){return Fl(e).filter(r=>!(0,gi.alwaysValidSchema)(t,e[r]))}ge.schemaProperties=Nf;function Rf({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:a,errorPath:s},it:i},c,f,y){let h=y?(0,$e._)`${t}, ${e}, ${n}${a}`:e,E=[[or.default.instancePath,(0,$e.strConcat)(or.default.instancePath,s)],[or.default.parentData,i.parentData],[or.default.parentDataProperty,i.parentDataProperty],[or.default.rootData,or.default.rootData]];i.opts.dynamicRef&&E.push([or.default.dynamicAnchors,or.default.dynamicAnchors]);let b=(0,$e._)`${h}, ${r.object(...E)}`;return f!==$e.nil?(0,$e._)`${c}.call(${f}, ${b})`:(0,$e._)`${c}(${b})`}ge.callValidateCode=Rf;var Af=(0,$e._)`new RegExp`;function Of({gen:t,it:{opts:e}},r){let n=e.unicodeRegExp?"u":"",{regExp:a}=e.code,s=a(r,n);return t.scopeValue("pattern",{key:s.toString(),ref:s,code:(0,$e._)`${a.code==="new RegExp"?Af:(0,Mf.useFunc)(t,a)}(${r}, ${n})`})}ge.usePattern=Of;function Lf(t){let{gen:e,data:r,keyword:n,it:a}=t,s=e.name("valid");if(a.allErrors){let c=e.let("valid",!0);return i(()=>e.assign(c,!1)),c}return e.var(s,!0),i(()=>e.break()),s;function i(c){let f=e.const("len",(0,$e._)`${r}.length`);e.forRange("i",0,f,y=>{t.subschema({keyword:n,dataProp:y,dataPropType:gi.Type.Num},s),e.if((0,$e.not)(s),c)})}}ge.validateArray=Lf;function xf(t){let{gen:e,schema:r,keyword:n,it:a}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(f=>(0,gi.alwaysValidSchema)(a,f))&&!a.opts.unevaluated)return;let i=e.let("valid",!1),c=e.name("_valid");e.block(()=>r.forEach((f,y)=>{let h=t.subschema({keyword:n,schemaProp:y,compositeRule:!0},c);e.assign(i,(0,$e._)`${i} || ${c}`),t.mergeValidEvaluated(h,c)||e.if((0,$e.not)(i))})),t.result(i,()=>t.reset(),()=>t.error(!0))}ge.validateUnion=xf});var Bl=x(qt=>{"use strict";Object.defineProperty(qt,"__esModule",{value:!0});qt.validateKeywordUsage=qt.validSchemaType=qt.funcKeywordCode=qt.macroKeywordCode=void 0;var Xe=Z(),$r=Wt(),qf=gt(),jf=In();function Ff(t,e){let{gen:r,keyword:n,schema:a,parentSchema:s,it:i}=t,c=e.macro.call(i.self,a,s,i),f=Hl(r,n,c);i.opts.validateSchema!==!1&&i.self.validateSchema(c,!0);let y=r.name("valid");t.subschema({schema:c,schemaPath:Xe.nil,errSchemaPath:`${i.errSchemaPath}/${n}`,topSchemaRef:f,compositeRule:!0},y),t.pass(y,()=>t.error(!0))}qt.macroKeywordCode=Ff;function Vf(t,e){var r;let{gen:n,keyword:a,schema:s,parentSchema:i,$data:c,it:f}=t;Bf(f,e);let y=!c&&e.compile?e.compile.call(f.self,s,i,f):e.validate,h=Hl(n,a,y),E=n.let("valid");t.block$data(E,b),t.ok((r=e.valid)!==null&&r!==void 0?r:E);function b(){if(e.errors===!1)T(),e.modifying&&Vl(t),N(()=>t.error());else{let R=e.async?$():C();e.modifying&&Vl(t),N(()=>Hf(t,R))}}function $(){let R=n.let("ruleErrs",null);return n.try(()=>T((0,Xe._)`await `),U=>n.assign(E,!1).if((0,Xe._)`${U} instanceof ${f.ValidationError}`,()=>n.assign(R,(0,Xe._)`${U}.errors`),()=>n.throw(U))),R}function C(){let R=(0,Xe._)`${h}.errors`;return n.assign(R,null),T(Xe.nil),R}function T(R=e.async?(0,Xe._)`await `:Xe.nil){let U=f.opts.passContext?$r.default.this:$r.default.self,F=!("compile"in e&&!c||e.schema===!1);n.assign(E,(0,Xe._)`${R}${(0,qf.callValidateCode)(t,h,U,F)}`,e.modifying)}function N(R){var U;n.if((0,Xe.not)((U=e.valid)!==null&&U!==void 0?U:E),R)}}qt.funcKeywordCode=Vf;function Vl(t){let{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,Xe._)`${n.parentData}[${n.parentDataProperty}]`))}function Hf(t,e){let{gen:r}=t;r.if((0,Xe._)`Array.isArray(${e})`,()=>{r.assign($r.default.vErrors,(0,Xe._)`${$r.default.vErrors} === null ? ${e} : ${$r.default.vErrors}.concat(${e})`).assign($r.default.errors,(0,Xe._)`${$r.default.vErrors}.length`),(0,jf.extendErrors)(t)},()=>t.error())}function Bf({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function Hl(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,Xe.stringify)(r)})}function Uf(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}qt.validSchemaType=Uf;function Gf({schema:t,opts:e,self:r,errSchemaPath:n},a,s){if(Array.isArray(a.keyword)?!a.keyword.includes(s):a.keyword!==s)throw new Error("ajv implementation error");let i=a.dependencies;if(i!=null&&i.some(c=>!Object.prototype.hasOwnProperty.call(t,c)))throw new Error(`parent schema must have dependencies of ${s}: ${i.join(",")}`);if(a.validateSchema&&!a.validateSchema(t[s])){let f=`keyword "${s}" value is invalid at path "${n}": `+r.errorsText(a.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(f);else throw new Error(f)}}qt.validateKeywordUsage=Gf});var Gl=x(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.extendSubschemaMode=lr.extendSubschemaData=lr.getSubschema=void 0;var jt=Z(),Ul=ue();function zf(t,{keyword:e,schemaProp:r,schema:n,schemaPath:a,errSchemaPath:s,topSchemaRef:i}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let c=t.schema[e];return r===void 0?{schema:c,schemaPath:(0,jt._)`${t.schemaPath}${(0,jt.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:c[r],schemaPath:(0,jt._)`${t.schemaPath}${(0,jt.getProperty)(e)}${(0,jt.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,Ul.escapeFragment)(r)}`}}if(n!==void 0){if(a===void 0||s===void 0||i===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:a,topSchemaRef:i,errSchemaPath:s}}throw new Error('either "keyword" or "schema" must be passed')}lr.getSubschema=zf;function Kf(t,e,{dataProp:r,dataPropType:n,data:a,dataTypes:s,propertyName:i}){if(a!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:c}=e;if(r!==void 0){let{errorPath:y,dataPathArr:h,opts:E}=e,b=c.let("data",(0,jt._)`${e.data}${(0,jt.getProperty)(r)}`,!0);f(b),t.errorPath=(0,jt.str)`${y}${(0,Ul.getErrorPath)(r,n,E.jsPropertySyntax)}`,t.parentDataProperty=(0,jt._)`${r}`,t.dataPathArr=[...h,t.parentDataProperty]}if(a!==void 0){let y=a instanceof jt.Name?a:c.let("data",a,!0);f(y),i!==void 0&&(t.propertyName=i)}s&&(t.dataTypes=s);function f(y){t.data=y,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,y]}}lr.extendSubschemaData=Kf;function Wf(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:a,allErrors:s}){n!==void 0&&(t.compositeRule=n),a!==void 0&&(t.createErrors=a),s!==void 0&&(t.allErrors=s),t.jtdDiscriminator=e,t.jtdMetadata=r}lr.extendSubschemaMode=Wf});var bi=x((By,zl)=>{"use strict";zl.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,a,s;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(a=n;a--!==0;)if(!t(e[a],r[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(r).length)return!1;for(a=n;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,s[a]))return!1;for(a=n;a--!==0;){var i=s[a];if(!t(e[i],r[i]))return!1}return!0}return e!==e&&r!==r}});var Wl=x((Uy,Kl)=>{"use strict";var cr=Kl.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},a=r.post||function(){};Fa(e,n,a,t,"",t)};cr.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};cr.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};cr.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};cr.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Fa(t,e,r,n,a,s,i,c,f,y){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,a,s,i,c,f,y);for(var h in n){var E=n[h];if(Array.isArray(E)){if(h in cr.arrayKeywords)for(var b=0;b<E.length;b++)Fa(t,e,r,E[b],a+"/"+h+"/"+b,s,a,h,n,b)}else if(h in cr.propsKeywords){if(E&&typeof E=="object")for(var $ in E)Fa(t,e,r,E[$],a+"/"+h+"/"+Yf($),s,a,h,n,$)}else(h in cr.keywords||t.allKeys&&!(h in cr.skipKeywords))&&Fa(t,e,r,E,a+"/"+h,s,a,h,n)}r(n,a,s,i,c,f,y)}}function Yf(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var Rn=x(it=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0});it.getSchemaRefs=it.resolveUrl=it.normalizeId=it._getFullPath=it.getFullPath=it.inlineRef=void 0;var Jf=ue(),Qf=bi(),Xf=Wl(),Zf=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function em(t,e=!0){return typeof t=="boolean"?!0:e===!0?!Ei(t):e?Yl(t)<=e:!1}it.inlineRef=em;var tm=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Ei(t){for(let e in t){if(tm.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(Ei)||typeof r=="object"&&Ei(r))return!0}return!1}function Yl(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!Zf.has(r)&&(typeof t[r]=="object"&&(0,Jf.eachItem)(t[r],n=>e+=Yl(n)),e===1/0))return 1/0}return e}function Jl(t,e="",r){r!==!1&&(e=Wr(e));let n=t.parse(e);return Ql(t,n)}it.getFullPath=Jl;function Ql(t,e){return t.serialize(e).split("#")[0]+"#"}it._getFullPath=Ql;var rm=/#\/?$/;function Wr(t){return t?t.replace(rm,""):""}it.normalizeId=Wr;function nm(t,e,r){return r=Wr(r),t.resolve(e,r)}it.resolveUrl=nm;var am=/^[a-z_][-a-z0-9._]*$/i;function sm(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,a=Wr(t[r]||e),s={"":a},i=Jl(n,a,!1),c={},f=new Set;return Xf(t,{allKeys:!0},(E,b,$,C)=>{if(C===void 0)return;let T=i+b,N=s[C];typeof E[r]=="string"&&(N=R.call(this,E[r])),U.call(this,E.$anchor),U.call(this,E.$dynamicAnchor),s[b]=N;function R(F){let oe=this.opts.uriResolver.resolve;if(F=Wr(N?oe(N,F):F),f.has(F))throw h(F);f.add(F);let B=this.refs[F];return typeof B=="string"&&(B=this.refs[B]),typeof B=="object"?y(E,B.schema,F):F!==Wr(T)&&(F[0]==="#"?(y(E,c[F],F),c[F]=E):this.refs[F]=T),F}function U(F){if(typeof F=="string"){if(!am.test(F))throw new Error(`invalid anchor "${F}"`);R.call(this,`#${F}`)}}}),c;function y(E,b,$){if(b!==void 0&&!Qf(E,b))throw h($)}function h(E){return new Error(`reference "${E}" resolves to more than one schema`)}}it.getSchemaRefs=sm});var Ln=x(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});ur.getData=ur.KeywordCxt=ur.validateFunctionCode=void 0;var nc=Dl(),Xl=Nn(),Si=mi(),Va=Nn(),im=ql(),On=Bl(),$i=Gl(),V=Z(),G=Wt(),om=Rn(),Yt=ue(),An=In();function lm(t){if(ic(t)&&(oc(t),sc(t))){dm(t);return}ac(t,()=>(0,nc.topBoolOrEmptySchema)(t))}ur.validateFunctionCode=lm;function ac({gen:t,validateName:e,schema:r,schemaEnv:n,opts:a},s){a.code.es5?t.func(e,(0,V._)`${G.default.data}, ${G.default.valCxt}`,n.$async,()=>{t.code((0,V._)`"use strict"; ${Zl(r,a)}`),um(t,a),t.code(s)}):t.func(e,(0,V._)`${G.default.data}, ${cm(a)}`,n.$async,()=>t.code(Zl(r,a)).code(s))}function cm(t){return(0,V._)`{${G.default.instancePath}="", ${G.default.parentData}, ${G.default.parentDataProperty}, ${G.default.rootData}=${G.default.data}${t.dynamicRef?(0,V._)`, ${G.default.dynamicAnchors}={}`:V.nil}}={}`}function um(t,e){t.if(G.default.valCxt,()=>{t.var(G.default.instancePath,(0,V._)`${G.default.valCxt}.${G.default.instancePath}`),t.var(G.default.parentData,(0,V._)`${G.default.valCxt}.${G.default.parentData}`),t.var(G.default.parentDataProperty,(0,V._)`${G.default.valCxt}.${G.default.parentDataProperty}`),t.var(G.default.rootData,(0,V._)`${G.default.valCxt}.${G.default.rootData}`),e.dynamicRef&&t.var(G.default.dynamicAnchors,(0,V._)`${G.default.valCxt}.${G.default.dynamicAnchors}`)},()=>{t.var(G.default.instancePath,(0,V._)`""`),t.var(G.default.parentData,(0,V._)`undefined`),t.var(G.default.parentDataProperty,(0,V._)`undefined`),t.var(G.default.rootData,G.default.data),e.dynamicRef&&t.var(G.default.dynamicAnchors,(0,V._)`{}`)})}function dm(t){let{schema:e,opts:r,gen:n}=t;ac(t,()=>{r.$comment&&e.$comment&&cc(t),vm(t),n.let(G.default.vErrors,null),n.let(G.default.errors,0),r.unevaluated&&fm(t),lc(t),_m(t)})}function fm(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,V._)`${r}.evaluated`),e.if((0,V._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,V._)`${t.evaluated}.props`,(0,V._)`undefined`)),e.if((0,V._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,V._)`${t.evaluated}.items`,(0,V._)`undefined`))}function Zl(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,V._)`/*# sourceURL=${r} */`:V.nil}function mm(t,e){if(ic(t)&&(oc(t),sc(t))){hm(t,e);return}(0,nc.boolOrEmptySchema)(t,e)}function sc({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function ic(t){return typeof t.schema!="boolean"}function hm(t,e){let{schema:r,gen:n,opts:a}=t;a.$comment&&r.$comment&&cc(t),gm(t),ym(t);let s=n.const("_errs",G.default.errors);lc(t,s),n.var(e,(0,V._)`${s} === ${G.default.errors}`)}function oc(t){(0,Yt.checkUnknownRules)(t),pm(t)}function lc(t,e){if(t.opts.jtd)return ec(t,[],!1,e);let r=(0,Xl.getSchemaTypes)(t.schema),n=(0,Xl.coerceAndCheckDataType)(t,r);ec(t,r,!n,e)}function pm(t){let{schema:e,errSchemaPath:r,opts:n,self:a}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,Yt.schemaHasRulesButRef)(e,a.RULES)&&a.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function vm(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,Yt.checkStrictMode)(t,"default is ignored in the schema root")}function gm(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,om.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function ym(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function cc({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:a}){let s=r.$comment;if(a.$comment===!0)t.code((0,V._)`${G.default.self}.logger.log(${s})`);else if(typeof a.$comment=="function"){let i=(0,V.str)`${n}/$comment`,c=t.scopeValue("root",{ref:e.root});t.code((0,V._)`${G.default.self}.opts.$comment(${s}, ${i}, ${c}.schema)`)}}function _m(t){let{gen:e,schemaEnv:r,validateName:n,ValidationError:a,opts:s}=t;r.$async?e.if((0,V._)`${G.default.errors} === 0`,()=>e.return(G.default.data),()=>e.throw((0,V._)`new ${a}(${G.default.vErrors})`)):(e.assign((0,V._)`${n}.errors`,G.default.vErrors),s.unevaluated&&bm(t),e.return((0,V._)`${G.default.errors} === 0`))}function bm({gen:t,evaluated:e,props:r,items:n}){r instanceof V.Name&&t.assign((0,V._)`${e}.props`,r),n instanceof V.Name&&t.assign((0,V._)`${e}.items`,n)}function ec(t,e,r,n){let{gen:a,schema:s,data:i,allErrors:c,opts:f,self:y}=t,{RULES:h}=y;if(s.$ref&&(f.ignoreKeywordsWithRef||!(0,Yt.schemaHasRulesButRef)(s,h))){a.block(()=>uc(t,"$ref",h.all.$ref.definition));return}f.jtd||Em(t,e),a.block(()=>{for(let b of h.rules)E(b);E(h.post)});function E(b){!(0,Si.shouldUseGroup)(s,b)||(b.type?(a.if((0,Va.checkDataType)(b.type,i,f.strictNumbers)),tc(t,b),e.length===1&&e[0]===b.type&&r&&(a.else(),(0,Va.reportTypeError)(t)),a.endIf()):tc(t,b),c||a.if((0,V._)`${G.default.errors} === ${n||0}`))}}function tc(t,e){let{gen:r,schema:n,opts:{useDefaults:a}}=t;a&&(0,im.assignDefaults)(t,e.type),r.block(()=>{for(let s of e.rules)(0,Si.shouldUseRule)(n,s)&&uc(t,s.keyword,s.definition,e.type)})}function Em(t,e){t.schemaEnv.meta||!t.opts.strictTypes||($m(t,e),t.opts.allowUnionTypes||Sm(t,e),wm(t,t.dataTypes))}function $m(t,e){if(!!e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{rc(t.dataTypes,r)||wi(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),t.dataTypes=t.dataTypes.filter(r=>rc(e,r))}}function Sm(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&wi(t,"use allowUnionTypes to allow union type keyword")}function wm(t,e){let r=t.self.RULES.all;for(let n in r){let a=r[n];if(typeof a=="object"&&(0,Si.shouldUseRule)(t.schema,a)){let{type:s}=a.definition;s.length&&!s.some(i=>Cm(e,i))&&wi(t,`missing type "${s.join(",")}" for keyword "${n}"`)}}}function Cm(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function rc(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function wi(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,Yt.checkStrictMode)(t,e,t.opts.strictTypes)}var Ha=class{constructor(e,r,n){if((0,On.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,Yt.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",dc(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,On.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",G.default.errors))}result(e,r,n){this.failResult((0,V.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,V.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,V._)`${r} !== undefined && (${(0,V.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?An.reportExtraError:An.reportError)(this,this.def.error,r)}$dataError(){(0,An.reportError)(this,this.def.$dataError||An.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,An.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=V.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=V.nil,r=V.nil){if(!this.$data)return;let{gen:n,schemaCode:a,schemaType:s,def:i}=this;n.if((0,V.or)((0,V._)`${a} === undefined`,r)),e!==V.nil&&n.assign(e,!0),(s.length||i.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==V.nil&&n.assign(e,!1)),n.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:n,def:a,it:s}=this;return(0,V.or)(i(),c());function i(){if(n.length){if(!(r instanceof V.Name))throw new Error("ajv implementation error");let f=Array.isArray(n)?n:[n];return(0,V._)`${(0,Va.checkDataTypes)(f,r,s.opts.strictNumbers,Va.DataType.Wrong)}`}return V.nil}function c(){if(a.validateSchema){let f=e.scopeValue("validate$data",{ref:a.validateSchema});return(0,V._)`!${f}(${r})`}return V.nil}}subschema(e,r){let n=(0,$i.getSubschema)(this.it,e);(0,$i.extendSubschemaData)(n,this.it,e),(0,$i.extendSubschemaMode)(n,e);let a=dt(Pe(Pe({},this.it),n),{items:void 0,props:void 0});return mm(a,r),a}mergeEvaluated(e,r){let{it:n,gen:a}=this;!n.opts.unevaluated||(n.props!==!0&&e.props!==void 0&&(n.props=Yt.mergeEvaluated.props(a,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=Yt.mergeEvaluated.items(a,e.items,n.items,r)))}mergeValidEvaluated(e,r){let{it:n,gen:a}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return a.if(r,()=>this.mergeEvaluated(e,V.Name)),!0}};ur.KeywordCxt=Ha;function uc(t,e,r,n){let a=new Ha(t,r,e);"code"in r?r.code(a,n):a.$data&&r.validate?(0,On.funcKeywordCode)(a,r):"macro"in r?(0,On.macroKeywordCode)(a,r):(r.compile||r.validate)&&(0,On.funcKeywordCode)(a,r)}var Tm=/^\/(?:[^~]|~0|~1)*$/,Mm=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function dc(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let a,s;if(t==="")return G.default.rootData;if(t[0]==="/"){if(!Tm.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);a=t,s=G.default.rootData}else{let y=Mm.exec(t);if(!y)throw new Error(`Invalid JSON-pointer: ${t}`);let h=+y[1];if(a=y[2],a==="#"){if(h>=e)throw new Error(f("property/index",h));return n[e-h]}if(h>e)throw new Error(f("data",h));if(s=r[e-h],!a)return s}let i=s,c=a.split("/");for(let y of c)y&&(s=(0,V._)`${s}${(0,V.getProperty)((0,Yt.unescapeJsonPointer)(y))}`,i=(0,V._)`${i} && ${s}`);return i;function f(y,h){return`Cannot access ${y} ${h} levels up, current level is ${e}`}}ur.getData=dc});var Ba=x(Ti=>{"use strict";Object.defineProperty(Ti,"__esModule",{value:!0});var Ci=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};Ti.default=Ci});var Ua=x(ki=>{"use strict";Object.defineProperty(ki,"__esModule",{value:!0});var Mi=Rn(),Pi=class extends Error{constructor(e,r,n,a){super(a||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,Mi.resolveUrl)(e,r,n),this.missingSchema=(0,Mi.normalizeId)((0,Mi.getFullPath)(e,this.missingRef))}};ki.default=Pi});var za=x(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.resolveSchema=yt.getCompilingSchema=yt.resolveRef=yt.compileSchema=yt.SchemaEnv=void 0;var Mt=Z(),Pm=Ba(),Sr=Wt(),Pt=Rn(),fc=ue(),km=Ln(),Yr=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,Pt.normalizeId)(n==null?void 0:n[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n==null?void 0:n.$async,this.refs={}}};yt.SchemaEnv=Yr;function Di(t){let e=mc.call(this,t);if(e)return e;let r=(0,Pt.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:a}=this.opts.code,{ownProperties:s}=this.opts,i=new Mt.CodeGen(this.scope,{es5:n,lines:a,ownProperties:s}),c;t.$async&&(c=i.scopeValue("Error",{ref:Pm.default,code:(0,Mt._)`require("ajv/dist/runtime/validation_error").default`}));let f=i.scopeName("validate");t.validateName=f;let y={gen:i,allErrors:this.opts.allErrors,data:Sr.default.data,parentData:Sr.default.parentData,parentDataProperty:Sr.default.parentDataProperty,dataNames:[Sr.default.data],dataPathArr:[Mt.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,Mt.stringify)(t.schema)}:{ref:t.schema}),validateName:f,ValidationError:c,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:Mt.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,Mt._)`""`,opts:this.opts,self:this},h;try{this._compilations.add(t),(0,km.validateFunctionCode)(y),i.optimize(this.opts.code.optimize);let E=i.toString();h=`${i.scopeRefs(Sr.default.scope)}return ${E}`,this.opts.code.process&&(h=this.opts.code.process(h,t));let $=new Function(`${Sr.default.self}`,`${Sr.default.scope}`,h)(this,this.scope.get());if(this.scope.value(f,{ref:$}),$.errors=null,$.schema=t.schema,$.schemaEnv=t,t.$async&&($.$async=!0),this.opts.code.source===!0&&($.source={validateName:f,validateCode:E,scopeValues:i._values}),this.opts.unevaluated){let{props:C,items:T}=y;$.evaluated={props:C instanceof Mt.Name?void 0:C,items:T instanceof Mt.Name?void 0:T,dynamicProps:C instanceof Mt.Name,dynamicItems:T instanceof Mt.Name},$.source&&($.source.evaluated=(0,Mt.stringify)($.evaluated))}return t.validate=$,t}catch(E){throw delete t.validate,delete t.validateName,h&&this.logger.error("Error compiling schema, function code:",h),E}finally{this._compilations.delete(t)}}yt.compileSchema=Di;function Im(t,e,r){var n;r=(0,Pt.resolveUrl)(this.opts.uriResolver,e,r);let a=t.refs[r];if(a)return a;let s=Rm.call(this,t,r);if(s===void 0){let i=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:c}=this.opts;i&&(s=new Yr({schema:i,schemaId:c,root:t,baseId:e}))}if(s!==void 0)return t.refs[r]=Dm.call(this,s)}yt.resolveRef=Im;function Dm(t){return(0,Pt.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:Di.call(this,t)}function mc(t){for(let e of this._compilations)if(Nm(e,t))return e}yt.getCompilingSchema=mc;function Nm(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function Rm(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||Ga.call(this,t,e)}function Ga(t,e){let r=this.opts.uriResolver.parse(e),n=(0,Pt._getFullPath)(this.opts.uriResolver,r),a=(0,Pt.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===a)return Ii.call(this,r,t);let s=(0,Pt.normalizeId)(n),i=this.refs[s]||this.schemas[s];if(typeof i=="string"){let c=Ga.call(this,t,i);return typeof(c==null?void 0:c.schema)!="object"?void 0:Ii.call(this,r,c)}if(typeof(i==null?void 0:i.schema)=="object"){if(i.validate||Di.call(this,i),s===(0,Pt.normalizeId)(e)){let{schema:c}=i,{schemaId:f}=this.opts,y=c[f];return y&&(a=(0,Pt.resolveUrl)(this.opts.uriResolver,a,y)),new Yr({schema:c,schemaId:f,root:t,baseId:a})}return Ii.call(this,r,i)}}yt.resolveSchema=Ga;var Am=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Ii(t,{baseId:e,schema:r,root:n}){var a;if(((a=t.fragment)===null||a===void 0?void 0:a[0])!=="/")return;for(let c of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let f=r[(0,fc.unescapeFragment)(c)];if(f===void 0)return;r=f;let y=typeof r=="object"&&r[this.opts.schemaId];!Am.has(c)&&y&&(e=(0,Pt.resolveUrl)(this.opts.uriResolver,e,y))}let s;if(typeof r!="boolean"&&r.$ref&&!(0,fc.schemaHasRulesButRef)(r,this.RULES)){let c=(0,Pt.resolveUrl)(this.opts.uriResolver,e,r.$ref);s=Ga.call(this,n,c)}let{schemaId:i}=this.opts;if(s=s||new Yr({schema:r,schemaId:i,root:n,baseId:e}),s.schema!==s.root.schema)return s}});var hc=x((Qy,Om)=>{Om.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var vc=x((Ka,pc)=>{(function(t,e){typeof Ka=="object"&&typeof pc<"u"?e(Ka):typeof define=="function"&&define.amd?define(["exports"],e):e(t.URI=t.URI||{})})(Ka,function(t){"use strict";function e(){for(var m=arguments.length,u=Array(m),p=0;p<m;p++)u[p]=arguments[p];if(u.length>1){u[0]=u[0].slice(0,-1);for(var S=u.length-1,w=1;w<S;++w)u[w]=u[w].slice(1,-1);return u[S]=u[S].slice(1),u.join("")}else return u[0]}function r(m){return"(?:"+m+")"}function n(m){return m===void 0?"undefined":m===null?"null":Object.prototype.toString.call(m).split(" ").pop().split("]").shift().toLowerCase()}function a(m){return m.toUpperCase()}function s(m){return m!=null?m instanceof Array?m:typeof m.length!="number"||m.split||m.setInterval||m.call?[m]:Array.prototype.slice.call(m):[]}function i(m,u){var p=m;if(u)for(var S in u)p[S]=u[S];return p}function c(m){var u="[A-Za-z]",p="[\\x0D]",S="[0-9]",w="[\\x22]",L=e(S,"[A-Fa-f]"),K="[\\x0A]",re="[\\x20]",de=r(r("%[EFef]"+L+"%"+L+L+"%"+L+L)+"|"+r("%[89A-Fa-f]"+L+"%"+L+L)+"|"+r("%"+L+L)),Ce="[\\:\\/\\?\\#\\[\\]\\@]",ee="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",be=e(Ce,ee),Te=m?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",_e=m?"[\\uE000-\\uF8FF]":"[]",se=e(u,S,"[\\-\\.\\_\\~]",Te),Ee=r(u+e(u,S,"[\\+\\-\\.]")+"*"),me=r(r(de+"|"+e(se,ee,"[\\:]"))+"*"),Ht=r(r("25[0-5]")+"|"+r("2[0-4]"+S)+"|"+r("1"+S+S)+"|"+r("[1-9]"+S)+"|"+S),Ve=r(r("25[0-5]")+"|"+r("2[0-4]"+S)+"|"+r("1"+S+S)+"|"+r("0?[1-9]"+S)+"|0?0?"+S),Re=r(Ve+"\\."+Ve+"\\."+Ve+"\\."+Ve),he=r(L+"{1,4}"),Ne=r(r(he+"\\:"+he)+"|"+Re),rt=r(r(he+"\\:")+"{6}"+Ne),ze=r("\\:\\:"+r(he+"\\:")+"{5}"+Ne),St=r(r(he)+"?\\:\\:"+r(he+"\\:")+"{4}"+Ne),wt=r(r(r(he+"\\:")+"{0,1}"+he)+"?\\:\\:"+r(he+"\\:")+"{3}"+Ne),fr=r(r(r(he+"\\:")+"{0,2}"+he)+"?\\:\\:"+r(he+"\\:")+"{2}"+Ne),rr=r(r(r(he+"\\:")+"{0,3}"+he)+"?\\:\\:"+he+"\\:"+Ne),Dr=r(r(r(he+"\\:")+"{0,4}"+he)+"?\\:\\:"+Ne),nr=r(r(r(he+"\\:")+"{0,5}"+he)+"?\\:\\:"+he),o=r(r(r(he+"\\:")+"{0,6}"+he)+"?\\:\\:"),d=r([rt,ze,St,wt,fr,rr,Dr,nr,o].join("|")),l=r(r(se+"|"+de)+"+"),g=r(d+"\\%25"+l),_=r(d+r("\\%25|\\%(?!"+L+"{2})")+l),v=r("[vV]"+L+"+\\."+e(se,ee,"[\\:]")+"+"),M=r("\\["+r(_+"|"+d+"|"+v)+"\\]"),P=r(r(de+"|"+e(se,ee))+"*"),I=r(M+"|"+Re+"(?!"+P+")|"+P),D=r(S+"*"),A=r(r(me+"@")+"?"+I+r("\\:"+D)+"?"),j=r(de+"|"+e(se,ee,"[\\:\\@]")),Y=r(j+"*"),le=r(j+"+"),fe=r(r(de+"|"+e(se,ee,"[\\@]"))+"+"),pe=r(r("\\/"+Y)+"*"),ve=r("\\/"+r(le+pe)+"?"),He=r(fe+pe),Nt=r(le+pe),Rt="(?!"+j+")",wo=r(pe+"|"+ve+"|"+He+"|"+Nt+"|"+Rt),At=r(r(j+"|"+e("[\\/\\?]",_e))+"*"),Nr=r(r(j+"|[\\/\\?]")+"*"),ma=r(r("\\/\\/"+A+pe)+"|"+ve+"|"+Nt+"|"+Rt),_s=r(Ee+"\\:"+ma+r("\\?"+At)+"?"+r("\\#"+Nr)+"?"),ha=r(r("\\/\\/"+A+pe)+"|"+ve+"|"+He+"|"+Rt),Ou=r(ha+r("\\?"+At)+"?"+r("\\#"+Nr)+"?"),_v=r(_s+"|"+Ou),bv=r(Ee+"\\:"+ma+r("\\?"+At)+"?"),Ev="^("+Ee+")\\:"+r(r("\\/\\/("+r("("+me+")@")+"?("+I+")"+r("\\:("+D+")")+"?)")+"?("+pe+"|"+ve+"|"+Nt+"|"+Rt+")")+r("\\?("+At+")")+"?"+r("\\#("+Nr+")")+"?$",$v="^(){0}"+r(r("\\/\\/("+r("("+me+")@")+"?("+I+")"+r("\\:("+D+")")+"?)")+"?("+pe+"|"+ve+"|"+He+"|"+Rt+")")+r("\\?("+At+")")+"?"+r("\\#("+Nr+")")+"?$",Sv="^("+Ee+")\\:"+r(r("\\/\\/("+r("("+me+")@")+"?("+I+")"+r("\\:("+D+")")+"?)")+"?("+pe+"|"+ve+"|"+Nt+"|"+Rt+")")+r("\\?("+At+")")+"?$",wv="^"+r("\\#("+Nr+")")+"?$",Cv="^"+r("("+me+")@")+"?("+I+")"+r("\\:("+D+")")+"?$";return{NOT_SCHEME:new RegExp(e("[^]",u,S,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(e("[^\\%\\:]",se,ee),"g"),NOT_HOST:new RegExp(e("[^\\%\\[\\]\\:]",se,ee),"g"),NOT_PATH:new RegExp(e("[^\\%\\/\\:\\@]",se,ee),"g"),NOT_PATH_NOSCHEME:new RegExp(e("[^\\%\\/\\@]",se,ee),"g"),NOT_QUERY:new RegExp(e("[^\\%]",se,ee,"[\\:\\@\\/\\?]",_e),"g"),NOT_FRAGMENT:new RegExp(e("[^\\%]",se,ee,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(e("[^]",se,ee),"g"),UNRESERVED:new RegExp(se,"g"),OTHER_CHARS:new RegExp(e("[^\\%]",se,be),"g"),PCT_ENCODED:new RegExp(de,"g"),IPV4ADDRESS:new RegExp("^("+Re+")$"),IPV6ADDRESS:new RegExp("^\\[?("+d+")"+r(r("\\%25|\\%(?!"+L+"{2})")+"("+l+")")+"?\\]?$")}}var f=c(!1),y=c(!0),h=function(){function m(u,p){var S=[],w=!0,L=!1,K=void 0;try{for(var re=u[Symbol.iterator](),de;!(w=(de=re.next()).done)&&(S.push(de.value),!(p&&S.length===p));w=!0);}catch(Ce){L=!0,K=Ce}finally{try{!w&&re.return&&re.return()}finally{if(L)throw K}}return S}return function(u,p){if(Array.isArray(u))return u;if(Symbol.iterator in Object(u))return m(u,p);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),E=function(m){if(Array.isArray(m)){for(var u=0,p=Array(m.length);u<m.length;u++)p[u]=m[u];return p}else return Array.from(m)},b=2147483647,$=36,C=1,T=26,N=38,R=700,U=72,F=128,oe="-",B=/^xn--/,O=/[^\0-\x7E]/,J=/[\x2E\u3002\uFF0E\uFF61]/g,z={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},te=$-C,ae=Math.floor,Me=String.fromCharCode;function Se(m){throw new RangeError(z[m])}function Ae(m,u){for(var p=[],S=m.length;S--;)p[S]=u(m[S]);return p}function Ze(m,u){var p=m.split("@"),S="";p.length>1&&(S=p[0]+"@",m=p[1]),m=m.replace(J,".");var w=m.split("."),L=Ae(w,u).join(".");return S+L}function Jt(m){for(var u=[],p=0,S=m.length;p<S;){var w=m.charCodeAt(p++);if(w>=55296&&w<=56319&&p<S){var L=m.charCodeAt(p++);(L&64512)==56320?u.push(((w&1023)<<10)+(L&1023)+65536):(u.push(w),p--)}else u.push(w)}return u}var Mr=function(u){return String.fromCodePoint.apply(String,E(u))},tn=function(u){return u-48<10?u-22:u-65<26?u-65:u-97<26?u-97:$},Vt=function(u,p){return u+22+75*(u<26)-((p!=0)<<5)},rn=function(u,p,S){var w=0;for(u=S?ae(u/R):u>>1,u+=ae(u/p);u>te*T>>1;w+=$)u=ae(u/te);return ae(w+(te+1)*u/(u+N))},Jn=function(u){var p=[],S=u.length,w=0,L=F,K=U,re=u.lastIndexOf(oe);re<0&&(re=0);for(var de=0;de<re;++de)u.charCodeAt(de)>=128&&Se("not-basic"),p.push(u.charCodeAt(de));for(var Ce=re>0?re+1:0;Ce<S;){for(var ee=w,be=1,Te=$;;Te+=$){Ce>=S&&Se("invalid-input");var _e=tn(u.charCodeAt(Ce++));(_e>=$||_e>ae((b-w)/be))&&Se("overflow"),w+=_e*be;var se=Te<=K?C:Te>=K+T?T:Te-K;if(_e<se)break;var Ee=$-se;be>ae(b/Ee)&&Se("overflow"),be*=Ee}var me=p.length+1;K=rn(w-ee,me,ee==0),ae(w/me)>b-L&&Se("overflow"),L+=ae(w/me),w%=me,p.splice(w++,0,L)}return String.fromCodePoint.apply(String,p)},Qn=function(u){var p=[];u=Jt(u);var S=u.length,w=F,L=0,K=U,re=!0,de=!1,Ce=void 0;try{for(var ee=u[Symbol.iterator](),be;!(re=(be=ee.next()).done);re=!0){var Te=be.value;Te<128&&p.push(Me(Te))}}catch(_){de=!0,Ce=_}finally{try{!re&&ee.return&&ee.return()}finally{if(de)throw Ce}}var _e=p.length,se=_e;for(_e&&p.push(oe);se<S;){var Ee=b,me=!0,Ht=!1,Ve=void 0;try{for(var Re=u[Symbol.iterator](),he;!(me=(he=Re.next()).done);me=!0){var Ne=he.value;Ne>=w&&Ne<Ee&&(Ee=Ne)}}catch(_){Ht=!0,Ve=_}finally{try{!me&&Re.return&&Re.return()}finally{if(Ht)throw Ve}}var rt=se+1;Ee-w>ae((b-L)/rt)&&Se("overflow"),L+=(Ee-w)*rt,w=Ee;var ze=!0,St=!1,wt=void 0;try{for(var fr=u[Symbol.iterator](),rr;!(ze=(rr=fr.next()).done);ze=!0){var Dr=rr.value;if(Dr<w&&++L>b&&Se("overflow"),Dr==w){for(var nr=L,o=$;;o+=$){var d=o<=K?C:o>=K+T?T:o-K;if(nr<d)break;var l=nr-d,g=$-d;p.push(Me(Vt(d+l%g,0))),nr=ae(l/g)}p.push(Me(Vt(nr,0))),K=rn(L,rt,se==_e),L=0,++se}}}catch(_){St=!0,wt=_}finally{try{!ze&&fr.return&&fr.return()}finally{if(St)throw wt}}++L,++w}return p.join("")},bt=function(u){return Ze(u,function(p){return B.test(p)?Jn(p.slice(4).toLowerCase()):p})},Xn=function(u){return Ze(u,function(p){return O.test(p)?"xn--"+Qn(p):p})},Qt={version:"2.1.0",ucs2:{decode:Jt,encode:Mr},decode:Jn,encode:Qn,toASCII:Xn,toUnicode:bt},et={};function lt(m){var u=m.charCodeAt(0),p=void 0;return u<16?p="%0"+u.toString(16).toUpperCase():u<128?p="%"+u.toString(16).toUpperCase():u<2048?p="%"+(u>>6|192).toString(16).toUpperCase()+"%"+(u&63|128).toString(16).toUpperCase():p="%"+(u>>12|224).toString(16).toUpperCase()+"%"+(u>>6&63|128).toString(16).toUpperCase()+"%"+(u&63|128).toString(16).toUpperCase(),p}function Xt(m){for(var u="",p=0,S=m.length;p<S;){var w=parseInt(m.substr(p+1,2),16);if(w<128)u+=String.fromCharCode(w),p+=3;else if(w>=194&&w<224){if(S-p>=6){var L=parseInt(m.substr(p+4,2),16);u+=String.fromCharCode((w&31)<<6|L&63)}else u+=m.substr(p,6);p+=6}else if(w>=224){if(S-p>=9){var K=parseInt(m.substr(p+4,2),16),re=parseInt(m.substr(p+7,2),16);u+=String.fromCharCode((w&15)<<12|(K&63)<<6|re&63)}else u+=m.substr(p,9);p+=9}else u+=m.substr(p,3),p+=3}return u}function nn(m,u){function p(S){var w=Xt(S);return w.match(u.UNRESERVED)?w:S}return m.scheme&&(m.scheme=String(m.scheme).replace(u.PCT_ENCODED,p).toLowerCase().replace(u.NOT_SCHEME,"")),m.userinfo!==void 0&&(m.userinfo=String(m.userinfo).replace(u.PCT_ENCODED,p).replace(u.NOT_USERINFO,lt).replace(u.PCT_ENCODED,a)),m.host!==void 0&&(m.host=String(m.host).replace(u.PCT_ENCODED,p).toLowerCase().replace(u.NOT_HOST,lt).replace(u.PCT_ENCODED,a)),m.path!==void 0&&(m.path=String(m.path).replace(u.PCT_ENCODED,p).replace(m.scheme?u.NOT_PATH:u.NOT_PATH_NOSCHEME,lt).replace(u.PCT_ENCODED,a)),m.query!==void 0&&(m.query=String(m.query).replace(u.PCT_ENCODED,p).replace(u.NOT_QUERY,lt).replace(u.PCT_ENCODED,a)),m.fragment!==void 0&&(m.fragment=String(m.fragment).replace(u.PCT_ENCODED,p).replace(u.NOT_FRAGMENT,lt).replace(u.PCT_ENCODED,a)),m}function an(m){return m.replace(/^0*(.*)/,"$1")||"0"}function sn(m,u){var p=m.match(u.IPV4ADDRESS)||[],S=h(p,2),w=S[1];return w?w.split(".").map(an).join("."):m}function Zn(m,u){var p=m.match(u.IPV6ADDRESS)||[],S=h(p,3),w=S[1],L=S[2];if(w){for(var K=w.toLowerCase().split("::").reverse(),re=h(K,2),de=re[0],Ce=re[1],ee=Ce?Ce.split(":").map(an):[],be=de.split(":").map(an),Te=u.IPV4ADDRESS.test(be[be.length-1]),_e=Te?7:8,se=be.length-_e,Ee=Array(_e),me=0;me<_e;++me)Ee[me]=ee[me]||be[se+me]||"";Te&&(Ee[_e-1]=sn(Ee[_e-1],u));var Ht=Ee.reduce(function(rt,ze,St){if(!ze||ze==="0"){var wt=rt[rt.length-1];wt&&wt.index+wt.length===St?wt.length++:rt.push({index:St,length:1})}return rt},[]),Ve=Ht.sort(function(rt,ze){return ze.length-rt.length})[0],Re=void 0;if(Ve&&Ve.length>1){var he=Ee.slice(0,Ve.index),Ne=Ee.slice(Ve.index+Ve.length);Re=he.join(":")+"::"+Ne.join(":")}else Re=Ee.join(":");return L&&(Re+="%"+L),Re}else return m}var us=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,ds="".match(/(){0}/)[1]===void 0;function Et(m){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p={},S=u.iri!==!1?y:f;u.reference==="suffix"&&(m=(u.scheme?u.scheme+":":"")+"//"+m);var w=m.match(us);if(w){ds?(p.scheme=w[1],p.userinfo=w[3],p.host=w[4],p.port=parseInt(w[5],10),p.path=w[6]||"",p.query=w[7],p.fragment=w[8],isNaN(p.port)&&(p.port=w[5])):(p.scheme=w[1]||void 0,p.userinfo=m.indexOf("@")!==-1?w[3]:void 0,p.host=m.indexOf("//")!==-1?w[4]:void 0,p.port=parseInt(w[5],10),p.path=w[6]||"",p.query=m.indexOf("?")!==-1?w[7]:void 0,p.fragment=m.indexOf("#")!==-1?w[8]:void 0,isNaN(p.port)&&(p.port=m.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?w[4]:void 0)),p.host&&(p.host=Zn(sn(p.host,S),S)),p.scheme===void 0&&p.userinfo===void 0&&p.host===void 0&&p.port===void 0&&!p.path&&p.query===void 0?p.reference="same-document":p.scheme===void 0?p.reference="relative":p.fragment===void 0?p.reference="absolute":p.reference="uri",u.reference&&u.reference!=="suffix"&&u.reference!==p.reference&&(p.error=p.error||"URI is not a "+u.reference+" reference.");var L=et[(u.scheme||p.scheme||"").toLowerCase()];if(!u.unicodeSupport&&(!L||!L.unicodeSupport)){if(p.host&&(u.domainHost||L&&L.domainHost))try{p.host=Qt.toASCII(p.host.replace(S.PCT_ENCODED,Xt).toLowerCase())}catch(K){p.error=p.error||"Host's domain name can not be converted to ASCII via punycode: "+K}nn(p,f)}else nn(p,S);L&&L.parse&&L.parse(p,u)}else p.error=p.error||"URI can not be parsed.";return p}function fs(m,u){var p=u.iri!==!1?y:f,S=[];return m.userinfo!==void 0&&(S.push(m.userinfo),S.push("@")),m.host!==void 0&&S.push(Zn(sn(String(m.host),p),p).replace(p.IPV6ADDRESS,function(w,L,K){return"["+L+(K?"%25"+K:"")+"]"})),(typeof m.port=="number"||typeof m.port=="string")&&(S.push(":"),S.push(String(m.port))),S.length?S.join(""):void 0}var $t=/^\.\.?\//,ea=/^\/\.(\/|$)/,on=/^\/\.\.(\/|$)/,Pr=/^\/?(?:.|\n)*?(?=\/|$)/;function It(m){for(var u=[];m.length;)if(m.match($t))m=m.replace($t,"");else if(m.match(ea))m=m.replace(ea,"/");else if(m.match(on))m=m.replace(on,"/"),u.pop();else if(m==="."||m==="..")m="";else{var p=m.match(Pr);if(p){var S=p[0];m=m.slice(S.length),u.push(S)}else throw new Error("Unexpected dot segment condition")}return u.join("")}function tt(m){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p=u.iri?y:f,S=[],w=et[(u.scheme||m.scheme||"").toLowerCase()];if(w&&w.serialize&&w.serialize(m,u),m.host&&!p.IPV6ADDRESS.test(m.host)){if(u.domainHost||w&&w.domainHost)try{m.host=u.iri?Qt.toUnicode(m.host):Qt.toASCII(m.host.replace(p.PCT_ENCODED,Xt).toLowerCase())}catch(re){m.error=m.error||"Host's domain name can not be converted to "+(u.iri?"Unicode":"ASCII")+" via punycode: "+re}}nn(m,p),u.reference!=="suffix"&&m.scheme&&(S.push(m.scheme),S.push(":"));var L=fs(m,u);if(L!==void 0&&(u.reference!=="suffix"&&S.push("//"),S.push(L),m.path&&m.path.charAt(0)!=="/"&&S.push("/")),m.path!==void 0){var K=m.path;!u.absolutePath&&(!w||!w.absolutePath)&&(K=It(K)),L===void 0&&(K=K.replace(/^\/\//,"/%2F")),S.push(K)}return m.query!==void 0&&(S.push("?"),S.push(m.query)),m.fragment!==void 0&&(S.push("#"),S.push(m.fragment)),S.join("")}function kr(m,u){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},S=arguments[3],w={};return S||(m=Et(tt(m,p),p),u=Et(tt(u,p),p)),p=p||{},!p.tolerant&&u.scheme?(w.scheme=u.scheme,w.userinfo=u.userinfo,w.host=u.host,w.port=u.port,w.path=It(u.path||""),w.query=u.query):(u.userinfo!==void 0||u.host!==void 0||u.port!==void 0?(w.userinfo=u.userinfo,w.host=u.host,w.port=u.port,w.path=It(u.path||""),w.query=u.query):(u.path?(u.path.charAt(0)==="/"?w.path=It(u.path):((m.userinfo!==void 0||m.host!==void 0||m.port!==void 0)&&!m.path?w.path="/"+u.path:m.path?w.path=m.path.slice(0,m.path.lastIndexOf("/")+1)+u.path:w.path=u.path,w.path=It(w.path)),w.query=u.query):(w.path=m.path,u.query!==void 0?w.query=u.query:w.query=m.query),w.userinfo=m.userinfo,w.host=m.host,w.port=m.port),w.scheme=m.scheme),w.fragment=u.fragment,w}function ta(m,u,p){var S=i({scheme:"null"},p);return tt(kr(Et(m,S),Et(u,S),S,!0),S)}function ra(m,u){return typeof m=="string"?m=tt(Et(m,u),u):n(m)==="object"&&(m=Et(tt(m,u),u)),m}function na(m,u,p){return typeof m=="string"?m=tt(Et(m,p),p):n(m)==="object"&&(m=tt(m,p)),typeof u=="string"?u=tt(Et(u,p),p):n(u)==="object"&&(u=tt(u,p)),m===u}function aa(m,u){return m&&m.toString().replace(!u||!u.iri?f.ESCAPE:y.ESCAPE,lt)}function ct(m,u){return m&&m.toString().replace(!u||!u.iri?f.PCT_ENCODED:y.PCT_ENCODED,Xt)}var Zt={scheme:"http",domainHost:!0,parse:function(u,p){return u.host||(u.error=u.error||"HTTP URIs must have a host."),u},serialize:function(u,p){var S=String(u.scheme).toLowerCase()==="https";return(u.port===(S?443:80)||u.port==="")&&(u.port=void 0),u.path||(u.path="/"),u}},ln={scheme:"https",domainHost:Zt.domainHost,parse:Zt.parse,serialize:Zt.serialize};function cn(m){return typeof m.secure=="boolean"?m.secure:String(m.scheme).toLowerCase()==="wss"}var er={scheme:"ws",domainHost:!0,parse:function(u,p){var S=u;return S.secure=cn(S),S.resourceName=(S.path||"/")+(S.query?"?"+S.query:""),S.path=void 0,S.query=void 0,S},serialize:function(u,p){if((u.port===(cn(u)?443:80)||u.port==="")&&(u.port=void 0),typeof u.secure=="boolean"&&(u.scheme=u.secure?"wss":"ws",u.secure=void 0),u.resourceName){var S=u.resourceName.split("?"),w=h(S,2),L=w[0],K=w[1];u.path=L&&L!=="/"?L:void 0,u.query=K,u.resourceName=void 0}return u.fragment=void 0,u}},un={scheme:"wss",domainHost:er.domainHost,parse:er.parse,serialize:er.serialize},sa={},ia=!0,Ir="[A-Za-z0-9\\-\\.\\_\\~"+(ia?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",ut="[0-9A-Fa-f]",ms=r(r("%[EFef]"+ut+"%"+ut+ut+"%"+ut+ut)+"|"+r("%[89A-Fa-f]"+ut+"%"+ut+ut)+"|"+r("%"+ut+ut)),dn="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",oa="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",hs=e(oa,'[\\"\\\\]'),Dt="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",ps=new RegExp(Ir,"g"),tr=new RegExp(ms,"g"),la=new RegExp(e("[^]",dn,"[\\.]",'[\\"]',hs),"g"),ca=new RegExp(e("[^]",Ir,Dt),"g"),vs=ca;function fn(m){var u=Xt(m);return u.match(ps)?u:m}var ua={scheme:"mailto",parse:function(u,p){var S=u,w=S.to=S.path?S.path.split(","):[];if(S.path=void 0,S.query){for(var L=!1,K={},re=S.query.split("&"),de=0,Ce=re.length;de<Ce;++de){var ee=re[de].split("=");switch(ee[0]){case"to":for(var be=ee[1].split(","),Te=0,_e=be.length;Te<_e;++Te)w.push(be[Te]);break;case"subject":S.subject=ct(ee[1],p);break;case"body":S.body=ct(ee[1],p);break;default:L=!0,K[ct(ee[0],p)]=ct(ee[1],p);break}}L&&(S.headers=K)}S.query=void 0;for(var se=0,Ee=w.length;se<Ee;++se){var me=w[se].split("@");if(me[0]=ct(me[0]),p.unicodeSupport)me[1]=ct(me[1],p).toLowerCase();else try{me[1]=Qt.toASCII(ct(me[1],p).toLowerCase())}catch(Ht){S.error=S.error||"Email address's domain name can not be converted to ASCII via punycode: "+Ht}w[se]=me.join("@")}return S},serialize:function(u,p){var S=u,w=s(u.to);if(w){for(var L=0,K=w.length;L<K;++L){var re=String(w[L]),de=re.lastIndexOf("@"),Ce=re.slice(0,de).replace(tr,fn).replace(tr,a).replace(la,lt),ee=re.slice(de+1);try{ee=p.iri?Qt.toUnicode(ee):Qt.toASCII(ct(ee,p).toLowerCase())}catch(se){S.error=S.error||"Email address's domain name can not be converted to "+(p.iri?"Unicode":"ASCII")+" via punycode: "+se}w[L]=Ce+"@"+ee}S.path=w.join(",")}var be=u.headers=u.headers||{};u.subject&&(be.subject=u.subject),u.body&&(be.body=u.body);var Te=[];for(var _e in be)be[_e]!==sa[_e]&&Te.push(_e.replace(tr,fn).replace(tr,a).replace(ca,lt)+"="+be[_e].replace(tr,fn).replace(tr,a).replace(vs,lt));return Te.length&&(S.query=Te.join("&")),S}},gs=/^([^\:]+)\:(.*)/,da={scheme:"urn",parse:function(u,p){var S=u.path&&u.path.match(gs),w=u;if(S){var L=p.scheme||w.scheme||"urn",K=S[1].toLowerCase(),re=S[2],de=L+":"+(p.nid||K),Ce=et[de];w.nid=K,w.nss=re,w.path=void 0,Ce&&(w=Ce.parse(w,p))}else w.error=w.error||"URN can not be parsed.";return w},serialize:function(u,p){var S=p.scheme||u.scheme||"urn",w=u.nid,L=S+":"+(p.nid||w),K=et[L];K&&(u=K.serialize(u,p));var re=u,de=u.nss;return re.path=(w||p.nid)+":"+de,re}},ys=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,fa={scheme:"urn:uuid",parse:function(u,p){var S=u;return S.uuid=S.nss,S.nss=void 0,!p.tolerant&&(!S.uuid||!S.uuid.match(ys))&&(S.error=S.error||"UUID is not valid."),S},serialize:function(u,p){var S=u;return S.nss=(u.uuid||"").toLowerCase(),S}};et[Zt.scheme]=Zt,et[ln.scheme]=ln,et[er.scheme]=er,et[un.scheme]=un,et[ua.scheme]=ua,et[da.scheme]=da,et[fa.scheme]=fa,t.SCHEMES=et,t.pctEncChar=lt,t.pctDecChars=Xt,t.parse=Et,t.removeDotSegments=It,t.serialize=tt,t.resolveComponents=kr,t.resolve=ta,t.normalize=ra,t.equal=na,t.escapeComponent=aa,t.unescapeComponent=ct,Object.defineProperty(t,"__esModule",{value:!0})})});var yc=x(Ni=>{"use strict";Object.defineProperty(Ni,"__esModule",{value:!0});var gc=vc();gc.code='require("ajv/dist/runtime/uri").default';Ni.default=gc});var Tc=x(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.CodeGen=je.Name=je.nil=je.stringify=je.str=je._=je.KeywordCxt=void 0;var Lm=Ln();Object.defineProperty(je,"KeywordCxt",{enumerable:!0,get:function(){return Lm.KeywordCxt}});var Jr=Z();Object.defineProperty(je,"_",{enumerable:!0,get:function(){return Jr._}});Object.defineProperty(je,"str",{enumerable:!0,get:function(){return Jr.str}});Object.defineProperty(je,"stringify",{enumerable:!0,get:function(){return Jr.stringify}});Object.defineProperty(je,"nil",{enumerable:!0,get:function(){return Jr.nil}});Object.defineProperty(je,"Name",{enumerable:!0,get:function(){return Jr.Name}});Object.defineProperty(je,"CodeGen",{enumerable:!0,get:function(){return Jr.CodeGen}});var xm=Ba(),Sc=Ua(),qm=fi(),xn=za(),jm=Z(),qn=Rn(),Wa=Nn(),Ai=ue(),_c=hc(),Fm=yc(),wc=(t,e)=>new RegExp(t,e);wc.code="new RegExp";var Vm=["removeAdditional","useDefaults","coerceTypes"],Hm=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),Bm={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},Um={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},bc=200;function Gm(t){var e,r,n,a,s,i,c,f,y,h,E,b,$,C,T,N,R,U,F,oe,B,O,J,z,te;let ae=t.strict,Me=(e=t.code)===null||e===void 0?void 0:e.optimize,Se=Me===!0||Me===void 0?1:Me||0,Ae=(n=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:wc,Ze=(a=t.uriResolver)!==null&&a!==void 0?a:Fm.default;return{strictSchema:(i=(s=t.strictSchema)!==null&&s!==void 0?s:ae)!==null&&i!==void 0?i:!0,strictNumbers:(f=(c=t.strictNumbers)!==null&&c!==void 0?c:ae)!==null&&f!==void 0?f:!0,strictTypes:(h=(y=t.strictTypes)!==null&&y!==void 0?y:ae)!==null&&h!==void 0?h:"log",strictTuples:(b=(E=t.strictTuples)!==null&&E!==void 0?E:ae)!==null&&b!==void 0?b:"log",strictRequired:(C=($=t.strictRequired)!==null&&$!==void 0?$:ae)!==null&&C!==void 0?C:!1,code:t.code?dt(Pe({},t.code),{optimize:Se,regExp:Ae}):{optimize:Se,regExp:Ae},loopRequired:(T=t.loopRequired)!==null&&T!==void 0?T:bc,loopEnum:(N=t.loopEnum)!==null&&N!==void 0?N:bc,meta:(R=t.meta)!==null&&R!==void 0?R:!0,messages:(U=t.messages)!==null&&U!==void 0?U:!0,inlineRefs:(F=t.inlineRefs)!==null&&F!==void 0?F:!0,schemaId:(oe=t.schemaId)!==null&&oe!==void 0?oe:"$id",addUsedSchema:(B=t.addUsedSchema)!==null&&B!==void 0?B:!0,validateSchema:(O=t.validateSchema)!==null&&O!==void 0?O:!0,validateFormats:(J=t.validateFormats)!==null&&J!==void 0?J:!0,unicodeRegExp:(z=t.unicodeRegExp)!==null&&z!==void 0?z:!0,int32range:(te=t.int32range)!==null&&te!==void 0?te:!0,uriResolver:Ze}}var jn=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts=Pe(Pe({},e),Gm(e));let{es5:r,lines:n}=this.opts.code;this.scope=new jm.ValueScope({scope:{},prefixes:Hm,es5:r,lines:n}),this.logger=Qm(e.logger);let a=e.validateFormats;e.validateFormats=!1,this.RULES=(0,qm.getRules)(),Ec.call(this,Bm,e,"NOT SUPPORTED"),Ec.call(this,Um,e,"DEPRECATED","warn"),this._metaOpts=Ym.call(this),e.formats&&Km.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&Wm.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),zm.call(this),e.validateFormats=a}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:n}=this.opts,a=_c;n==="id"&&(a=Pe({},_c),a.id=a.$id,delete a.$id),r&&e&&this.addMetaSchema(a,a[n],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let n;if(typeof e=="string"){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);let a=n(r);return"$async"in n||(this.errors=n.errors),a}compile(e,r){let n=this._addSchema(e,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return a.call(this,e,r);async function a(h,E){await s.call(this,h.$schema);let b=this._addSchema(h,E);return b.validate||i.call(this,b)}async function s(h){h&&!this.getSchema(h)&&await a.call(this,{$ref:h},!0)}async function i(h){try{return this._compileSchemaEnv(h)}catch(E){if(!(E instanceof Sc.default))throw E;return c.call(this,E),await f.call(this,E.missingSchema),i.call(this,h)}}function c({missingSchema:h,missingRef:E}){if(this.refs[h])throw new Error(`AnySchema ${h} is loaded but ${E} cannot be resolved`)}async function f(h){let E=await y.call(this,h);this.refs[h]||await s.call(this,E.$schema),this.refs[h]||this.addSchema(E,h,r)}async function y(h){let E=this._loading[h];if(E)return E;try{return await(this._loading[h]=n(h))}finally{delete this._loading[h]}}}addSchema(e,r,n,a=this.opts.validateSchema){if(Array.isArray(e)){for(let i of e)this.addSchema(i,void 0,n,a);return this}let s;if(typeof e=="object"){let{schemaId:i}=this.opts;if(s=e[i],s!==void 0&&typeof s!="string")throw new Error(`schema ${i} must be string`)}return r=(0,qn.normalizeId)(r||s),this._checkUnique(r),this.schemas[r]=this._addSchema(e,n,r,a,!0),this}addMetaSchema(e,r,n=this.opts.validateSchema){return this.addSchema(e,r,!0,n),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let n;if(n=e.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let a=this.validate(n,e);if(!a&&r){let s="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(s);else throw new Error(s)}return a}getSchema(e){let r;for(;typeof(r=$c.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:n}=this.opts,a=new xn.SchemaEnv({schema:{},schemaId:n});if(r=xn.resolveSchema.call(this,a,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=$c.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let n=e[this.opts.schemaId];return n&&(n=(0,qn.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let n;if(typeof e=="string")n=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof e=="object"&&r===void 0){if(r=e,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(Zm.call(this,n,r),!r)return(0,Ai.eachItem)(n,s=>Ri.call(this,s)),this;th.call(this,r);let a=dt(Pe({},r),{type:(0,Wa.getJSONTypes)(r.type),schemaType:(0,Wa.getJSONTypes)(r.schemaType)});return(0,Ai.eachItem)(n,a.type.length===0?s=>Ri.call(this,s,a):s=>a.type.forEach(i=>Ri.call(this,s,a,i))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let n of r.rules){let a=n.rules.findIndex(s=>s.keyword===e);a>=0&&n.rules.splice(a,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!e||e.length===0?"No errors":e.map(a=>`${n}${a.instancePath} ${a.message}`).reduce((a,s)=>a+r+s)}$dataMetaSchema(e,r){let n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let a of r){let s=a.split("/").slice(1),i=e;for(let c of s)i=i[c];for(let c in n){let f=n[c];if(typeof f!="object")continue;let{$data:y}=f.definition,h=i[c];y&&h&&(i[c]=Cc(h))}}return e}_removeAllSchemas(e,r){for(let n in e){let a=e[n];(!r||r.test(n))&&(typeof a=="string"?delete e[n]:a&&!a.meta&&(this._cache.delete(a.schema),delete e[n]))}}_addSchema(e,r,n,a=this.opts.validateSchema,s=this.opts.addUsedSchema){let i,{schemaId:c}=this.opts;if(typeof e=="object")i=e[c];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let f=this._cache.get(e);if(f!==void 0)return f;n=(0,qn.normalizeId)(i||n);let y=qn.getSchemaRefs.call(this,e,n);return f=new xn.SchemaEnv({schema:e,schemaId:c,meta:r,baseId:n,localRefs:y}),this._cache.set(f.schema,f),s&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=f),a&&this.validateSchema(e,!0),f}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):xn.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{xn.compileSchema.call(this,e)}finally{this.opts=r}}};je.default=jn;jn.ValidationError=xm.default;jn.MissingRefError=Sc.default;function Ec(t,e,r,n="error"){for(let a in t){let s=a;s in e&&this.logger[n](`${r}: option ${a}. ${t[s]}`)}}function $c(t){return t=(0,qn.normalizeId)(t),this.schemas[t]||this.refs[t]}function zm(){let t=this.opts.schemas;if(!!t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function Km(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function Wm(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function Ym(){let t=Pe({},this.opts);for(let e of Vm)delete t[e];return t}var Jm={log(){},warn(){},error(){}};function Qm(t){if(t===!1)return Jm;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var Xm=/^[a-z_$][a-z0-9_$:-]*$/i;function Zm(t,e){let{RULES:r}=this;if((0,Ai.eachItem)(t,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!Xm.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function Ri(t,e,r){var n;let a=e==null?void 0:e.post;if(r&&a)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:s}=this,i=a?s.post:s.rules.find(({type:f})=>f===r);if(i||(i={type:r,rules:[]},s.rules.push(i)),s.keywords[t]=!0,!e)return;let c={keyword:t,definition:dt(Pe({},e),{type:(0,Wa.getJSONTypes)(e.type),schemaType:(0,Wa.getJSONTypes)(e.schemaType)})};e.before?eh.call(this,i,c,e.before):i.rules.push(c),s.all[t]=c,(n=e.implements)===null||n===void 0||n.forEach(f=>this.addKeyword(f))}function eh(t,e,r){let n=t.rules.findIndex(a=>a.keyword===r);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function th(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=Cc(e)),t.validateSchema=this.compile(e,!0))}var rh={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Cc(t){return{anyOf:[t,rh]}}});var Mc=x(Oi=>{"use strict";Object.defineProperty(Oi,"__esModule",{value:!0});var nh={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Oi.default=nh});var Dc=x(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:!0});wr.callRef=wr.getValidate=void 0;var ah=Ua(),Pc=gt(),ot=Z(),Qr=Wt(),kc=za(),Ya=ue(),sh={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:n}=t,{baseId:a,schemaEnv:s,validateName:i,opts:c,self:f}=n,{root:y}=s;if((r==="#"||r==="#/")&&a===y.baseId)return E();let h=kc.resolveRef.call(f,y,a,r);if(h===void 0)throw new ah.default(n.opts.uriResolver,a,r);if(h instanceof kc.SchemaEnv)return b(h);return $(h);function E(){if(s===y)return Ja(t,i,s,s.$async);let C=e.scopeValue("root",{ref:y});return Ja(t,(0,ot._)`${C}.validate`,y,y.$async)}function b(C){let T=Ic(t,C);Ja(t,T,C,C.$async)}function $(C){let T=e.scopeValue("schema",c.code.source===!0?{ref:C,code:(0,ot.stringify)(C)}:{ref:C}),N=e.name("valid"),R=t.subschema({schema:C,dataTypes:[],schemaPath:ot.nil,topSchemaRef:T,errSchemaPath:r},N);t.mergeEvaluated(R),t.ok(N)}}};function Ic(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,ot._)`${r.scopeValue("wrapper",{ref:e})}.validate`}wr.getValidate=Ic;function Ja(t,e,r,n){let{gen:a,it:s}=t,{allErrors:i,schemaEnv:c,opts:f}=s,y=f.passContext?Qr.default.this:ot.nil;n?h():E();function h(){if(!c.$async)throw new Error("async schema referenced by sync schema");let C=a.let("valid");a.try(()=>{a.code((0,ot._)`await ${(0,Pc.callValidateCode)(t,e,y)}`),$(e),i||a.assign(C,!0)},T=>{a.if((0,ot._)`!(${T} instanceof ${s.ValidationError})`,()=>a.throw(T)),b(T),i||a.assign(C,!1)}),t.ok(C)}function E(){t.result((0,Pc.callValidateCode)(t,e,y),()=>$(e),()=>b(e))}function b(C){let T=(0,ot._)`${C}.errors`;a.assign(Qr.default.vErrors,(0,ot._)`${Qr.default.vErrors} === null ? ${T} : ${Qr.default.vErrors}.concat(${T})`),a.assign(Qr.default.errors,(0,ot._)`${Qr.default.vErrors}.length`)}function $(C){var T;if(!s.opts.unevaluated)return;let N=(T=r==null?void 0:r.validate)===null||T===void 0?void 0:T.evaluated;if(s.props!==!0)if(N&&!N.dynamicProps)N.props!==void 0&&(s.props=Ya.mergeEvaluated.props(a,N.props,s.props));else{let R=a.var("props",(0,ot._)`${C}.evaluated.props`);s.props=Ya.mergeEvaluated.props(a,R,s.props,ot.Name)}if(s.items!==!0)if(N&&!N.dynamicItems)N.items!==void 0&&(s.items=Ya.mergeEvaluated.items(a,N.items,s.items));else{let R=a.var("items",(0,ot._)`${C}.evaluated.items`);s.items=Ya.mergeEvaluated.items(a,R,s.items,ot.Name)}}}wr.callRef=Ja;wr.default=sh});var Nc=x(Li=>{"use strict";Object.defineProperty(Li,"__esModule",{value:!0});var ih=Mc(),oh=Dc(),lh=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",ih.default,oh.default];Li.default=lh});var Rc=x(xi=>{"use strict";Object.defineProperty(xi,"__esModule",{value:!0});var Qa=Z(),dr=Qa.operators,Xa={maximum:{okStr:"<=",ok:dr.LTE,fail:dr.GT},minimum:{okStr:">=",ok:dr.GTE,fail:dr.LT},exclusiveMaximum:{okStr:"<",ok:dr.LT,fail:dr.GTE},exclusiveMinimum:{okStr:">",ok:dr.GT,fail:dr.LTE}},ch={message:({keyword:t,schemaCode:e})=>(0,Qa.str)`must be ${Xa[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,Qa._)`{comparison: ${Xa[t].okStr}, limit: ${e}}`},uh={keyword:Object.keys(Xa),type:"number",schemaType:"number",$data:!0,error:ch,code(t){let{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,Qa._)`${r} ${Xa[e].fail} ${n} || isNaN(${r})`)}};xi.default=uh});var Ac=x(qi=>{"use strict";Object.defineProperty(qi,"__esModule",{value:!0});var Fn=Z(),dh={message:({schemaCode:t})=>(0,Fn.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,Fn._)`{multipleOf: ${t}}`},fh={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:dh,code(t){let{gen:e,data:r,schemaCode:n,it:a}=t,s=a.opts.multipleOfPrecision,i=e.let("res"),c=s?(0,Fn._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${s}`:(0,Fn._)`${i} !== parseInt(${i})`;t.fail$data((0,Fn._)`(${n} === 0 || (${i} = ${r}/${n}, ${c}))`)}};qi.default=fh});var Lc=x(ji=>{"use strict";Object.defineProperty(ji,"__esModule",{value:!0});function Oc(t){let e=t.length,r=0,n=0,a;for(;n<e;)r++,a=t.charCodeAt(n++),a>=55296&&a<=56319&&n<e&&(a=t.charCodeAt(n),(a&64512)===56320&&n++);return r}ji.default=Oc;Oc.code='require("ajv/dist/runtime/ucs2length").default'});var xc=x(Fi=>{"use strict";Object.defineProperty(Fi,"__esModule",{value:!0});var Cr=Z(),mh=ue(),hh=Lc(),ph={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,Cr.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,Cr._)`{limit: ${t}}`},vh={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:ph,code(t){let{keyword:e,data:r,schemaCode:n,it:a}=t,s=e==="maxLength"?Cr.operators.GT:Cr.operators.LT,i=a.opts.unicode===!1?(0,Cr._)`${r}.length`:(0,Cr._)`${(0,mh.useFunc)(t.gen,hh.default)}(${r})`;t.fail$data((0,Cr._)`${i} ${s} ${n}`)}};Fi.default=vh});var qc=x(Vi=>{"use strict";Object.defineProperty(Vi,"__esModule",{value:!0});var gh=gt(),Za=Z(),yh={message:({schemaCode:t})=>(0,Za.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,Za._)`{pattern: ${t}}`},_h={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:yh,code(t){let{data:e,$data:r,schema:n,schemaCode:a,it:s}=t,i=s.opts.unicodeRegExp?"u":"",c=r?(0,Za._)`(new RegExp(${a}, ${i}))`:(0,gh.usePattern)(t,n);t.fail$data((0,Za._)`!${c}.test(${e})`)}};Vi.default=_h});var jc=x(Hi=>{"use strict";Object.defineProperty(Hi,"__esModule",{value:!0});var Vn=Z(),bh={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,Vn.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,Vn._)`{limit: ${t}}`},Eh={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:bh,code(t){let{keyword:e,data:r,schemaCode:n}=t,a=e==="maxProperties"?Vn.operators.GT:Vn.operators.LT;t.fail$data((0,Vn._)`Object.keys(${r}).length ${a} ${n}`)}};Hi.default=Eh});var Fc=x(Bi=>{"use strict";Object.defineProperty(Bi,"__esModule",{value:!0});var Hn=gt(),Bn=Z(),$h=ue(),Sh={message:({params:{missingProperty:t}})=>(0,Bn.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,Bn._)`{missingProperty: ${t}}`},wh={keyword:"required",type:"object",schemaType:"array",$data:!0,error:Sh,code(t){let{gen:e,schema:r,schemaCode:n,data:a,$data:s,it:i}=t,{opts:c}=i;if(!s&&r.length===0)return;let f=r.length>=c.loopRequired;if(i.allErrors?y():h(),c.strictRequired){let $=t.parentSchema.properties,{definedProperties:C}=t.it;for(let T of r)if(($==null?void 0:$[T])===void 0&&!C.has(T)){let N=i.schemaEnv.baseId+i.errSchemaPath,R=`required property "${T}" is not defined at "${N}" (strictRequired)`;(0,$h.checkStrictMode)(i,R,i.opts.strictRequired)}}function y(){if(f||s)t.block$data(Bn.nil,E);else for(let $ of r)(0,Hn.checkReportMissingProp)(t,$)}function h(){let $=e.let("missing");if(f||s){let C=e.let("valid",!0);t.block$data(C,()=>b($,C)),t.ok(C)}else e.if((0,Hn.checkMissingProp)(t,r,$)),(0,Hn.reportMissingProp)(t,$),e.else()}function E(){e.forOf("prop",n,$=>{t.setParams({missingProperty:$}),e.if((0,Hn.noPropertyInData)(e,a,$,c.ownProperties),()=>t.error())})}function b($,C){t.setParams({missingProperty:$}),e.forOf($,n,()=>{e.assign(C,(0,Hn.propertyInData)(e,a,$,c.ownProperties)),e.if((0,Bn.not)(C),()=>{t.error(),e.break()})},Bn.nil)}}};Bi.default=wh});var Vc=x(Ui=>{"use strict";Object.defineProperty(Ui,"__esModule",{value:!0});var Un=Z(),Ch={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,Un.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,Un._)`{limit: ${t}}`},Th={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:Ch,code(t){let{keyword:e,data:r,schemaCode:n}=t,a=e==="maxItems"?Un.operators.GT:Un.operators.LT;t.fail$data((0,Un._)`${r}.length ${a} ${n}`)}};Ui.default=Th});var es=x(Gi=>{"use strict";Object.defineProperty(Gi,"__esModule",{value:!0});var Hc=bi();Hc.code='require("ajv/dist/runtime/equal").default';Gi.default=Hc});var Bc=x(Ki=>{"use strict";Object.defineProperty(Ki,"__esModule",{value:!0});var zi=Nn(),Fe=Z(),Mh=ue(),Ph=es(),kh={message:({params:{i:t,j:e}})=>(0,Fe.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Fe._)`{i: ${t}, j: ${e}}`},Ih={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:kh,code(t){let{gen:e,data:r,$data:n,schema:a,parentSchema:s,schemaCode:i,it:c}=t;if(!n&&!a)return;let f=e.let("valid"),y=s.items?(0,zi.getSchemaTypes)(s.items):[];t.block$data(f,h,(0,Fe._)`${i} === false`),t.ok(f);function h(){let C=e.let("i",(0,Fe._)`${r}.length`),T=e.let("j");t.setParams({i:C,j:T}),e.assign(f,!0),e.if((0,Fe._)`${C} > 1`,()=>(E()?b:$)(C,T))}function E(){return y.length>0&&!y.some(C=>C==="object"||C==="array")}function b(C,T){let N=e.name("item"),R=(0,zi.checkDataTypes)(y,N,c.opts.strictNumbers,zi.DataType.Wrong),U=e.const("indices",(0,Fe._)`{}`);e.for((0,Fe._)`;${C}--;`,()=>{e.let(N,(0,Fe._)`${r}[${C}]`),e.if(R,(0,Fe._)`continue`),y.length>1&&e.if((0,Fe._)`typeof ${N} == "string"`,(0,Fe._)`${N} += "_"`),e.if((0,Fe._)`typeof ${U}[${N}] == "number"`,()=>{e.assign(T,(0,Fe._)`${U}[${N}]`),t.error(),e.assign(f,!1).break()}).code((0,Fe._)`${U}[${N}] = ${C}`)})}function $(C,T){let N=(0,Mh.useFunc)(e,Ph.default),R=e.name("outer");e.label(R).for((0,Fe._)`;${C}--;`,()=>e.for((0,Fe._)`${T} = ${C}; ${T}--;`,()=>e.if((0,Fe._)`${N}(${r}[${C}], ${r}[${T}])`,()=>{t.error(),e.assign(f,!1).break(R)})))}}};Ki.default=Ih});var Uc=x(Yi=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});var Wi=Z(),Dh=ue(),Nh=es(),Rh={message:"must be equal to constant",params:({schemaCode:t})=>(0,Wi._)`{allowedValue: ${t}}`},Ah={keyword:"const",$data:!0,error:Rh,code(t){let{gen:e,data:r,$data:n,schemaCode:a,schema:s}=t;n||s&&typeof s=="object"?t.fail$data((0,Wi._)`!${(0,Dh.useFunc)(e,Nh.default)}(${r}, ${a})`):t.fail((0,Wi._)`${s} !== ${r}`)}};Yi.default=Ah});var Gc=x(Ji=>{"use strict";Object.defineProperty(Ji,"__esModule",{value:!0});var Gn=Z(),Oh=ue(),Lh=es(),xh={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,Gn._)`{allowedValues: ${t}}`},qh={keyword:"enum",schemaType:"array",$data:!0,error:xh,code(t){let{gen:e,data:r,$data:n,schema:a,schemaCode:s,it:i}=t;if(!n&&a.length===0)throw new Error("enum must have non-empty array");let c=a.length>=i.opts.loopEnum,f,y=()=>f!=null?f:f=(0,Oh.useFunc)(e,Lh.default),h;if(c||n)h=e.let("valid"),t.block$data(h,E);else{if(!Array.isArray(a))throw new Error("ajv implementation error");let $=e.const("vSchema",s);h=(0,Gn.or)(...a.map((C,T)=>b($,T)))}t.pass(h);function E(){e.assign(h,!1),e.forOf("v",s,$=>e.if((0,Gn._)`${y()}(${r}, ${$})`,()=>e.assign(h,!0).break()))}function b($,C){let T=a[C];return typeof T=="object"&&T!==null?(0,Gn._)`${y()}(${r}, ${$}[${C}])`:(0,Gn._)`${r} === ${T}`}}};Ji.default=qh});var zc=x(Qi=>{"use strict";Object.defineProperty(Qi,"__esModule",{value:!0});var jh=Rc(),Fh=Ac(),Vh=xc(),Hh=qc(),Bh=jc(),Uh=Fc(),Gh=Vc(),zh=Bc(),Kh=Uc(),Wh=Gc(),Yh=[jh.default,Fh.default,Vh.default,Hh.default,Bh.default,Uh.default,Gh.default,zh.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},Kh.default,Wh.default];Qi.default=Yh});var Zi=x(zn=>{"use strict";Object.defineProperty(zn,"__esModule",{value:!0});zn.validateAdditionalItems=void 0;var Tr=Z(),Xi=ue(),Jh={message:({params:{len:t}})=>(0,Tr.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Tr._)`{limit: ${t}}`},Qh={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:Jh,code(t){let{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,Xi.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}Kc(t,n)}};function Kc(t,e){let{gen:r,schema:n,data:a,keyword:s,it:i}=t;i.items=!0;let c=r.const("len",(0,Tr._)`${a}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,Tr._)`${c} <= ${e.length}`);else if(typeof n=="object"&&!(0,Xi.alwaysValidSchema)(i,n)){let y=r.var("valid",(0,Tr._)`${c} <= ${e.length}`);r.if((0,Tr.not)(y),()=>f(y)),t.ok(y)}function f(y){r.forRange("i",e.length,c,h=>{t.subschema({keyword:s,dataProp:h,dataPropType:Xi.Type.Num},y),i.allErrors||r.if((0,Tr.not)(y),()=>r.break())})}}zn.validateAdditionalItems=Kc;zn.default=Qh});var eo=x(Kn=>{"use strict";Object.defineProperty(Kn,"__esModule",{value:!0});Kn.validateTuple=void 0;var Wc=Z(),ts=ue(),Xh=gt(),Zh={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return Yc(t,"additionalItems",e);r.items=!0,!(0,ts.alwaysValidSchema)(r,e)&&t.ok((0,Xh.validateArray)(t))}};function Yc(t,e,r=t.schema){let{gen:n,parentSchema:a,data:s,keyword:i,it:c}=t;h(a),c.opts.unevaluated&&r.length&&c.items!==!0&&(c.items=ts.mergeEvaluated.items(n,r.length,c.items));let f=n.name("valid"),y=n.const("len",(0,Wc._)`${s}.length`);r.forEach((E,b)=>{(0,ts.alwaysValidSchema)(c,E)||(n.if((0,Wc._)`${y} > ${b}`,()=>t.subschema({keyword:i,schemaProp:b,dataProp:b},f)),t.ok(f))});function h(E){let{opts:b,errSchemaPath:$}=c,C=r.length,T=C===E.minItems&&(C===E.maxItems||E[e]===!1);if(b.strictTuples&&!T){let N=`"${i}" is ${C}-tuple, but minItems or maxItems/${e} are not specified or different at path "${$}"`;(0,ts.checkStrictMode)(c,N,b.strictTuples)}}}Kn.validateTuple=Yc;Kn.default=Zh});var Jc=x(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:!0});var ep=eo(),tp={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,ep.validateTuple)(t,"items")};to.default=tp});var Xc=x(ro=>{"use strict";Object.defineProperty(ro,"__esModule",{value:!0});var Qc=Z(),rp=ue(),np=gt(),ap=Zi(),sp={message:({params:{len:t}})=>(0,Qc.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Qc._)`{limit: ${t}}`},ip={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:sp,code(t){let{schema:e,parentSchema:r,it:n}=t,{prefixItems:a}=r;n.items=!0,!(0,rp.alwaysValidSchema)(n,e)&&(a?(0,ap.validateAdditionalItems)(t,a):t.ok((0,np.validateArray)(t)))}};ro.default=ip});var Zc=x(no=>{"use strict";Object.defineProperty(no,"__esModule",{value:!0});var _t=Z(),rs=ue(),op={message:({params:{min:t,max:e}})=>e===void 0?(0,_t.str)`must contain at least ${t} valid item(s)`:(0,_t.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,_t._)`{minContains: ${t}}`:(0,_t._)`{minContains: ${t}, maxContains: ${e}}`},lp={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:op,code(t){let{gen:e,schema:r,parentSchema:n,data:a,it:s}=t,i,c,{minContains:f,maxContains:y}=n;s.opts.next?(i=f===void 0?1:f,c=y):i=1;let h=e.const("len",(0,_t._)`${a}.length`);if(t.setParams({min:i,max:c}),c===void 0&&i===0){(0,rs.checkStrictMode)(s,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(c!==void 0&&i>c){(0,rs.checkStrictMode)(s,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,rs.alwaysValidSchema)(s,r)){let T=(0,_t._)`${h} >= ${i}`;c!==void 0&&(T=(0,_t._)`${T} && ${h} <= ${c}`),t.pass(T);return}s.items=!0;let E=e.name("valid");c===void 0&&i===1?$(E,()=>e.if(E,()=>e.break())):i===0?(e.let(E,!0),c!==void 0&&e.if((0,_t._)`${a}.length > 0`,b)):(e.let(E,!1),b()),t.result(E,()=>t.reset());function b(){let T=e.name("_valid"),N=e.let("count",0);$(T,()=>e.if(T,()=>C(N)))}function $(T,N){e.forRange("i",0,h,R=>{t.subschema({keyword:"contains",dataProp:R,dataPropType:rs.Type.Num,compositeRule:!0},T),N()})}function C(T){e.code((0,_t._)`${T}++`),c===void 0?e.if((0,_t._)`${T} >= ${i}`,()=>e.assign(E,!0).break()):(e.if((0,_t._)`${T} > ${c}`,()=>e.assign(E,!1).break()),i===1?e.assign(E,!0):e.if((0,_t._)`${T} >= ${i}`,()=>e.assign(E,!0)))}}};no.default=lp});var ru=x(Ft=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.validateSchemaDeps=Ft.validatePropertyDeps=Ft.error=void 0;var ao=Z(),cp=ue(),Wn=gt();Ft.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let n=e===1?"property":"properties";return(0,ao.str)`must have ${n} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:n}})=>(0,ao._)`{property: ${t},
    missingProperty: ${n},
    depsCount: ${e},
    deps: ${r}}`};var up={keyword:"dependencies",type:"object",schemaType:"object",error:Ft.error,code(t){let[e,r]=dp(t);eu(t,e),tu(t,r)}};function dp({schema:t}){let e={},r={};for(let n in t){if(n==="__proto__")continue;let a=Array.isArray(t[n])?e:r;a[n]=t[n]}return[e,r]}function eu(t,e=t.schema){let{gen:r,data:n,it:a}=t;if(Object.keys(e).length===0)return;let s=r.let("missing");for(let i in e){let c=e[i];if(c.length===0)continue;let f=(0,Wn.propertyInData)(r,n,i,a.opts.ownProperties);t.setParams({property:i,depsCount:c.length,deps:c.join(", ")}),a.allErrors?r.if(f,()=>{for(let y of c)(0,Wn.checkReportMissingProp)(t,y)}):(r.if((0,ao._)`${f} && (${(0,Wn.checkMissingProp)(t,c,s)})`),(0,Wn.reportMissingProp)(t,s),r.else())}}Ft.validatePropertyDeps=eu;function tu(t,e=t.schema){let{gen:r,data:n,keyword:a,it:s}=t,i=r.name("valid");for(let c in e)(0,cp.alwaysValidSchema)(s,e[c])||(r.if((0,Wn.propertyInData)(r,n,c,s.opts.ownProperties),()=>{let f=t.subschema({keyword:a,schemaProp:c},i);t.mergeValidEvaluated(f,i)},()=>r.var(i,!0)),t.ok(i))}Ft.validateSchemaDeps=tu;Ft.default=up});var au=x(so=>{"use strict";Object.defineProperty(so,"__esModule",{value:!0});var nu=Z(),fp=ue(),mp={message:"property name must be valid",params:({params:t})=>(0,nu._)`{propertyName: ${t.propertyName}}`},hp={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:mp,code(t){let{gen:e,schema:r,data:n,it:a}=t;if((0,fp.alwaysValidSchema)(a,r))return;let s=e.name("valid");e.forIn("key",n,i=>{t.setParams({propertyName:i}),t.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},s),e.if((0,nu.not)(s),()=>{t.error(!0),a.allErrors||e.break()})}),t.ok(s)}};so.default=hp});var oo=x(io=>{"use strict";Object.defineProperty(io,"__esModule",{value:!0});var ns=gt(),kt=Z(),pp=Wt(),as=ue(),vp={message:"must NOT have additional properties",params:({params:t})=>(0,kt._)`{additionalProperty: ${t.additionalProperty}}`},gp={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:vp,code(t){let{gen:e,schema:r,parentSchema:n,data:a,errsCount:s,it:i}=t;if(!s)throw new Error("ajv implementation error");let{allErrors:c,opts:f}=i;if(i.props=!0,f.removeAdditional!=="all"&&(0,as.alwaysValidSchema)(i,r))return;let y=(0,ns.allSchemaProperties)(n.properties),h=(0,ns.allSchemaProperties)(n.patternProperties);E(),t.ok((0,kt._)`${s} === ${pp.default.errors}`);function E(){e.forIn("key",a,N=>{!y.length&&!h.length?C(N):e.if(b(N),()=>C(N))})}function b(N){let R;if(y.length>8){let U=(0,as.schemaRefOrVal)(i,n.properties,"properties");R=(0,ns.isOwnProperty)(e,U,N)}else y.length?R=(0,kt.or)(...y.map(U=>(0,kt._)`${N} === ${U}`)):R=kt.nil;return h.length&&(R=(0,kt.or)(R,...h.map(U=>(0,kt._)`${(0,ns.usePattern)(t,U)}.test(${N})`))),(0,kt.not)(R)}function $(N){e.code((0,kt._)`delete ${a}[${N}]`)}function C(N){if(f.removeAdditional==="all"||f.removeAdditional&&r===!1){$(N);return}if(r===!1){t.setParams({additionalProperty:N}),t.error(),c||e.break();return}if(typeof r=="object"&&!(0,as.alwaysValidSchema)(i,r)){let R=e.name("valid");f.removeAdditional==="failing"?(T(N,R,!1),e.if((0,kt.not)(R),()=>{t.reset(),$(N)})):(T(N,R),c||e.if((0,kt.not)(R),()=>e.break()))}}function T(N,R,U){let F={keyword:"additionalProperties",dataProp:N,dataPropType:as.Type.Str};U===!1&&Object.assign(F,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(F,R)}}};io.default=gp});var ou=x(co=>{"use strict";Object.defineProperty(co,"__esModule",{value:!0});var yp=Ln(),su=gt(),lo=ue(),iu=oo(),_p={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:n,data:a,it:s}=t;s.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&iu.default.code(new yp.KeywordCxt(s,iu.default,"additionalProperties"));let i=(0,su.allSchemaProperties)(r);for(let E of i)s.definedProperties.add(E);s.opts.unevaluated&&i.length&&s.props!==!0&&(s.props=lo.mergeEvaluated.props(e,(0,lo.toHash)(i),s.props));let c=i.filter(E=>!(0,lo.alwaysValidSchema)(s,r[E]));if(c.length===0)return;let f=e.name("valid");for(let E of c)y(E)?h(E):(e.if((0,su.propertyInData)(e,a,E,s.opts.ownProperties)),h(E),s.allErrors||e.else().var(f,!0),e.endIf()),t.it.definedProperties.add(E),t.ok(f);function y(E){return s.opts.useDefaults&&!s.compositeRule&&r[E].default!==void 0}function h(E){t.subschema({keyword:"properties",schemaProp:E,dataProp:E},f)}}};co.default=_p});var du=x(uo=>{"use strict";Object.defineProperty(uo,"__esModule",{value:!0});var lu=gt(),ss=Z(),cu=ue(),uu=ue(),bp={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:n,parentSchema:a,it:s}=t,{opts:i}=s,c=(0,lu.allSchemaProperties)(r),f=c.filter(T=>(0,cu.alwaysValidSchema)(s,r[T]));if(c.length===0||f.length===c.length&&(!s.opts.unevaluated||s.props===!0))return;let y=i.strictSchema&&!i.allowMatchingProperties&&a.properties,h=e.name("valid");s.props!==!0&&!(s.props instanceof ss.Name)&&(s.props=(0,uu.evaluatedPropsToName)(e,s.props));let{props:E}=s;b();function b(){for(let T of c)y&&$(T),s.allErrors?C(T):(e.var(h,!0),C(T),e.if(h))}function $(T){for(let N in y)new RegExp(T).test(N)&&(0,cu.checkStrictMode)(s,`property ${N} matches pattern ${T} (use allowMatchingProperties)`)}function C(T){e.forIn("key",n,N=>{e.if((0,ss._)`${(0,lu.usePattern)(t,T)}.test(${N})`,()=>{let R=f.includes(T);R||t.subschema({keyword:"patternProperties",schemaProp:T,dataProp:N,dataPropType:uu.Type.Str},h),s.opts.unevaluated&&E!==!0?e.assign((0,ss._)`${E}[${N}]`,!0):!R&&!s.allErrors&&e.if((0,ss.not)(h),()=>e.break())})})}}};uo.default=bp});var fu=x(fo=>{"use strict";Object.defineProperty(fo,"__esModule",{value:!0});var Ep=ue(),$p={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:n}=t;if((0,Ep.alwaysValidSchema)(n,r)){t.fail();return}let a=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},a),t.failResult(a,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};fo.default=$p});var mu=x(mo=>{"use strict";Object.defineProperty(mo,"__esModule",{value:!0});var Sp=gt(),wp={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Sp.validateUnion,error:{message:"must match a schema in anyOf"}};mo.default=wp});var hu=x(ho=>{"use strict";Object.defineProperty(ho,"__esModule",{value:!0});var is=Z(),Cp=ue(),Tp={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,is._)`{passingSchemas: ${t.passing}}`},Mp={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:Tp,code(t){let{gen:e,schema:r,parentSchema:n,it:a}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(a.opts.discriminator&&n.discriminator)return;let s=r,i=e.let("valid",!1),c=e.let("passing",null),f=e.name("_valid");t.setParams({passing:c}),e.block(y),t.result(i,()=>t.reset(),()=>t.error(!0));function y(){s.forEach((h,E)=>{let b;(0,Cp.alwaysValidSchema)(a,h)?e.var(f,!0):b=t.subschema({keyword:"oneOf",schemaProp:E,compositeRule:!0},f),E>0&&e.if((0,is._)`${f} && ${i}`).assign(i,!1).assign(c,(0,is._)`[${c}, ${E}]`).else(),e.if(f,()=>{e.assign(i,!0),e.assign(c,E),b&&t.mergeEvaluated(b,is.Name)})})}}};ho.default=Mp});var pu=x(po=>{"use strict";Object.defineProperty(po,"__esModule",{value:!0});var Pp=ue(),kp={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let a=e.name("valid");r.forEach((s,i)=>{if((0,Pp.alwaysValidSchema)(n,s))return;let c=t.subschema({keyword:"allOf",schemaProp:i},a);t.ok(a),t.mergeEvaluated(c)})}};po.default=kp});var yu=x(vo=>{"use strict";Object.defineProperty(vo,"__esModule",{value:!0});var os=Z(),gu=ue(),Ip={message:({params:t})=>(0,os.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,os._)`{failingKeyword: ${t.ifClause}}`},Dp={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:Ip,code(t){let{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,gu.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let a=vu(n,"then"),s=vu(n,"else");if(!a&&!s)return;let i=e.let("valid",!0),c=e.name("_valid");if(f(),t.reset(),a&&s){let h=e.let("ifClause");t.setParams({ifClause:h}),e.if(c,y("then",h),y("else",h))}else a?e.if(c,y("then")):e.if((0,os.not)(c),y("else"));t.pass(i,()=>t.error(!0));function f(){let h=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},c);t.mergeEvaluated(h)}function y(h,E){return()=>{let b=t.subschema({keyword:h},c);e.assign(i,c),t.mergeValidEvaluated(b,i),E?e.assign(E,(0,os._)`${h}`):t.setParams({ifClause:h})}}}};function vu(t,e){let r=t.schema[e];return r!==void 0&&!(0,gu.alwaysValidSchema)(t,r)}vo.default=Dp});var _u=x(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:!0});var Np=ue(),Rp={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,Np.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};go.default=Rp});var bu=x(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:!0});var Ap=Zi(),Op=Jc(),Lp=eo(),xp=Xc(),qp=Zc(),jp=ru(),Fp=au(),Vp=oo(),Hp=ou(),Bp=du(),Up=fu(),Gp=mu(),zp=hu(),Kp=pu(),Wp=yu(),Yp=_u();function Jp(t=!1){let e=[Up.default,Gp.default,zp.default,Kp.default,Wp.default,Yp.default,Fp.default,Vp.default,jp.default,Hp.default,Bp.default];return t?e.push(Op.default,xp.default):e.push(Ap.default,Lp.default),e.push(qp.default),e}yo.default=Jp});var Eu=x(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});var De=Z(),Qp={message:({schemaCode:t})=>(0,De.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,De._)`{format: ${t}}`},Xp={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:Qp,code(t,e){let{gen:r,data:n,$data:a,schema:s,schemaCode:i,it:c}=t,{opts:f,errSchemaPath:y,schemaEnv:h,self:E}=c;if(!f.validateFormats)return;a?b():$();function b(){let C=r.scopeValue("formats",{ref:E.formats,code:f.code.formats}),T=r.const("fDef",(0,De._)`${C}[${i}]`),N=r.let("fType"),R=r.let("format");r.if((0,De._)`typeof ${T} == "object" && !(${T} instanceof RegExp)`,()=>r.assign(N,(0,De._)`${T}.type || "string"`).assign(R,(0,De._)`${T}.validate`),()=>r.assign(N,(0,De._)`"string"`).assign(R,T)),t.fail$data((0,De.or)(U(),F()));function U(){return f.strictSchema===!1?De.nil:(0,De._)`${i} && !${R}`}function F(){let oe=h.$async?(0,De._)`(${T}.async ? await ${R}(${n}) : ${R}(${n}))`:(0,De._)`${R}(${n})`,B=(0,De._)`(typeof ${R} == "function" ? ${oe} : ${R}.test(${n}))`;return(0,De._)`${R} && ${R} !== true && ${N} === ${e} && !${B}`}}function $(){let C=E.formats[s];if(!C){U();return}if(C===!0)return;let[T,N,R]=F(C);T===e&&t.pass(oe());function U(){if(f.strictSchema===!1){E.logger.warn(B());return}throw new Error(B());function B(){return`unknown format "${s}" ignored in schema at path "${y}"`}}function F(B){let O=B instanceof RegExp?(0,De.regexpCode)(B):f.code.formats?(0,De._)`${f.code.formats}${(0,De.getProperty)(s)}`:void 0,J=r.scopeValue("formats",{key:s,ref:B,code:O});return typeof B=="object"&&!(B instanceof RegExp)?[B.type||"string",B.validate,(0,De._)`${J}.validate`]:["string",B,J]}function oe(){if(typeof C=="object"&&!(C instanceof RegExp)&&C.async){if(!h.$async)throw new Error("async format in sync schema");return(0,De._)`await ${R}(${n})`}return typeof N=="function"?(0,De._)`${R}(${n})`:(0,De._)`${R}.test(${n})`}}}};_o.default=Xp});var $u=x(bo=>{"use strict";Object.defineProperty(bo,"__esModule",{value:!0});var Zp=Eu(),ev=[Zp.default];bo.default=ev});var Su=x(Xr=>{"use strict";Object.defineProperty(Xr,"__esModule",{value:!0});Xr.contentVocabulary=Xr.metadataVocabulary=void 0;Xr.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Xr.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var Cu=x(Eo=>{"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});var tv=Nc(),rv=zc(),nv=bu(),av=$u(),wu=Su(),sv=[tv.default,rv.default,(0,nv.default)(),av.default,wu.metadataVocabulary,wu.contentVocabulary];Eo.default=sv});var Tu=x(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:!0});Yn.DiscrError=void 0;var iv;(function(t){t.Tag="tag",t.Mapping="mapping"})(iv=Yn.DiscrError||(Yn.DiscrError={}))});var Pu=x(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});var Zr=Z(),$o=Tu(),Mu=za(),ov=ue(),lv={message:({params:{discrError:t,tagName:e}})=>t===$o.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,Zr._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},cv={keyword:"discriminator",type:"object",schemaType:"object",error:lv,code(t){let{gen:e,data:r,schema:n,parentSchema:a,it:s}=t,{oneOf:i}=a;if(!s.opts.discriminator)throw new Error("discriminator: requires discriminator option");let c=n.propertyName;if(typeof c!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");let f=e.let("valid",!1),y=e.const("tag",(0,Zr._)`${r}${(0,Zr.getProperty)(c)}`);e.if((0,Zr._)`typeof ${y} == "string"`,()=>h(),()=>t.error(!1,{discrError:$o.DiscrError.Tag,tag:y,tagName:c})),t.ok(f);function h(){let $=b();e.if(!1);for(let C in $)e.elseIf((0,Zr._)`${y} === ${C}`),e.assign(f,E($[C]));e.else(),t.error(!1,{discrError:$o.DiscrError.Mapping,tag:y,tagName:c}),e.endIf()}function E($){let C=e.name("valid"),T=t.subschema({keyword:"oneOf",schemaProp:$},C);return t.mergeEvaluated(T,Zr.Name),C}function b(){var $;let C={},T=R(a),N=!0;for(let oe=0;oe<i.length;oe++){let B=i[oe];(B==null?void 0:B.$ref)&&!(0,ov.schemaHasRulesButRef)(B,s.self.RULES)&&(B=Mu.resolveRef.call(s.self,s.schemaEnv.root,s.baseId,B==null?void 0:B.$ref),B instanceof Mu.SchemaEnv&&(B=B.schema));let O=($=B==null?void 0:B.properties)===null||$===void 0?void 0:$[c];if(typeof O!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${c}"`);N=N&&(T||R(B)),U(O,oe)}if(!N)throw new Error(`discriminator: "${c}" must be required`);return C;function R({required:oe}){return Array.isArray(oe)&&oe.includes(c)}function U(oe,B){if(oe.const)F(oe.const,B);else if(oe.enum)for(let O of oe.enum)F(O,B);else throw new Error(`discriminator: "properties/${c}" must have "const" or "enum"`)}function F(oe,B){if(typeof oe!="string"||oe in C)throw new Error(`discriminator: "${c}" values must be unique strings`);C[oe]=B}}}};So.default=cv});var ku=x((F_,uv)=>{uv.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var Nu=x((we,Du)=>{"use strict";Object.defineProperty(we,"__esModule",{value:!0});we.MissingRefError=we.ValidationError=we.CodeGen=we.Name=we.nil=we.stringify=we.str=we._=we.KeywordCxt=void 0;var dv=Tc(),fv=Cu(),mv=Pu(),Iu=ku(),hv=["/properties"],ls="http://json-schema.org/draft-07/schema",cs=class extends dv.default{_addVocabularies(){super._addVocabularies(),fv.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(mv.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(Iu,hv):Iu;this.addMetaSchema(e,ls,!1),this.refs["http://json-schema.org/schema"]=ls}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(ls)?ls:void 0)}};Du.exports=we=cs;Object.defineProperty(we,"__esModule",{value:!0});we.default=cs;var pv=Ln();Object.defineProperty(we,"KeywordCxt",{enumerable:!0,get:function(){return pv.KeywordCxt}});var en=Z();Object.defineProperty(we,"_",{enumerable:!0,get:function(){return en._}});Object.defineProperty(we,"str",{enumerable:!0,get:function(){return en.str}});Object.defineProperty(we,"stringify",{enumerable:!0,get:function(){return en.stringify}});Object.defineProperty(we,"nil",{enumerable:!0,get:function(){return en.nil}});Object.defineProperty(we,"Name",{enumerable:!0,get:function(){return en.Name}});Object.defineProperty(we,"CodeGen",{enumerable:!0,get:function(){return en.CodeGen}});var vv=Ba();Object.defineProperty(we,"ValidationError",{enumerable:!0,get:function(){return vv.default}});var gv=Ua();Object.defineProperty(we,"MissingRefError",{enumerable:!0,get:function(){return gv.default}})});var Po=(t,e)=>(t+e)/2,pa=(t,e)=>Math.random()*(e-t)+t;var Rr=(t,e,r)=>Math.max(e,Math.min(t,r));var $s=location.hostname==="localhost"||location.hostname==="127.0.0.1";function H(t,e){let r=(e||document).querySelector(t);if(!r)throw Error(`HTMLElement with selectors ${t} could not be found!`);return r}function ko(t,e){if(!t||!e){console.error(t,e);return}let r=t.querySelectorAll(":scope > [data-tab-target]");r.forEach(n=>{n.addEventListener("click",()=>{var i;r.forEach(c=>c.classList.toggle("selected",c===n));let a=n.getAttribute("data-tab-target"),s=e.querySelector(`[data-tab-content="${a}"]`);Array.from(((i=s==null?void 0:s.parentElement)==null?void 0:i.children)||[]).filter(c=>c.hasAttribute("data-tab-content")).forEach(c=>{c.classList.toggle("hidden",c.getAttribute("data-tab-content")!==a)})})})}function Ke(t,e){let r="data-highlight-notification";if(t.classList.contains("selected"))return;t.setAttribute(r,"");let n=()=>{t.removeAttribute(r),t.removeEventListener(e,n)};t.addEventListener(e,n)}var ft=class{constructor(){k(this,"listeners",new Map)}listen(e,r){let n={callback:e,opts:r};this.listeners.set(e,n)}removeListener(e){this.listeners.delete(e)}removeAllListeners(){this.listeners.clear()}invoke(e){var r;this.listeners.forEach(n=>{n.callback(e)});for(let[n,a]of this.listeners.entries())(r=a.opts)!=null&&r.once&&this.listeners.delete(n)}};var We=class{constructor(e){k(this,"defaultValue");k(this,"value");k(this,"listeners",new Map([["change",new ft],["set",new ft],["add",new ft],["subtract",new ft]]));this.defaultValue=e,this.value=e}set(e){var r,n;this.value=e,(r=this.listeners.get("set"))==null||r.invoke(this.value),(n=this.listeners.get("change"))==null||n.invoke(this.value)}get(){return this.value}add(e){var r,n;this.value+=e,(r=this.listeners.get("add"))==null||r.invoke(this.value),(n=this.listeners.get("change"))==null||n.invoke(this.value)}subtract(e){var r,n;this.value-=e,(r=this.listeners.get("subtract"))==null||r.invoke(this.value),(n=this.listeners.get("change"))==null||n.invoke(this.value)}reset(){this.value=this.defaultValue,this.listeners.forEach(e=>e.removeAllListeners())}addListener(e,r){var n;(n=this.listeners.get(e))==null||n.listen(r)}removeListener(e,r){var n;(n=this.listeners.get(e))==null||n.removeListener(r)}};var mt={None:1<<0,Attack:1<<1,Physical:1<<2,Elemental:1<<3,Chaos:1<<4,Skill:1<<5},va=[{desc:"#% Increased Physical Damage",tags:["Physical"],stats:[{name:"Damage",valueType:"Inc",flags:mt.Physical}]},{desc:"#% More Physical Damage",tags:["Physical"],stats:[{name:"Damage",valueType:"More",flags:mt.Physical}]},{desc:"#% More Damage",tags:[],stats:[{name:"Damage",valueType:"More"}]},{desc:"Adds # To # Physical Damage",tags:["Physical"],stats:[{name:"MinDamage",valueType:"Base",flags:mt.Physical},{name:"MaxDamage",valueType:"Base",flags:mt.Physical}]},{desc:"+#% Hit Chance",tags:[],stats:[{name:"HitChance",valueType:"Base"}]},{desc:"#% Increased Attack Speed",tags:["Speed"],stats:[{name:"AttackSpeed",valueType:"Inc"}]},{desc:"#% More Attack Speed",tags:["Speed"],stats:[{name:"AttackSpeed",valueType:"More"}]},{desc:"#% Increased Maximum Mana",tags:["Mana"],stats:[{name:"MaxMana",valueType:"Inc"}]},{desc:"+# Maximum Mana",tags:["Mana"],stats:[{name:"MaxMana",valueType:"Base"}]},{desc:"+# Mana Regeneration",tags:["Mana"],stats:[{name:"ManaRegen",valueType:"Base"}]},{desc:"+#% Critical Hit Chance",tags:["Critical"],stats:[{name:"CritChance",valueType:"Base"}]},{desc:"+#% Critical Hit Multiplier",tags:["Critical"],stats:[{name:"CritMulti",valueType:"Base"}]},{desc:"+# Gold Per Second",tags:["Gold"],stats:[{name:"GoldPerSecond",valueType:"Base"}]},{desc:"#% Increased Gold Per Second",tags:["Gold"],stats:[{name:"GoldPerSecond",valueType:"Inc"}]},{desc:"#% Increased Skill Duration",tags:["Gold"],stats:[{name:"Duration",valueType:"Inc",flags:mt.Skill}]}],Ye=class{constructor(e){k(this,"text");k(this,"template");k(this,"tags",[]);k(this,"stats",[]);this.text=e;let r=[...e.matchAll(new RegExp("{(?<v1>\\d+(\\.\\d+)?)(-(?<v2>\\d+(\\.\\d+)?))?\\}","g"))],n=e.replace(/{[^}]+}/g,"#");if(!va.some(a=>a.desc===n))throw Error("Failed to find mod template. Invalid mod description");this.template=va.find(a=>a.desc===n),this.tags=this.template.tags;for(let a of this.template.stats){let s=r[this.template.stats.indexOf(a)].groups;if(!s)throw Error();let{v1:i,v2:c}=s,f=parseFloat(i),y=parseFloat(c)||f,h=f;this.stats.push(new mr({name:a.name,valueType:a.valueType,value:h,min:f,max:y,flags:a.flags||0}))}}get templateDesc(){return this.template.desc}get desc(){let e=0;return this.templateDesc.replace(/#+/g,r=>{var s;return((s=this.stats[e++].value)==null?void 0:s.toFixed(r.length-1))||"#"})}static compare(e,r){return e.compare(r)}static sort(e,r){return e.sort(r)}sort(e){return va.findIndex(r=>r.desc===this.templateDesc)-va.findIndex(r=>r.desc===e.templateDesc)}compare(e){return this.templateDesc===e.templateDesc}copy(){return new Ye(this.text)}setStatValues(e){if(this.stats.length===e.length)return this.stats.forEach((r,n)=>r.value=e[n]),!0}},mr=class{constructor(e){k(this,"name");k(this,"valueType");k(this,"value");k(this,"flags");k(this,"min");k(this,"max");k(this,"source");this.name=e.name,this.valueType=e.valueType,this.value=e.value,this.flags=e.flags||0,this.min=e.min||this.value,this.max=e.max||this.value||this.min,this.source=e.source}randomizeValue(){this.value=Math.random()*(this.max-this.min)+this.min}},ga=class{constructor(){k(this,"_modList");k(this,"onChange");this._modList=[],this.onChange=new ft}get modList(){return this._modList}add(e,r){e.forEach(n=>n.source=r),this.modList.push(...e),this.onChange.invoke([...this.modList])}removeBySource(e){this._modList=this.modList.filter(r=>r.source!==e),this.onChange.invoke([...this.modList])}clear(){this._modList=[],this.onChange.invoke([...this.modList])}};var ya={Physical:1<<0,Elemental:1<<1,Chaos:1<<2},Uu=(()=>{let t=[],e=Object.values(ya).reduce((r,n)=>r+n);for(let r=0;r<=e;r++){let n=["Damage"];Object.entries(ya).forEach(([a,s])=>{if(s&r){let i=`${a}Damage`;n.push(i)}}),t.push(n)}return t})();function Io(t){let e={statModList:t,flags:mt.Attack,calcMinMax:pa},r=ht("HitChance",e)/100,n=pa(0,1),a=r>=n;if(!a)return!1;e.flags=mt.Attack;let s=Ss(e),i=Math.min(ht("CritChance",e),100)/100,c=pa(0,1),f=i>=c,y=1;f&&(y=ht("CritMulti",e)/100);let E=Bt("BaseDamageMultiplier",e)/100*y,b=s.totalBaseDamage*E,$=s.physicalDamage*E;return{hit:a,crit:f,totalDamage:b,totalPhysicalDamage:$}}function Ss(t){let e=Gu(t),r={totalBaseDamage:0,minPhysicalDamage:0,maxPhysicalDamage:0,physicalDamage:0,minElementalDamage:0,maxElementalDamage:0,elementalDamage:0,minChaosDamage:0,maxChaosDamage:0,chaosDamage:0},n=0;{t.flags|=mt.Physical;let{min:a,max:s}=Do("Physical",t,e);r.minPhysicalDamage=a,r.maxPhysicalDamage=s;let i=t.calcMinMax(a,s);r.physicalDamage=i,n+=i}return r.totalBaseDamage=n,r}function Do(t,e,r,n=0){n|=ya[t];let a=0,s=0,i=["Physical","Elemental","Chaos"];for(let b of i){if(b===t)break;let $=r[b][t];if($>0){let{min:C,max:T}=Do(b,e,r,n);a+=Math.ceil(C*$),s+=Math.ceil(T*$)}}let c=Bt("MinDamage",e),f=Bt("MaxDamage",e),y=Uu[n],h=Math.round(_a(y,c,e)+a),E=Math.round(_a(y,f,e)+s);return{min:h,max:E}}function Gu(t){let e={},r=Object.keys(ya);for(let n=0;n<r.length;n++){let a=r[n],s={},i={},c={},f=0,y=0;for(let b=n+1;b<r.length;b++){let $=r[n],C=`${a}ConvertedTo${$}`;s[$]=Bt(C,t),f+=s[$],i[$]=Bt(C,t),y+=i[$],c[$]=Bt(`${a}GainAs${$}`,t)}let h=y>100?100/y:(100-y)/f;for(let b of Object.keys(i))i[b]*=h;let E={multi:1};for(let[b,$]of Object.entries(s)){let C=i[b]||0,T=c[b]||0;E[b]=($+C+T)/100}E.multi=1-Math.min((f+y)/100,1),e[a]=E}return e.Chaos={multi:1},e}function No(t){let e={statModList:t,flags:mt.Attack,calcMinMax:Po},r=ht("HitChance",e)/100,n=Rr(r,0,1),a=ht("AttackSpeed",e),s=Bt("BaseDamageMultiplier",e)/100,i=ht("MaxMana",e),c=ht("ManaRegen",e),f=ht("AttackManaCost",e),y=ht("CritChance",e)/100,h=Rr(y,0,1),E=Math.max(ht("CritMulti",e),100)/100,b=1+h*E,$=Ss(e),C=s*b,T=$.totalBaseDamage*n*a*C;return{hitChance:r*100,clampedHitChance:n*100,attackSpeed:a,critChance:y*100,clampedCritChance:h*100,critMulti:E*100,maxMana:i,manaRegen:c,attackManaCost:f,dps:T,minPhysicalDamage:$.minPhysicalDamage,maxPhysicalDamage:$.maxPhysicalDamage,goldPerSecond:ht("GoldPerSecond",e),skillDurationMultiplier:_a("Duration",1,Object.assign({},e,{flags:mt.Skill}))}}function Bt(t,e){return ws("Base",t,e)}function Ro(t,e){return Math.max(0,1+ws("Inc",t,e)/100)}function Ao(t,e){return Math.max(0,ws("More",t,e))}function _a(t,e,r){if(e<=0)return 0;let n=Ro(t,r),a=Ao(t,r);return e*n*a}function ht(t,e){let r=Bt(t,e);if(r===0)return 0;let n=Ro(t,e),a=Ao(t,e);return r*n*a}function ws(t,e,r){e=Array.isArray(e)?e:[e];let n=t==="More"?1:0,a=(i,c)=>(i&c)===c,s=r.statModList.filter(i=>!(!e.includes(i.name)||i.valueType!==t||!a(r.flags,i.flags||0)));for(let i of s){let c=i.value;t==="More"?n*=1+c/100:n+=c}return Math.max(0,n)}var Cs=H(".p-game .s-enemy [data-health-bar]"),Ot,Be,ar,Ts=new ft;Ts.listen(()=>{Be=Ot[++ar],Be.init()});function Ms(t){Ot=[],ar=0,Ot.push(...t.enemyList.map(e=>new ba(e))),Ot.push(new Ea),Be=Ot[ar],Be.init()}function zu(t){Be.takeDamage(t)}function Ku(t){ar=Rr(t-1,0,Ot.length-1),Be=Ot[ar],Be.init()}function Oo(t){t.enemy={index:ar,health:Be.health,dummyDamage:Be==null?void 0:Be.damage}}function Lo(t){let e=t.enemy;!e||(ar=e.index||0,Be=Ot[ar],Be.health=e.health,Be instanceof Ea&&(Be.damage=e.dummyDamage||0),Be.init())}var ba=class{constructor(e){this.maxHealth=e;k(this,"health");this.health=e}init(){this.updateHealthBar()}takeDamage(e){this.health=Rr(this.health-e,0,this.health),this.updateHealthBar(),this.health===0&&Ts.invoke(this)}updateHealthBar(){let e=this.health/this.maxHealth*100;Cs.style.width=`${e}%`}},Ea=class extends ba{constructor(){super(1);k(this,"damage");this.damage=0}init(){Cs.style.width="100%",this.updateHealthBar()}takeDamage(r){this.damage+=r,this.updateHealthBar()}updateHealthBar(){Cs.setAttribute("data-damage",this.damage.toFixed())}},Ps={init:Ms,spawnEnemyAt:Ku,dealDamage:zu,onDeath:Ts};var Ar=(t,e)=>{let r=new IntersectionObserver(n);return r.observe(t),r;function n(a){a.forEach(s=>{e(s.isIntersecting)})}};var Lt=class extends We{constructor(r,n){super(r);k(this,"hidden");this.hidden=n||!1}},Or={"Time Played":new Lt(0),"Gold Generated":new Lt(0),"Mana Generated":new Lt(0),Hits:new Lt(0),"Critical Hits":new Lt(0),"Total Damage":new Lt(0),"Total Physical Damage":new Lt(0),"Prestige Count":new Lt(0)},Oe=Or,xo=0;Ar(document.querySelector(".p-game .p-statistics"),Wu);function Wu(t){t?(Object.entries(Or).forEach(([e,r])=>qo(e,r)),xo=ke.subscribe(()=>Object.entries(Or).forEach(([e,r])=>qo(e,r)),{intervalMilliseconds:1e3})):ke.unsubscribe(xo)}function jo(){let t=[],e=r=>{let n=document.createElement("li");n.classList.add("g-field","hidden");let a=document.createElement("div");n.appendChild(a);let s=document.createElement("var");return n.appendChild(s),a.textContent=r,s.setAttribute("data-stat",r),s.setAttribute("data-format-type",Yu(r)),n};for(let r of Object.keys(Or)){let n=e(r);t.push(n)}document.querySelector(".p-statistics ul").replaceChildren(...t)}function Yu(t){switch(t){case"Time Played":return"time"}return""}function qo(t,e){var s;let r=document.querySelector(`.p-statistics [data-stat="${t}"]`);if(!r)return;let n=e.get()===0;if((s=r.parentElement)==null||s.classList.toggle("hidden",n),n)return;switch(r.getAttribute("data-format-type")){case"time":let i=new Date(0);i.setSeconds(e.get());let c=i.toISOString().substring(11,19);r.textContent=c;break;default:r.textContent=e.get().toFixed(0)}}function Fo(t){t.statistics=Object.entries(Or).map(([e,r])=>({name:e,value:r.get()}))}function Vo(t){var e;(e=t.statistics)==null||e.forEach(r=>{var n;(n=Or[r.name])==null||n.set(r.value)})}var $a=document.querySelector(".p-game > .s-stats"),Ju=document.querySelector(".p-combat [data-mana-bar]"),Ho,Ie=new ga;Ie.onChange.listen(ks);Ps.onDeath.listen(()=>{q.level.get()<Ot.length-1&&q.level.add(1)});var q=Object.freeze({level:new We(1),gold:new We(0),goldPerSecond:new We(0),attackSpeed:new We(0),attackManaCost:new We(0),maxMana:new We(0),curMana:new We(0),manaRegen:new We(0),skillDurationMultiplier:new We(1)});function Bo(t){Object.values(q).forEach(e=>e.reset()),q.level.addListener("change",e=>H('[data-stat="level"]',$a).textContent=e.toFixed()),q.gold.addListener("change",e=>H('[data-stat="gold"]',$a).textContent=e.toFixed()),q.curMana.addListener("change",e=>{let r=q.maxMana.get();e>r&&q.curMana.set(r),Qu()}),t&&t.modList.forEach(e=>{Ie.add(new Ye(e).stats,"Player")}),ke.subscribe(()=>{let e=q.goldPerSecond.get();q.gold.add(e),Oe["Gold Generated"].add(e)},{intervalMilliseconds:1e3}),ke.subscribe(e=>{let r=q.manaRegen.get()*e;q.curMana.add(r),Oe["Mana Generated"].add(r)}),Xu()}async function Sa(){await ks(),q.curMana.set(q.maxMana.get())}async function ks(){return new Promise(t=>{clearTimeout(Ho),Ho=setTimeout(async()=>{let e=No(Ie.modList);q.attackSpeed.set(e.attackSpeed),q.goldPerSecond.set(e.goldPerSecond),q.maxMana.set(e.maxMana),q.manaRegen.set(e.manaRegen),q.attackManaCost.set(e.attackManaCost),q.skillDurationMultiplier.set(e.skillDurationMultiplier),$a.querySelector('[data-stat="dps"]').textContent=e.dps.toFixed(),$a.querySelectorAll("[data-stat]").forEach(r=>{let n=r.getAttribute("data-stat"),a=e[n];if(typeof a=="number"){let s=Number(r.getAttribute("data-digits")||0);r.textContent=a.toFixed(s)}}),t(null)},1)})}function Qu(){let t=q.curMana.get()/q.maxMana.get()*100;Ju.style.width=t+"%"}function Xu(){let t=0;ke.subscribe(e=>{let r=1/q.attackSpeed.get();if(t+=e,t>=r){let n=q.curMana.get(),a=q.attackManaCost.get();n>a&&(q.curMana.subtract(a),Zu(),t=0)}})}function Zu(){let t=Io(Ie.modList);!t||(Oe.Hits.add(1),Oe["Total Damage"].add(t.totalDamage),Oe["Total Physical Damage"].add(t.totalPhysicalDamage),t.crit&&Oe["Critical Hits"].add(1),Ps.dealDamage(t.totalDamage))}function Uo(t){t.player={level:q.level.get(),gold:q.gold.get(),curMana:q.curMana.get()}}async function Go(t){let e=t.player;!e||(q.level.set(e.level||1),q.gold.set(e.gold||0),q.curMana.set(e.curMana||0),await ks())}var wa=class{constructor(){k(this,"modalElement",H(".p-game .p-combat [data-skill-modal]"));k(this,"skillListContainer",H("[data-skill-list]",this.modalElement));k(this,"skillInfoContainer",H("[data-skill-info]",this.modalElement));k(this,"applyButton",H('[data-value="apply"]',this.modalElement));k(this,"removeButton",H('[data-value="remove"]',this.modalElement));k(this,"cancelButton",H('[data-value="cancel"]',this.modalElement));k(this,"skillSlot");k(this,"selectedSkill");this.applyButton.addEventListener("click",()=>this.apply()),this.removeButton.addEventListener("click",()=>this.remove()),this.cancelButton.addEventListener("click",()=>this.cancel())}open(e){this.skillSlot=e.skillSlot,this.removeButton.classList.toggle("hidden",!e.canRemove),this.removeButton.toggleAttribute("disabled",this.skillSlot.skill===void 0),this.populateSkillList(e.skills),this.modalElement.classList.remove("hidden")}populateSkillList(e){var a,s,i,c,f,y;let r=Array.from(((s=(a=this.skillSlot)==null?void 0:a.element.parentElement)==null?void 0:s.children)||[]).map(h=>h.getAttribute("data-skill-name")),n=[];for(let h of e){let E=document.createElement("li");E.textContent=h.name,E.classList.add("g-list-item"),E.setAttribute("data-skill-name",h.name);let b=r.some($=>$===h.name);E.toggleAttribute("disabled",b),E.addEventListener("click",()=>{var C;this.showInfo(h),n.forEach(T=>T.classList.toggle("selected",T===E)),this.applyButton.toggleAttribute("disabled",h===((C=this.skillSlot)==null?void 0:C.skill));let $=h;this.selectedSkill=$}),n.push(E)}if(this.skillListContainer.replaceChildren(...n),(i=this.skillSlot)!=null&&i.skill){let h=this.skillListContainer.querySelector(`[data-skill-name="${(f=(c=this.skillSlot)==null?void 0:c.skill)==null?void 0:f.name}"]`);h&&h.click()}else(y=n[0])==null||y.click()}showInfo(e){var i,c,f;H("[data-title]").textContent=e.name,H('[data-stat="manaCost"]',this.skillInfoContainer).textContent=e.manaCost.toFixed();let r=H('[data-stat="attackSpeed"]',this.skillInfoContainer),n=H('[data-stat="baseDamageMultiplier"]',this.skillInfoContainer),a=H('[data-stat="baseDuration"]',this.skillInfoContainer);[r,n,a].forEach(y=>{var h;return(h=y.parentElement)==null?void 0:h.classList.add("hidden")}),e instanceof Lr?((i=r.parentElement)==null||i.classList.remove("hidden"),r.textContent=e.attackSpeed.toFixed(2),(c=n.parentElement)==null||c.classList.remove("hidden"),n.textContent=e.baseDamageMultiplier.toFixed(0)+"%"):e instanceof hn&&((f=a.parentElement)==null||f.classList.remove("hidden"),a.textContent=`${e.baseDuration.toFixed()}s`);let s=[];for(let y of e.mods){let h=document.createElement("div");h.classList.add("g-mod-desc"),h.textContent=y.desc,s.push(h)}H("[data-mod-list]",this.skillInfoContainer).replaceChildren(...s)}apply(){!this.selectedSkill||!this.skillSlot||(this.skillSlot.set(this.selectedSkill),this.close())}remove(){!this.skillSlot||(this.skillSlot.set(void 0),this.close())}cancel(){this.close()}close(){this.modalElement.classList.add("hidden")}};var zo=new wa,Ca=class{constructor(){k(this,"element");k(this,"_skill");this.element=this.createElement()}get skill(){return this._skill}set(e){this._skill=e;let r=(e==null?void 0:e.name)||"[Empty]";this.element.setAttribute("data-skill-name",r),H("[data-label]",this.element).textContent=r}},Ta=class extends Ca{constructor(r){super();k(this,"skillSlotContainer",H(".p-game .s-player .s-skills [data-attack-skill]"));k(this,"skills");this.skillSlotContainer.appendChild(this.element),this.skills=r}set(r){var n;super.set(r),(n=this._skill)==null||n.enable()}edit(){zo.open({canRemove:!1,skills:this.skills,skillSlot:this})}createElement(){let r=document.createElement("div");return r.classList.add("g-field"),r.setAttribute("data-skill-slot","attack-skill"),r.insertAdjacentHTML("beforeend","<div data-label></div>"),r.insertAdjacentHTML("beforeend",'<button class="g-button" data-edit>Edit</button>'),r.querySelector("button[data-edit]").addEventListener("click",()=>this.edit()),r}},pn=class extends Ca{constructor(r){super();k(this,"buffSkillList",H(".p-game .s-player .s-skills ul[data-buff-skill-list]"));k(this,"progressBar");k(this,"skills");k(this,"running",!1);this.buffSkillList.appendChild(this.element),this.progressBar=H("[data-progress-bar]",this.element),this.skills=r,this.set(void 0)}trigger(){!this._skill||this.running||!(q.curMana.get()>=this._skill.manaCost)||(q.curMana.subtract(this._skill.manaCost),this.start())}start(){if(!this._skill)return;let r=()=>{var h;return((h=this._skill)==null?void 0:h.baseDuration)||0*q.skillDurationMultiplier.get()},n=r(),a=100,s=n,i=-1,c=()=>{s=r(),n=s*(a/100)};q.skillDurationMultiplier.addListener("change",c),Ie.add(this._skill.mods.flatMap(h=>h.stats),this._skill.sourceName);let f=()=>{i=ke.subscribe(h=>{if(n<=0){ke.unsubscribe(i),y();return}n-=h,a=Math.max(0,n/s*100),this.progressBar.style.width=`${a}%`})},y=()=>{q.skillDurationMultiplier.removeListener("change",c),this._skill&&Ie.removeBySource(this._skill.sourceName),this.running=!1,this.progressBar.style.width="0%"};f(),this.running=!0}edit(){zo.open({canRemove:!0,skills:this.skills,skillSlot:this})}createElement(){let r=document.createElement("li");return r.classList.add("g-field"),r.setAttribute("data-skill-slot","buff-skill"),r.insertAdjacentHTML("beforeend",`
        <div class="wrapper">
            <div data-progress-bar></div>
            <div class="g-button" data-label></div>
        </div>`),r.insertAdjacentHTML("beforeend",'<button class="g-button" data-edit>Edit</button>'),H("[data-edit]",r).addEventListener("click",()=>this.edit()),H("[data-label]",r).addEventListener("click",()=>this.trigger()),r}};var xr,vn,Ma,gn,ed=document.querySelector(".p-game .s-player .s-skills [data-attack-skill]"),td=document.querySelector(".p-game .s-player .s-skills ul[data-buff-skill-list]");function Ko(t){if(xr=[],vn=[],gn=[],ed.replaceChildren(),td.replaceChildren(),t.attackSkills.skillList.sort((e,r)=>e.levelReq-r.levelReq),t.attackSkills.skillList[0].levelReq>1)throw Error("There must be an attack skill with a level requirement of 1");if(xr=t.attackSkills.skillList.map(e=>new Lr(e)),Ma=new Ta(xr),Ma.set(xr[0]),t.buffSkills){vn=t.buffSkills.skillList.map(e=>new hn(e));for(let e of t.buffSkills.skillSlots){if(e.levelReq<=1){gn.push(new pn(vn));continue}let r=n=>{n<e.levelReq||(gn.push(new pn(vn)),q.level.removeListener("change",r))};q.level.addListener("change",r)}}}function Wo(t){var e;t.skills={attackSkillName:((e=Ma.skill)==null?void 0:e.name)||"invalid name",buffSkillNames:gn.map(r=>{var n;return((n=r.skill)==null?void 0:n.name)||""}).filter(r=>(r==null?void 0:r.length)>0)}}function Yo(t){let e=xr.find(r=>{var n;return r.name===((n=t.skills)==null?void 0:n.attackSkillName)});Ma.set(e||xr[0]),gn.forEach((r,n)=>r==null?void 0:r.set(vn.find(a=>{var s,i;return a.name===((i=(s=t.skills)==null?void 0:s.buffSkillNames)==null?void 0:i[n])})))}var Pa=class{constructor(e){k(this,"name");k(this,"levelReq");k(this,"manaCost");k(this,"mods");var r;this.name=e.name,this.levelReq=e.levelReq,this.manaCost=e.manaCost,this.mods=((r=e.mods)==null?void 0:r.map(n=>new Ye(n)))||[]}get sourceName(){return`Skill/${this.name}`}},ka=class extends Pa{constructor(r){super(r);k(this,"attackSpeed");k(this,"baseDamageMultiplier");this.attackSpeed=r.attackSpeed,this.baseDamageMultiplier=r.baseDamageMultiplier}enable(){var r;Ie.removeBySource((r=ka.active)==null?void 0:r.sourceName),ka.active=this,Ie.add([new mr({name:"BaseDamageMultiplier",valueType:"Base",value:this.baseDamageMultiplier})],this.sourceName),Ie.add([new mr({name:"AttackSpeed",valueType:"Base",value:this.attackSpeed})],this.sourceName),Ie.add([new mr({name:"AttackManaCost",valueType:"Base",value:this.manaCost})],this.sourceName),this.mods.forEach(n=>Ie.add(n.stats,this.sourceName))}},Lr=ka;k(Lr,"active");var hn=class extends Pa{constructor(r){super(r);k(this,"baseDuration");this.baseDuration=r.baseDuration}};var yn=class{constructor(){k(this,"running",!1);k(this,"instances",new Map);k(this,"animInstances",new Map);k(this,"loopId",0);k(this,"animLoopId",0);k(this,"counter",0);k(this,"animCounter",0)}subscribe(e,r){let n=this.counter++,a={callback:e,time:0,id:n,options:r};return this.instances.set(n,a),n}subscribeAnim(e){let r=this.animCounter++,n={callback:e,id:r};return this.animInstances.set(r,n),r}unsubscribe(e){this.instances.delete(e)}unsubscribeAnim(e){this.animInstances.delete(e)}reset(){this.instances.clear(),this.running=!1}start(){this.running||(this.running=!0,this.beginLoop(),this.beginAnimationLoop())}stop(){this.running=!1,clearTimeout(this.loopId),cancelAnimationFrame(this.animLoopId||0)}beginLoop(){let e=0,r=performance.now(),n=()=>{clearTimeout(this.loopId),this.loopId=setTimeout(()=>{let a=performance.now()-r+e;for(r=performance.now();a>=40;)a-=40,this.instances.forEach(s=>{var c;s.time+=40;let i=((c=s.options)==null?void 0:c.intervalMilliseconds)||0;s.time>i&&(s.callback(.04),s.time-=i||s.time)});e=a,n()},40)};n()}beginAnimationLoop(){let e=performance.now(),r=()=>{let n=performance.now()-e;e=performance.now();let a=n/1e3;for(let s of this.animInstances.values())s.callback(a);this.animLoopId=requestAnimationFrame(r)};this.animLoopId=requestAnimationFrame(r)}};var Jo="Passives",Is=H('.p-game > menu [data-tab-target="passives"]'),Ia=H(".p-game .p-passives"),rd=H("[data-passives-list]",Ia),nd=H("header [data-cur-points]",Ia),ad=H("header [data-max-points]",Ia),sd=H("header [data-clear]",Ia);sd.addEventListener("click",()=>od());var Qo=()=>Ds*(q.level.get()-1),id=()=>nt.filter(t=>t.assigned).reduce((t,e)=>t+=e.points,0),nt,Ds;function Xo(t){if(!!t){nt=[],Ds=1;for(let e of t.passiveList){let r=new Ns(e);nt.push(r)}if(rd.replaceChildren(...nt.map(e=>e.element)),_n(),t.levelReq>1){let e=r=>{r>=t.levelReq&&(Is.classList.remove("hidden"),q.level.removeListener("change",e))};q.level.addListener("change",e)}q.level.addListener("add",e=>{nt.forEach(n=>n.tryUnlock()),Math.floor(Qo()-(Ds*e-2))>0&&Ke(Is,"click"),_n()})}}function od(){nt.filter(t=>t.assigned).forEach(t=>t.unassign()),_n()}function _n(){let t=Qo(),e=id(),r=t-e;ad.textContent=t.toFixed(),nd.textContent=e.toFixed();for(let n of nt)n.assigned||n.element.toggleAttribute("disabled",n.points>r),n.element.classList.toggle("selected",n.assigned)}function Zo(t){t.passives={list:nt.filter(e=>e.assigned).map(e=>({index:nt.indexOf(e),desc:e.mod.desc}))}}function el(t){let e=t.passives;if(!e){nt.forEach(n=>n.unassign());return}e.list.every(n=>nt[n.index].mod.desc===n.desc)&&(e.list.forEach(n=>{nt[n.index].assign()}),_n())}var Ns=class{constructor(e){k(this,"levelReq");k(this,"points");k(this,"mod");k(this,"element");k(this,"_assigned");k(this,"locked");this.levelReq=e.levelReq,this.points=e.points,this.mod=new Ye(e.mod),this.element=this.createElement(),this.locked=this.levelReq>1,this.element.classList.toggle("hidden",this.locked),this._assigned=!1}get assigned(){return this._assigned}tryUnlock(){!this.locked||q.level.get()<this.levelReq||(this.locked=!1,this.element.classList.remove("hidden"),Ke(Is,"click"),Ke(this.element,"mouseover"))}assign(){this._assigned=!0,Ie.add(this.mod.copy().stats,Jo.concat("/",nt.indexOf(this).toFixed()))}unassign(){this._assigned=!1,Ie.removeBySource(Jo.concat("/",nt.indexOf(this).toFixed()))}toggle(){this._assigned?this.unassign():this.assign()}createElement(){let e=document.createElement("li");return e.classList.add("g-list-item","g-field"),e.insertAdjacentHTML("beforeend",`<div>${this.mod.desc}</div>`),e.insertAdjacentHTML("beforeend",`<var>${this.points}</var>`),e.addEventListener("click",()=>{this.toggle(),_n()}),e}};var ld=6,cd=20,ud=.02,jr={reforge:{desc:"Reforge the item with new random modifiers",validate:t=>new Le().modsIsNotEmpty(t.modTables.general),getItemMods:t=>new xe().addMultiple(t.modTables.general,qr(0)).modList},reforgeIncludePhysical:{desc:"Reforge the item with new random modifiers, including a [physical] modifier",validate:t=>new Le().modsIsNotEmpty(t.modTables.general).modsContainsTag(t.modTables.general,"Physical"),getItemMods:t=>new xe().addOneByTag(t.modTables.general,"Physical").addMultiple(t.modTables.general,qr(1)).modList},reforgeIncludeMana:{desc:"Reforge the item with new random modifiers, including a [mana] modifier",validate:t=>new Le().modsIsNotEmpty(t.modTables.general).modsContainsTag(t.modTables.general,"Mana"),getItemMods:t=>new xe().addOneByTag(t.modTables.general,"Mana").addMultiple(t.modTables.general,qr(1)).modList},reforgeIncludeCritical:{desc:"Reforge the item with new random modifiers, including a [critical] modifier",validate:t=>new Le().modsIsNotEmpty(t.modTables.general).modsContainsTag(t.modTables.general,"Critical"),getItemMods:t=>new xe().addOneByTag(t.modTables.general,"Critical").addMultiple(t.modTables.general,qr(1)).modList},reforgeHigherChanceSameMods:{desc:"Reforge the item with a higher chance of receiving the same modifiers",validate:t=>new Le().itemHasModifiers(t.itemModList).modsIsNotEmpty(t.modTables.general),getItemMods:t=>{let e=[...t.modTables.general].map(r=>r.copy()).reduce((r,n)=>(t.itemModList.some(a=>a===n)&&(n.weight*=cd),r.push(n),r),[]);return new xe().addMultiple(e,qr(0)).modList}},reforgeLowerChanceSameMods:{desc:"Reforge the item with a lower chance of receiving the same modifiers",validate:t=>new Le().itemHasModifiers(t.itemModList).modsIsNotEmpty(t.modTables.general),getItemMods:t=>{let e=[...t.modTables.general].map(r=>r.copy()).reduce((r,n)=>(t.itemModList.some(a=>a===n)&&(n.weight*=ud),r.push(n),r),[]);return new xe().addMultiple(e,qr(0)).modList}},addRandom:{desc:"Add a random modifier",validate:t=>new Le().itemHasSpaceForMods(t.itemModList).modsIsNotEmpty(t.modTables.general),getItemMods:t=>new xe(t.itemModList).addOne(t.modTables.general).modList},addPhysical:{desc:"Add a [physical] modifier",validate:t=>new Le().modsIsNotEmpty(t.modTables.general).itemHasSpaceForMods(t.itemModList).itemCanCraftModWithTag(t.itemModList,t.modTables.general,"Physical"),getItemMods:t=>new xe(t.itemModList).addOneByTag(t.modTables.general,"Physical").modList},addMana:{desc:"Add a [mana] modifier",validate:t=>new Le().modsIsNotEmpty(t.modTables.general).itemHasSpaceForMods(t.itemModList).itemCanCraftModWithTag(t.itemModList,t.modTables.general,"Mana"),getItemMods:t=>new xe(t.itemModList).addOneByTag(t.modTables.general,"Mana").modList},addCritical:{desc:"Add a [critical] modifier",validate:t=>new Le().modsIsNotEmpty(t.modTables.general).itemHasSpaceForMods(t.itemModList).itemCanCraftModWithTag(t.itemModList,t.modTables.general,"Critical"),getItemMods:t=>new xe(t.itemModList).addOneByTag(t.modTables.general,"Critical").modList},removeRandom:{desc:"Remove a random modifier",validate:t=>new Le().itemHasModifiers(t.itemModList),getItemMods:t=>new xe(t.itemModList).removeRandom().modList},removeRandomAddRandom:{desc:"Remove a random modifier and add a new random modifier",validate:t=>new Le().itemHasModifiers(t.itemModList).modsIsNotEmpty(t.modTables.general),getItemMods:t=>new xe(t.itemModList).removeRandom().addOne(t.modTables.general).modList},removeRandomAddPhysical:{desc:"Remove a random modifier and add a new [physical] modifier",validate:t=>new Le().itemHasModifiers(t.itemModList).modsContainsTag(t.modTables.general,"Physical").itemCanCraftModWithTag(t.itemModList,t.modTables.general,"Physical"),getItemMods:t=>new xe(t.itemModList).removeRandom().addOneByTag(t.modTables.general,"Physical").modList},removeRandomAddMana:{desc:"Remove a random modifier and add a new [mana] modifier",validate:t=>new Le().itemHasModifiers(t.itemModList).modsContainsTag(t.modTables.general,"Mana").itemCanCraftModWithTag(t.itemModList,t.modTables.general,"Mana"),getItemMods:t=>new xe(t.itemModList).removeRandom().addOneByTag(t.modTables.general,"Mana").modList},removeRandomAddCritical:{desc:"Remove a random modifier and add a new [critical] modifier",validate:t=>new Le().itemHasModifiers(t.itemModList).modsContainsTag(t.modTables.general,"Critical").itemCanCraftModWithTag(t.itemModList,t.modTables.general,"Critical"),getItemMods:t=>new xe(t.itemModList).removeRandom().addOneByTag(t.modTables.general,"Critical").modList}},Le=class{constructor(){k(this,"errors",[]);this.errors=[]}itemHasSpaceForMods(e){return e.length>=ld&&this.errors.push("Item cannot have any more modifiers"),this}itemHasModifiers(e){return e.length===0&&this.errors.push("Item has no modifiers"),this}itemCanCraftModWithTag(e,r,n){return r.filter(s=>{var i;return((i=s.tags)==null?void 0:i.includes(n))&&!e.some(c=>c.compare(s))}).length===0&&this.errors.push(`There are no ${n} modifiers available`),this}modsIsNotEmpty(e){return e.length===0&&this.errors.push("No modifiers available"),this}modsContainsTag(e,r){return e.some(n=>{var a;return(a=n.tags)==null?void 0:a.includes(r)})||this.errors.push(`No modifier was available with the tag: ${r}`),this}},xe=class{constructor(e=[]){k(this,"modList");this.modList=[...e]}addOne(e){return this.modList.push(...this.generateMods(e,this.modList,1)),this}addOneByTag(e,r){return e=e.filter(n=>{var a;return(a=n.tags)==null?void 0:a.includes(r)}),this.modList.push(...this.generateMods(e,this.modList,1)),this}addMultiple(e,r){return this.modList.push(...this.generateMods(e,this.modList,r)),this}removeRandom(){let e=this.randomRangeInt(0,this.modList.length);return this.modList.splice(e,1),this}generateMods(e,r=[],n){let a=[];for(let s=0;s<n;s++){let i=[...a,...r];e=e.filter(y=>!i.some(h=>y.templateDesc===h.templateDesc));let c=e.reduce((y,h)=>y+=h.weight,0),f=Math.random()*c;for(let y of e)if(c-=y.weight,c<=f){let h=y.copy();h.stats.forEach(E=>E.randomizeValue()),a.push(h);break}}return a}randomRangeInt(e,r){return Math.floor(Math.random()*(r-e)+e)}},qr=(t=0)=>{let e=[0,0,40,50,30,20].slice(t,6),r=e.reduce((a,s)=>a+s),n=Math.random()*r;for(let a=0;a<e.length;a++)if(r-=e[a],r<=n)return a+1;throw Error()};var Vr=H(".p-game .p-items"),tl=H("menu[data-item-list]",Vr),dd=H("ul[data-mod-list]",Vr),As=H(".s-preset-container",Vr),fd=H("[data-new]",As),rl=H("[data-edit]",As),Rs=H("[data-preset-list]",As),at=H("[data-craft-preset-modal]",Vr),md=H("[data-craft-list]",at),Fr=H(".s-craft-container",Vr),hd=H("button[data-craft-button]",Fr),bn=H('.p-game > menu [data-tab-target="items"]');fd.addEventListener("click",()=>{sl("New Preset",[]).edit()});rl.addEventListener("click",()=>{var t;return(t=pt.active)==null?void 0:t.edit()});H('footer [data-value="apply"]',at).addEventListener("click",()=>{var t;return(t=pt.active)==null?void 0:t.apply()});H('footer [data-value="delete"]',at).addEventListener("click",()=>{var t;return(t=pt.active)==null?void 0:t.delete()});H('footer [data-value="apply"]',at).addEventListener("click",()=>{at.classList.add("hidden")});H('footer [data-value="delete"]',at).addEventListener("click",()=>{at.classList.add("hidden")});H('footer [data-value="cancel"]',at).addEventListener("click",()=>{at.classList.add("hidden")});hd.addEventListener("click",()=>yd());Ar(Vr,()=>{vr()});var nl=()=>Ut.filter(t=>t.levelReq<=q.level.get()).map(t=>t.id),Da,gr,Ut,pr;function al(t){if(Da=[],gr=[],Ut=[],pr=[],!!t){for(let e of t.modTables.general)for(let r=0;r<e.length;r++){let n=e[r];Da.push(new En(n,e))}if(pd(t.itemList),vd(t.craftList),sl("All",Object.keys(jr),!0),gd(),gr[0].element.click(),q.level.addListener("add",e=>Ut.forEach(r=>r.tryUnlock(e))),q.gold.addListener("change",()=>{vr(),Os()}),t.levelReq>1){let e=r=>{t.levelReq<=r&&(q.level.removeListener("change",e),bn.classList.remove("hidden"),Ke(bn,"mouseover"))};q.level.addListener("change",e)}else bn.classList.remove("hidden")}}function pd(t){for(let e of t){let r=new xt(e);if(gr.push(r),r.levelReq<=1){r.element.classList.remove("hidden");continue}let n=a=>{e.levelReq<=a&&(r.element.classList.remove("hidden"),Ke(bn,"click"),Ke(r.element,"mouseover"),q.level.removeListener("add",n))};q.level.addListener("add",n)}tl.replaceChildren(...gr.map(e=>e.element))}function vd(t){var e;for(let r of t){let n=new Gt(r);Ut.push(n),n.element.addEventListener("click",()=>{Ut.map(a=>a.element).forEach(a=>{a.classList.toggle("selected",a===n.element)}),n.select(),Os()})}H("[data-craft-list]",Fr).replaceChildren(...Ut.map(r=>r.element)),(e=Ut.find(r=>!r.locked))==null||e.select()}function sl(t,e,r=!1){let n=new pt(t,e,r);return Rs.appendChild(n.element),n.select(),n}function gd(){let t=Ut.map(e=>e.element.cloneNode(!0));t.forEach(e=>{e.addEventListener("click",()=>{e.classList.toggle("selected",!e.classList.contains("selected"))})}),md.replaceChildren(...t)}function il(){var t;if((t=xt.active)!=null&&t.mods){let e=[];for(let r of xt.active.mods.sort(Ye.sort)){let n=r.desc,a=document.createElement("li");a.classList.add("g-mod-desc"),a.textContent=n,e.push(a)}dd.replaceChildren(...e)}}function vr(){var n;if(!pt.active)return;let t=nl(),e=pt.active.ids.filter(a=>t.includes(a));Ut.forEach(a=>{let s=a.cost<=q.gold.get(),i=H("[data-cost]",a.element);i==null||i.toggleAttribute("data-insufficient-cost",!s),a.element.classList.toggle("hidden",a.locked||!e.includes(a.id))}),Fr.querySelector("[data-craft-id].selected:not(.hidden)")||(n=Fr.querySelector("[data-craft-id]:not(.hidden)"))==null||n.click()}function ol(){return{itemModList:xt.active.mods,modTables:{general:Da.filter(t=>t.levelReq<=q.level.get())}}}function Os(){if(!xt.active)return;let t="",e=jr[Gt.active.id];if(!e){console.error("invalid craft id");return}q.gold.get()<Gt.active.cost&&(t="You cannot afford this craft");let r=ol(),n=e.validate(r);n.errors.length>0&&(t=n.errors[0]),H("[data-craft-message]",Fr).textContent=t,H("[data-craft-button]",Fr).toggleAttribute("disabled",t.length>0)}function yd(){if(!xt.active||!jr[Gt.active.id])return;let t=jr[Gt.active.id],e=ol();xt.active.mods=t.getItemMods(e),q.gold.subtract(Gt.active.cost),il(),vr()}var Ls=class{constructor({name:e,levelReq:r}){k(this,"name");k(this,"levelReq");k(this,"element");k(this,"sourceName");k(this,"_mods");this.name=e,this.levelReq=r,this._mods=[],this.element=this.createElement(),this.sourceName=`Skills/${e}`}get mods(){return this._mods}set mods(e){Ie.removeBySource(this.sourceName),this._mods=e,Ie.add(this.mods.flatMap(r=>r.stats),this.sourceName)}createElement(){let e=document.createElement("li");return e.classList.add("g-list-item","hidden"),e.textContent=this.name,e.addEventListener("click",()=>{Ls.active=this,tl.querySelectorAll("li").forEach(r=>{r.classList.toggle("selected",r===e)}),il(),Os()}),e}},xt=Ls;k(xt,"active");var En=class extends Ye{constructor(r,n){super(r.mod);k(this,"itemModData");k(this,"levelReq");k(this,"weight");k(this,"groupIndex");k(this,"modGroup");this.itemModData=r,this.levelReq=r.levelReq,this.weight=r.weight,this.groupIndex=n.findIndex(a=>a===r),this.modGroup=n}get tier(){let r=this.modGroup.filter(n=>n.levelReq<=q.level.get()).length-1;return Math.max(1,r-this.groupIndex)}copy(){return new En(this.itemModData,this.modGroup)}},xs=class{constructor(e){k(this,"id");k(this,"levelReq");k(this,"cost");k(this,"element");k(this,"_locked",!0);this.id=e.id,this.levelReq=e.levelReq,this.cost=e.cost,this.element=this.createElement(),this._locked=this.levelReq>1}get locked(){return this._locked}tryUnlock(e){this.locked&&e>=this.levelReq&&(Ke(bn,"click"),Ke(pt.default.element,"click"),Ke(this.element,"mouseover"),vr(),this._locked=!1)}select(){xs.active=this,this.element.click()}createElement(){let e=document.createElement("li");e.classList.add("g-field","g-list-item","hidden");let r=jr[this.id].desc.replace(/\[\w+\]/g,n=>`<span>${n.substring(1,n.length-1)}</span>`);return e.insertAdjacentHTML("beforeend",`<div>${r}</div>`),e.insertAdjacentHTML("beforeend",`<i data-cost="${this.cost}">${this.cost}</i>`),e.setAttribute("data-craft-id",this.id),e}},Gt=xs;k(Gt,"active");var hr=class{constructor(e,r=[],n=!1){k(this,"name");k(this,"ids");k(this,"element");this.name=e,this.ids=[...r],n&&(hr.default=this),this.element=this.createElement(),this.setName(this.name),pr.push(this)}get isDefault(){return hr.default===this}static create(){return new hr("New Preset",[])}select(){this.element.click()}setName(e){this.name=e.replace(/[^A-Za-z 0-9]/g,""),this.element.textContent=this.name}edit(){this.openModal()}delete(){var e,r;hr.active=null,this.element.previousElementSibling?(e=this.element.previousElementSibling)==null||e.click():(r=this.element.nextElementSibling)==null||r.click(),this.element.remove(),pr=pr.filter(n=>n!==this),vr()}apply(){let e=H("input[data-name]",at).value;this.setName(e);let r=at.querySelectorAll("[data-craft-list] [data-craft-id].selected");this.ids=Array.from(r).map(n=>n.getAttribute("data-craft-id")),vr()}createElement(){let e=document.createElement("li");return e.classList.add("g-list-item","preset"),e.addEventListener("click",()=>{hr.active=this,Rs.querySelectorAll("li").forEach(r=>{r.classList.toggle("selected",r===e)}),rl.toggleAttribute("disabled",this.isDefault),vr()}),Rs.appendChild(e),e}openModal(){at.querySelector("input[data-name]").value=this.name;let e=nl();at.querySelectorAll("[data-craft-list] [data-craft-id]").forEach(r=>{let n=r.getAttribute("data-craft-id"),a=!e.includes(n);r.classList.toggle("hidden",a);let s=!a&&this.ids.includes(n);r.classList.toggle("selected",s)}),at.classList.remove("hidden")}},pt=hr;k(pt,"active"),k(pt,"default");function ll(t){let e=r=>r.mods.map(n=>({desc:n.templateDesc,values:n.stats.map(a=>a.value)}));t.items={items:gr.map(r=>({name:r.name,modList:e(r)})),craftPresets:pr.filter(r=>!r.isDefault).map(r=>({name:r.name,ids:r.ids}))}}function cl(t){var e,r,n;if(!!t.items){pr.filter(a=>!a.isDefault).forEach(a=>a.delete());for(let a of t.items.items){if(!gr.find(c=>c.name===a.name)){console.warn("Could not load Item with name: ",a.name);continue}let i=[];for(let c of a.modList){let f=(e=Da.find(h=>c.desc===h.templateDesc))==null?void 0:e.copy();!f||!f.setStatValues(c.values)||i.push(f)}}for(let a of t.items.craftPresets)new pt(a.name,a.ids);(r=pr[0])==null||r.select(),(n=gr[0])==null||n.element.click()}}var _d=[[/^Reach Level {(\d+)}$/,()=>q.level.get().toFixed()],[/^Prestige {\d+}?$/,()=>Oe["Prestige Count"].get().toFixed()],[/^Deal Damage {(\d+)}$/,()=>Oe["Total Damage"].get().toFixed()],[/^Deal Physical Damage {(\d+)}$/,()=>Oe["Total Physical Damage"].get().toFixed()],[/^Perform Hits {(\d+)}$/,()=>Oe.Hits.get().toFixed()],[/^Perform Critical Hits {(\d+)}$/,()=>Oe["Critical Hits"].get().toFixed()],[/^Generate Gold {(\d+)}$/,()=>Oe["Gold Generated"].get().toFixed()],[/^Regenerate Mana {(\d+)}$/,()=>Oe["Mana Generated"].get().toFixed()]],qs=document.querySelector('.p-game > menu [data-tab-target="achievements"]'),Hr=[],ul=-1;Ar(document.querySelector(".p-game .p-achievements"),Ed);function dl(t){Hr.splice(0);for(let e of t.list)Hr.push(new js(e));if(document.querySelector(".p-achievements ul").replaceChildren(...Hr.map(e=>e.element)),ke.subscribe(()=>{bd()},{intervalMilliseconds:1e3}),t.levelReq>1){let e=r=>{r>=t.levelReq&&(q.level.removeListener("add",e),qs.classList.remove("hidden"),Ke(qs,"click"))};q.level.addListener("add",e)}}function bd(){Hr.forEach(t=>{t.validate()&&t.complete()})}function Ed(t){t?(Hr.forEach(e=>e.updateDescription()),ul=ke.subscribe(()=>Hr.forEach(e=>e.updateDescription()),{intervalMilliseconds:1e3})):ke.unsubscribe(ul)}var js=class{constructor(e){k(this,"completed",!1);k(this,"validator");k(this,"matchIndex");k(this,"targetValue");k(this,"description");k(this,"modList");k(this,"element");var a;this.description=e.description.replace(/[{}]/g,""),this.modList=[...(e==null?void 0:e.modList)||[]];let r=_d.find(s=>s[0].exec(e.description));if(!r)throw Error("no achievement validator found");this.validator=r;let n=r[0].exec(e.description);this.targetValue=Number(n[1]),this.matchIndex=(a=e.description.match(/{\d+}/))==null?void 0:a.index,this.element=this.createElement()}updateDescription(){this.completed||(this.element.querySelector("[data-cur-value]").textContent=this.validator[1]())}validate(){if(this.completed)return;let e=Number(this.validator[1]()),r=!1;return this.validator[2]?r=this.validator[2](e,this.targetValue):r=e>=this.targetValue,r}complete(){this.completed=!0,this.applyModifiers(),this.removeCurValueFromDesc(),this.element.querySelector("var").toggleAttribute("data-valid",this.completed),Ke(qs,"click"),Ke(this.element,"mouseover")}applyModifiers(){let e=this.modList.map(r=>new Ye(r));Ie.add(e.flatMap(r=>r.stats),"Achievement/"+this.description)}removeCurValueFromDesc(){let e=this.element.querySelector("var"),r=e.innerHTML,n=r.indexOf("</span>");e.innerHTML=r.substring(n+8)}createElement(){let e=document.createElement("li");e.classList.add("g-accordion");let r=document.createElement("div");if(e.appendChild(r),r.classList.add("header"),r.insertAdjacentHTML("beforeend",`<div>${this.description.substring(0,this.matchIndex)}<var><span data-cur-value>${this.validator[1]()}</span>/${this.targetValue.toString()}</var>${this.description.substring(this.matchIndex+this.targetValue.toString().length)}</div>`),this.modList.length>0){let n=document.createElement("div");e.appendChild(n),n.classList.add("content");for(let a of this.modList)n.insertAdjacentHTML("beforeend",`<div class="g-mod-desc">${a.replace(/[{}]/g,"")}</div>`);r.insertAdjacentHTML("beforeend","<i></i>"),r.addEventListener("click",()=>{r.toggleAttribute("data-open")})}return e}};var $d=["passives","items","achievements"];function Fs(t){let e=Object.fromEntries(Object.entries(t).filter(([r])=>t[r]&&$d.includes(r)));for(let r of Object.keys(e))if(!!e[r])switch(r){case"passives":Xo(e.passives);break;case"items":al(e.items);break;case"achievements":dl(e.achievements);break}}var Hs=Mo(ml(),1);async function Bs(){let t={};[Uo,Oo,Wo,Zo,ll,Fo].forEach(r=>r(t));let e=btoa(JSON.stringify(t));if(e!==null){let r=new Blob([e],{type:"text/plain"});await Hs.default.setItem("ts-game",r)}else return!1;return!0}async function Us(){let t=await Hs.default.getItem("ts-game");if(!t)return;let e=await t.text(),r=JSON.parse(atob(e));[Go,Lo,Yo,el,cl,Vo].forEach(n=>n(r)),Sa()}ko(document.querySelector(".p-game > menu"),document.querySelector(".p-game"));$s&&(Object.defineProperty(window,"dev",{value:{setLevel:t=>q.level.set(t),setGold:t=>q.level.set(t),save:()=>Bs(),load:()=>Us()}}),document.addEventListener("keydown",t=>{t.code==="Space"&&(ke.running?(document.title="Tinkerers Subject (Stopped)",ke.stop()):(ke.start(),document.title="Tinkerers Subject (Running)"))}));var ke=new yn,Sd;async function hl(t){Sd=t,ke.reset(),Ms(t.enemies),Bo(t.player),Ko(t.skills),Fs(t),ke.subscribe(()=>{Oe["Time Played"].add(1)},{intervalMilliseconds:1e3}),await Sa(),jo(),$s||(ke.start(),ke.subscribe(async()=>{Bs()},{intervalMilliseconds:6e4}),await Us())}var Au=Mo(Nu(),1),Ru=new Au.default;globalThis.TS={};yv();async function yv(){var n;let t=await(await fetch("public/gconfig/schema.json")).json(),e=await(await fetch("public/gconfig/demo.json")).json();if(!Ru.validate(t,e)){console.error(Ru.errors);return}await hl(e),(n=document.querySelector(".p-game menu li:nth-child(1)[data-tab-target]"))==null||n.click(),document.body.classList.remove("hidden")}})();
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */
//# sourceMappingURL=main.js.map
